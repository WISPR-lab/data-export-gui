(function(e){function t(t){for(var s,r,o=t[0],l=t[1],c=t[2],u=0,m=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&m.push(a[r][0]),a[r]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);d&&d(t);while(m.length)m.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],s=!0,o=1;o<i.length;o++){var l=i[o];0!==a[l]&&(s=!1)}s&&(n.splice(t--,1),e=r(r.s=i[0]))}return e}var s={},a={index:0},n=[];function r(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=s,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(i,s,function(t){return e[t]}.bind(null,s));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/data-export-gui/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=l;n.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"00eb":function(e,t,i){},"03a0":function(e,t,i){},"05a2":function(e,t,i){"use strict";i.r(t),t["default"]={name:"filterChip",filter:function(e){return"label"===e.type?"__ts_star"===e.value?"Starred":"__ts_comment"===e.value?"Commented":e.value:e.field+":"+e.value}}},"0860":function(e,t,i){},"09ff":function(e,t,i){"use strict";i.r(t);i("6b54");t["default"]={name:"formatTimestamp",filter:function(e){let t=parseInt(e).toString().length;return 13===t?e:(15===t||16===t?e/=1e3:10===t&&(e*=1e6),parseInt(e))}}},"0acf":function(e,t,i){"use strict";i("609a")},"113d":function(e,t,i){},1525:function(e,t,i){"use strict";i("84f8")},"163d":function(e,t,i){},"165b":function(e,t,i){},"16f1":function(e,t,i){"use strict";i.r(t);i("a481");t["default"]={name:"formatLabelText",filter:function(e){return"__ts_star"===e||"label : __ts_star"===e?"All starred events":"__ts_comment"===e||"label : __ts_comment"===e?"All commented events":e.replace("__ts_","")}}},"210d":function(e,t,i){},2166:function(e,t,i){},"29ce":function(e,t,i){},"2d27":function(e,t,i){"use strict";i.r(t);i("ac6a");var s=i("2b0e");const a=i("75a6");a.keys().forEach(e=>{const t=a(e),i=t.default.name;s["default"].component(i,t.default||t)})},"2e25":function(e,t,i){"use strict";i("3cb3")},"31a0":function(e,t,i){"use strict";i("2166")},"36e0":function(e,t,i){},"3cb3":function(e,t,i){},"3d1d":function(e,t,i){"use strict";i.r(t),t["default"]={name:"compactBytes",filter:function(e){e||(e=0);let t=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.min(Math.floor(Math.log(e)/Math.log(1e3)),t.length-1),s=1*(e/Math.pow(1e3,i)).toFixed(2);return s+t[i]}}},"43f8":function(e,t,i){"use strict";i.r(t);i("6b54");t["default"]={name:"initialLetter",filter:function(e){return e?(e=e.toString(),e.charAt(0).toUpperCase()):""}}},"47fc":function(e,t,i){},"481e":function(e,t,i){"use strict";i.r(t);var s=i("707c");t["default"]={name:"shortDateTime",filter:function(e){return s["a"].utc(e).format("YYYY-MM-DD HH:mm")}}},"48bb":function(e,t,i){"use strict";i("7ffd")},"49d4":function(e,t,i){},5103:function(e,t,i){},"518f":function(e,t,i){"use strict";i("0860")},"555a":function(e,t,i){"use strict";i.r(t),t["default"]={name:"formatSeconds",filter:function(e){return e>60?e/60+"m":e+"s"}}},5634:function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);var s=i("2b0e"),a=function(){var e=this,t=e._self._c;return t("v-app",{attrs:{id:"app"}},[t("v-snackbar",{attrs:{timeout:e.snackbar.timeout,color:e.snackbar.color,top:""},scopedSlots:e._u([{key:"action",fn:function({attrs:i}){return[t("v-btn",e._b({attrs:{text:""},on:{click:function(t){e.snackbar.active=!1}}},"v-btn",i,!1),[e._v(" Close ")])]}}]),model:{value:e.snackbar.active,callback:function(t){e.$set(e.snackbar,"active",t)},expression:"snackbar.active"}},[e._v("\n    "+e._s(e.snackbar.message)+"\n    ")]),t("router-view"),t("safe-exit-button")],1)},n=[];const r=new s["default"];var o=r,l={name:"app",data(){return{}},computed:{snackbar(){return this.$store.state.snackbar}},methods:{setErrorSnackBar:function(e){const t={message:e,color:"error",timeout:7e3};this.$store.dispatch("setSnackBar",t)}},mounted(){o.$on("errorSnackBar",this.setErrorSnackBar);const e=localStorage.getItem("isDarkTheme");e&&(this.$vuetify.theme.dark="true"===e);let t=document.body;t.dataset.theme=this.$vuetify.theme.dark?"dark":"light"},beforeDestroy(){o.$off("errorSnackBar")}},c=l,d=i("2877"),u=Object(d["a"])(c,a,n,!1,null,null,null),m=u.exports,h=i("8c4f"),p=function(){var e=this,t=e._self._c;return t("v-app",[t("PageHeader"),t("v-divider"),t("v-container",{staticClass:"py-12",attrs:{"max-width":"1200px"}},[t("v-row",{staticClass:"align-center mb-12"},[t("v-col",{attrs:{cols:"12",md:"6"}},[t("h2",{staticClass:"text-h4 secondary--text mb-6"},[e._v("\n          Discover and review "),t("span",{staticClass:"primary--text font-weight-bold"},[e._v("account security incidents")]),e._v(" using data exports from your online accounts.\n\n        ")]),t("p",{staticClass:"text-body1 secondary--text line-height-relaxed"},[e._v("\n          LEStrADE is an open-source, browser-based tool that helps end-users uncover security events (i.e., login attempts, password changes) that might \n          indicate an account has been compromised. \n        ")])]),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-card",{staticClass:"pa-8",staticStyle:{"min-height":"300px",background:"linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%)"}},[t("div",{staticClass:"d-flex align-center justify-center fill-height"},[t("div",{staticClass:"text-center"},[t("v-icon",{staticClass:"mb-4 secondary--text",attrs:{size:"80"}},[e._v("mdi-image-outline")]),t("p",{staticClass:"text-body2 secondary--text"},[e._v("Interface screenshot")])],1)])])],1)],1),t("v-divider",{staticClass:"my-12"}),t("div",{staticClass:"mb-12"},[t("h2",{staticClass:"text-h4 mb-8"},[e._v("How It Works")]),t("v-row",[t("v-col",{attrs:{cols:"12",md:"3"}},[t("v-card",{staticClass:"h-100 pa-6 text-center",attrs:{outlined:""}},[t("div",{staticClass:"step-number primary--text text-h4 font-weight-medium mb-4"},[e._v("1")]),t("h3",{staticClass:"text-body1 font-weight-medium mb-3"},[e._v("Request Data Export")]),t("p",{staticClass:"text-body2 secondary--text line-height-relaxed"},[e._v("\n              Use our guides to request data exports from the platform(s) you want to investigate.\n            ")])])],1),t("v-col",{attrs:{cols:"12",md:"3"}},[t("v-card",{staticClass:"h-100 pa-6 text-center",attrs:{outlined:""}},[t("div",{staticClass:"step-number primary--text text-h4 font-weight-medium mb-4"},[e._v("2")]),t("h3",{staticClass:"text-body1 font-weight-medium mb-3"},[e._v("Download Safely")]),t("p",{staticClass:"text-body2 secondary--text line-height-relaxed"},[e._v("\n              Download the ZIP file to a secure, password-protected device or USB drive.\n            ")])])],1),t("v-col",{attrs:{cols:"12",md:"3"}},[t("v-card",{staticClass:"h-100 pa-6 text-center",attrs:{outlined:""}},[t("div",{staticClass:"step-number primary--text text-h4 font-weight-medium mb-4"},[e._v("3")]),t("h3",{staticClass:"text-body1 font-weight-medium mb-3"},[e._v("Import and Analyze")]),t("p",{staticClass:"text-body2 secondary--text line-height-relaxed"},[e._v("\n              Upload the data export here to visualize timelines and security events.\n            ")])])],1),t("v-col",{attrs:{cols:"12",md:"3"}},[t("div",{staticClass:"d-flex flex-column h-100 justify-center gap-3"},[t("v-btn",{staticClass:"px-6",attrs:{large:"",rounded:"",color:"primary"},on:{click:e.goToSketch}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-cloud-upload")]),e._v("\n              Get Started\n            ")],1),t("v-btn",{staticClass:"px-6",attrs:{large:"",outlined:"",rounded:"",color:"primary",to:"/how-to-request"}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-help-circle-outline")]),e._v("\n              How to Request Data\n            ")],1)],1)])],1)],1),t("v-divider",{staticClass:"my-12"}),t("v-row",{staticClass:"align-center mb-12"},[t("v-col",{attrs:{cols:"12",md:"6"}},[t("h3",{staticClass:"text-h5 font-weight-medium mb-6"},[e._v("Key Capabilities")]),t("v-list",{staticClass:"transparent"},e._l(e.features,(function(i){return t("v-list-item",{key:i,attrs:{dense:""}},[t("v-list-item-icon",{staticClass:"mr-3"},[t("v-icon",{attrs:{small:"",color:"primary"}},[e._v("mdi-check-circle")])],1),t("v-list-item-content",[t("v-list-item-title",{staticClass:"text-body2"},[e._v(e._s(i))])],1)],1)})),1)],1),t("v-col",{attrs:{cols:"12",md:"6"}},[t("v-card",{staticClass:"pa-6 mb-6 light-highlight"},[t("h4",{staticClass:"text-h6 font-weight-medium mb-4"},[e._v("Supported Platforms")]),t("div",{staticClass:"d-flex flex-wrap gap-2"},e._l(e.supportedPlatforms,(function(i){return t("v-chip",{key:i,attrs:{small:"",outlined:""}},[e._v("\n              "+e._s(i)+"\n            ")])})),1)]),t("v-card",{staticClass:"pa-6 light-highlight"},[t("p",{staticClass:"text-caption font-weight-medium primary--text mb-2"},[e._v("ABOUT THIS TOOL")]),t("p",{staticClass:"text-body2 secondary--text mb-0"},[e._v("\n            This tool operationalizes findings from the research paper \n            "),t("router-link",{staticClass:"primary--text font-weight-medium",attrs:{to:"#"}},[e._v('\n              "Hidden in Plain Bytes"\n            ')]),e._v("\n            which demonstrates that data exports contain more detailed security events than standard account interfaces.\n          ")],1)])],1)],1),t("v-divider",{staticClass:"my-8"}),t("footer",{staticClass:"py-4 text-center"},[t("p",{staticClass:"text-caption secondary--text mb-0"},[e._v("\n        © 2026 TOOLNAME  | \n        "),t("v-btn",{attrs:{text:"","x-small":"",href:"#"}},[e._v("Privacy")]),t("v-btn",{attrs:{text:"","x-small":"",href:"#"}},[e._v("Terms")])],1)])],1)],1)},v=[],f=function(){var e=this,t=e._self._c;return t("v-app-bar",{staticClass:"border-bottom",attrs:{flat:"",color:"white"}},[t("div",{staticClass:"header-content"},[t("div",{staticClass:"header-left"},[t("v-icon",{attrs:{size:"24"}},[e._v("mdi-database-search")]),t("span",{staticClass:"tool-name ml-2"},[e._v("LEStrADE")])],1),t("div",{staticClass:"header-nav d-none d-md-flex"},[t("v-btn",{staticClass:"nav-link",attrs:{text:"","router-link":"",to:"/"}},[e._v("Home")]),t("v-btn",{staticClass:"nav-link",attrs:{text:"","router-link":"",to:"/explore"}},[e._v("Explore My Data")]),t("v-btn",{staticClass:"nav-link",attrs:{text:"","router-link":"",to:"/how-to-request"}},[e._v("Tutorials")]),t("v-btn",{staticClass:"nav-link",attrs:{text:"",href:"#"}},[e._v("Research")]),t("v-btn",{staticClass:"nav-link",attrs:{text:"",href:"https://github.com/google/timesketch",target:"_blank"}},[e._v("\n        GitHub\n        "),t("v-icon",{staticClass:"ml-1",attrs:{small:""}},[e._v("mdi-github")])],1)],1),t("PageHeaderMobileMenu",{attrs:{visibilityClass:"d-md-none"}})],1)])},g=[],_=function(){var e=this,t=e._self._c;return t("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-btn",e._g(e._b({class:e.visibilityClass,attrs:{icon:""}},"v-btn",s,!1),i),[t("v-icon",[e._v("mdi-dots-vertical")])],1)]}}])},[t("v-list",[t("v-list-item",{attrs:{"router-link":"",to:"/",active:"/"===e.$route.path}},[t("v-list-item-title",[e._v("Home")])],1),t("v-list-item",{attrs:{"router-link":"",to:"/explore",active:e.$route.path.includes("sketch")}},[t("v-list-item-title",[e._v("Explore My Data")])],1),t("v-list-item",{attrs:{"router-link":"",to:"/how-to-request",active:"/how-to-request"===e.$route.path}},[t("v-list-item-title",[e._v("Tutorials")])],1),t("v-list-item",{attrs:{href:"#"}},[t("v-list-item-title",[e._v("Research")])],1),t("v-list-item",{attrs:{href:"https://github.com/google/timesketch",target:"_blank"}},[t("v-list-item-title",[e._v("GitHub"),t("v-icon",{staticClass:"ml-2 mb-1",attrs:{medium:""}},[e._v("mdi-github")])],1)],1)],1)],1)},y=[],b={name:"PageHeaderMobileMenu",props:{visibilityClass:{type:String,default:"d-md-none"}}},w=b,S=Object(d["a"])(w,_,y,!1,null,null,null),x=S.exports,C={name:"PageHeader",components:{PageHeaderMobileMenu:x}},k=C,T=(i("0acf"),Object(d["a"])(k,f,g,!1,null,"f1b0d358",null)),E=T.exports,D={name:"Home",components:{PageHeader:E},data(){return{drawer:!1,features:["Timeline view of login events and security changes","Device and network identification across platforms","Comparison of platform activity logs with standard account interfaces","Annotation tools for marking suspicious activities","Local-first processing - no data leaves your browser","Support for Google, Discord, Apple, Facebook, Instagram, and Snapchat"],supportedPlatforms:["Google","Discord","Apple","Facebook","Instagram","Snapchat"]}},methods:{goToSketch(){this.$router.push({name:"Explore"})}}},O=D,P=(i("8764"),Object(d["a"])(O,p,v,!1,null,"455953bd",null)),F=P.exports,L=function(){var e=this,t=e._self._c;return t("div",[t("div",{directives:[{name:"show",rawName:"v-show",value:"Explore"===e.currentRouteName,expression:"currentRouteName === 'Explore'"}]},[t("explore",{attrs:{"sketch-id":e.sketchId}})],1)])},A=[],$=(i("28a5"),i("386d"),function(){var e=this,t=e._self._c;return t("v-container",{attrs:{fluid:""}},[t("v-card",{staticClass:"pa-3 pt-0 mt-n3",attrs:{flat:"",color:"transparent"}},[t("v-card",{staticClass:"d-flex align-start mb-1",attrs:{outlined:""}},[t("v-menu",{attrs:{"offset-y":"",attach:"","close-on-content-click":!1,"close-on-click":!0},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-text-field",e._g(e._b({ref:"searchInput",staticClass:"pa-2",attrs:{"hide-details":"",label:"Search",placeholder:"Search","single-line":"",dense:"",flat:"",solo:"",id:"tsSearchInput"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()},click:function(t){e.showSearchDropdown=!0}},scopedSlots:e._u([{key:"append",fn:function(){return[t("v-icon",{staticClass:"mr-3",attrs:{title:"Run search"},on:{click:function(t){return e.search()}}},[e._v("mdi-magnify")]),t("v-icon",{attrs:{title:"Show search examples"},on:{click:function(t){e.showSearchHelp=!0}}},[e._v("mdi-help-circle-outline")])]},proxy:!0}],null,!0),model:{value:e.currentQueryString,callback:function(t){e.currentQueryString=t},expression:"currentQueryString"}},"v-text-field",s,!1),i))]}}]),model:{value:e.showSearchDropdown,callback:function(t){e.showSearchDropdown=t},expression:"showSearchDropdown"}},[t("ts-search-dropdown",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.onClickOutside,expression:"onClickOutside"}],attrs:{"selected-labels":e.selectedLabels,"query-string":e.currentQueryString},on:{addChip:e.addChip,updateLabelChips:function(t){return e.updateLabelChips()},"close-on-click":function(t){e.showSearchDropdown=!1},"node-click":e.jumpInHistory,setQueryAndFilter:e.setQueryAndFilter}})],1)],1),t("div",{staticClass:"mt-4"},[t("v-card",{directives:[{name:"show",rawName:"v-show",value:e.showSearchHistory,expression:"showSearchHistory"}],attrs:{outlined:""}},[t("v-toolbar",{attrs:{dense:"",flat:""}},[t("v-toolbar-title",[e._v("Search history")]),t("v-spacer"),t("v-slider",{staticClass:"mt-6",attrs:{"thumb-label":"",ticks:"","append-icon":"mdi-magnify-plus-outline","prepend-icon":"mdi-magnify-minus-outline",min:"0.1",max:"1",step:"0.1"},scopedSlots:e._u([{key:"thumb-label",fn:function({value:t}){return[e._v(" "+e._s(100*t)+"% ")]}}]),model:{value:e.zoomLevel,callback:function(t){e.zoomLevel=t},expression:"zoomLevel"}}),t("v-btn",{staticClass:"ml-4",attrs:{icon:""},on:{click:function(t){e.showSearchHistory=!1}}},[t("v-icon",{attrs:{title:"Close search history"}},[e._v("mdi-close")])],1)],1),t("v-divider"),t("div",{directives:[{name:"dragscroll",rawName:"v-dragscroll"}],staticClass:"pa-md-4 no-scrollbars",staticStyle:{overflow:"scroll","white-space":"nowrap","max-height":"500px","min-height":"100px"}})],1)],1),t("v-dialog",{attrs:{"max-width":"1800",scrollable:""},model:{value:e.showSearchHelp,callback:function(t){e.showSearchHelp=t},expression:"showSearchHelp"}},[t("ts-search-help-card",{attrs:{flat:!0},on:{"close-dialog":function(t){e.showSearchHelp=!1}}})],1),t("div",[t("v-toolbar",{staticClass:"mt-n3",staticStyle:{"background-color":"transparent"},attrs:{flat:"",dense:""}},[t("v-btn",{attrs:{small:"",icon:""},on:{click:function(t){e.showTimelines=!e.showTimelines}}},[e.showTimelines?t("v-icon",{attrs:{title:"Hide Timelines"}},[e._v("mdi-chevron-up")]):t("v-icon",{attrs:{title:"Show Timelines"}},[e._v("mdi-chevron-down")])],1),t("span",{staticClass:"timeline-header"},[t("ts-upload-timeline-form-button",{attrs:{"btn-type":"small"}}),t("v-dialog",{attrs:{width:"600"},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-btn",e._g(e._b({attrs:{small:"",text:"",rounded:"",color:"primary"}},"v-btn",s,!1),i),[t("v-icon",{attrs:{left:"",small:""}},[e._v(" mdi-plus ")]),e._v("\n                Add manual event\n              ")],1)]}}]),model:{value:e.addManualEvent,callback:function(t){e.addManualEvent=t},expression:"addManualEvent"}},[t("ts-add-manual-event",{attrs:{app:"",datetimeProp:e.datetimeManualEvent},on:{cancel:function(t){e.addManualEvent=!1}}})],1),t("v-btn",{attrs:{small:"",text:"",rounded:"",color:"primary"},on:{click:function(t){return t.stopPropagation(),e.enableAllTimelines()}}},[t("v-icon",{attrs:{left:"",small:""}},[e._v("mdi-eye")]),t("span",[e._v("Select all")])],1),t("v-btn",{attrs:{small:"",text:"",rounded:"",color:"primary"},on:{click:function(t){return t.stopPropagation(),e.disableAllTimelines()}}},[t("v-icon",{attrs:{left:"",small:""}},[e._v("mdi-eye-off")]),t("span",[e._v("Unselect all")])],1)],1)],1),t("v-expand-transition",[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showTimelines,expression:"showTimelines"}]},[t("ts-timeline-picker",{attrs:{"current-query-filter":e.currentQueryFilter,"count-per-index":e.countPerIndex,"count-per-timeline":e.countPerTimeline}})],1)])],1),t("div",[e._l(e.timeFilterChips,(function(i,s){return t("span",{key:s+i.value},[t("v-menu",{attrs:{"offset-y":"","content-class":"menu-with-gap"},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t("v-chip",e._g({attrs:{outlined:""}},s),[t("v-icon",{attrs:{left:"",small:""}},[e._v(" mdi-clock-outline ")]),t("span",{style:[i.active?"":{"text-decoration":"line-through",opacity:"50%"}]},[t("span",[e._v(e._s(i.value.split(",")[0]))]),"datetime_range"===i.type&&i.value.split(",")[0]!==i.value.split(",")[1]?t("span",[e._v("\n                  → "+e._s(i.value.split(",")[1]))]):e._e()])],1)]}}],null,!0)},[t("v-card",[t("v-list",[t("v-menu",{staticStyle:{overflow:"visible"},attrs:{"offset-y":"","close-on-content-click":!1,"close-on-click":!0,"nudge-top":"70","content-class":"menu-with-gap","allow-overflow":""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-list-item",e._g(e._b({},"v-list-item",s,!1),i),[t("v-list-item-action",[t("v-icon",[e._v("mdi-square-edit-outline")])],1),t("v-list-item-subtitle",[e._v("Edit filter")])],1)]}}],null,!0)},[t("ts-filter-menu",{attrs:{app:"","selected-chip":i},on:{updateChip:function(t){return e.updateChip(t,i)}}})],1),t("v-list-item",{on:{click:function(t){return e.copyFilterChip(i)}}},[t("v-list-item-action",[t("v-icon",[e._v("mdi-content-copy")])],1),t("v-list-item-subtitle",[e._v("Copy filter")])],1),t("v-list-item",{on:{click:function(t){return e.toggleChip(i)}}},[t("v-list-item-action",[i.active?t("v-icon",[e._v("mdi-eye-off")]):t("v-icon",[e._v("mdi-eye")])],1),t("v-list-item-subtitle",[i.active?t("span",[e._v("Temporarily disable")]):t("span",[e._v("Re-enable")])])],1),t("v-list-item",{on:{click:function(t){return e.removeChip(i)}}},[t("v-list-item-action",[t("v-icon",[e._v("mdi-delete")])],1),t("v-list-item-subtitle",[e._v("Remove filter")])],1)],1)],1)],1),s+1<e.timeFilterChips.length?t("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"2px"},attrs:{icon:"",small:""}},[e._v("OR")]):e._e()],1)})),t("span",[t("v-menu",{staticStyle:{overflow:"visible"},attrs:{"offset-y":"","close-on-content-click":!1,"close-on-click":!0,"content-class":"menu-with-gap","allow-overflow":""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-btn",e._g(e._b({attrs:{small:"",text:"",rounded:"",color:"primary"}},"v-btn",s,!1),i),[t("v-icon",{attrs:{left:"",small:""}},[e._v(" mdi-clock-plus-outline ")]),e._v("\n              Add timefilter\n            ")],1)]}}]),model:{value:e.timeFilterMenu,callback:function(t){e.timeFilterMenu=t},expression:"timeFilterMenu"}},[t("ts-filter-menu",{attrs:{app:""},on:{cancel:function(t){e.timeFilterMenu=!1},addChip:e.addChip}})],1)],1)],2),e.filterChips.length?t("div",{staticClass:"mt-1"},[t("v-chip-group",{attrs:{column:""}},e._l(e.filterChips,(function(i,s){return t("span",{key:s+i.value},[t("v-tooltip",{attrs:{top:"",disabled:i.value.length<33,"open-delay":"300"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:a}){return[t("v-chip",e._g(e._b({attrs:{outlined:"",close:"","close-icon":"mdi-close"},on:{"click:close":function(t){return e.removeChip(i)},click:function(t){return e.copyFilterChip(i)}}},"v-chip",a,!1),s),["__ts_star"===i.value?t("v-icon",{attrs:{left:"",small:"",color:"amber"}},[e._v("mdi-star")]):e._e(),"__ts_comment"===i.value?t("v-icon",{attrs:{left:"",small:""}},[e._v("mdi-comment-multiple-outline")]):e._e(),e.getQuickTag(i.value)?t("v-icon",{attrs:{left:"",small:"",color:e.getQuickTag(i.value).color}},[e._v(e._s(e.getQuickTag(i.value).label))]):e._e(),"must_not"===i.operator?t("span",{staticClass:"filter-chip-truncate"},[t("span",{staticStyle:{color:"red"}},[e._v("NOT ")]),e._v("\n                  "+e._s(e._f("formatLabelText")(i.field?`${i.field} : ${i.value}`:i.value))+"\n                ")]):t("span",{staticClass:"filter-chip-truncate"},[e._v("\n                  "+e._s(e._f("formatLabelText")(i.field?`${i.field} : ${i.value}`:i.value))+"\n                ")])],1)]}}],null,!0)},[t("span",[e._v(e._s(i.value))])]),s+1<e.timeFilterChips.length?t("v-btn",{staticClass:"mr-2",staticStyle:{"margin-top":"2px"},attrs:{icon:"",small:""}},[e._v("AND")]):e._e()],1)})),0)],1):e._e()],1),t("v-card",{staticClass:"mt-5 mx-3",attrs:{flat:"",color:"transparent"}},[t("ts-event-list",{attrs:{"query-request":e.activeQueryRequest},on:{countPerIndex:function(t){return e.updateCountPerIndex(t)},countPerTimeline:function(t){return e.updateCountPerTimeline(t)}}})],1)],1)}),I=[],R=(i("ac6a"),i("34f3")),M=function(){var e=this,t=e._self._c;return Object.keys(e.treeData).length>0?t("ul",{staticClass:"tree"},[t("tree-node",{attrs:{node:e.treeData,"handle-click":e.handleClick,"selected-node":e.selectedNode}})],1):e._e()},N=[],j=(i("6b54"),function(){var e=this,t=e._self._c;return t("li",[t("span",{class:[{active:e.isSelected},{star:e.hasStar&&!e.isSelected},{dimmed:0===e.count&&!e.isSelected}],staticStyle:{"min-width":"280px"},attrs:{id:e.node.id},on:{click:function(t){return e.handleClick(e.node)}}},[e.hasStar?t("v-icon",{staticClass:"mr-1",staticStyle:{float:"left"},attrs:{title:"Added a Star to an event",color:"amber darken-2"}},[e._v("mdi-star")]):e._e(),e.hasComment?t("v-icon",{staticClass:"mr-1",staticStyle:{float:"left"},attrs:{title:"Added a Comment to an event"}},[e._v("mdi-comment-outline")]):e._e(),e.hasLabel?t("v-icon",{staticStyle:{float:"left","margin-right":"10px"},attrs:{title:"Added a Label to an event"}},[e._v("mdi-label")]):e._e(),t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("div",e._g(e._b({staticClass:"query-string",class:[{"query-string-active":e.isSelected}],staticStyle:{float:"left"}},"div",s,!1),i),[e._v("\n          "+e._s(e.node.query_string)+"\n        ")])]}}])},[t("span",[e._v(e._s(e.node.query_string)+" "+e._s(e.node))])]),t("div",{staticClass:"tag is-light",staticStyle:{"margin-left":"5px",float:"right"}},[t("small",[e._v(e._s(e._f("compactNumber")(e.count)))])])],1),e.node.children&&e.node.children.length?t("ul",e._l(e.node.children,(function(i){return t("node",{key:i.id,attrs:{node:i,"handle-click":e.handleClick,"selected-node":e.selectedNode}})})),1):e._e()])}),U=[],B={name:"node",props:{node:Object,handleClick:Function,selectedNode:Object},computed:{hasStar(){return this.node.labels.includes("__ts_star")},hasLabel(){return this.node.labels.includes("__ts_label")},hasComment(){return this.node.labels.includes("__ts_comment")},isSelected(){return this.selectedNode.id===this.node.id},count(){return this.node.query_result_count||0}}},Q=B,z=(i("6774"),Object(d["a"])(Q,j,U,!1,null,"a080baf6",null)),q=z.exports;function H(e,t,i){if(e.hasOwnProperty(t)&&!0===i(t,e[t]))return e;for(let s=0;s<Object.keys(e).length;s++){let a=e[Object.keys(e)[s]];if("object"===typeof a&&null!=a){let e=H(a,t,i);if(null!=e)return e}}return null}var V={components:{TreeNode:q},data(){return{treeData:{},selectedNode:null,initialNode:null}},computed:{sketch(){return this.$store.state.sketch}},methods:{handleClick(e){this.$emit("node-click",e),this.selectedNode=e},handleClickFromDropdown(e){let t;t="number"===typeof e?e:e.id;let i=H(this.treeData,"id",(e,i)=>i===t);this.$emit("node-click",i),this.selectedNode=i},createBranch(e){if(this.selectedNode){if(this.selectedNode.id===e.id)return;return this.selectedNode.children.push(e),void(this.selectedNode=e)}this.fetchHistory();let t=H(this.treeData,"id",(t,i)=>i===e.parent);if(t){if(t.children.some(t=>t.id===e.id))return;return t.children.push(e),void(this.selectedNode=e)}let i=H(this.treeData,"id",(t,i)=>i===e.id);i&&(this.selectedNode=i)},annotateNode(e){e.searchNode.labels.includes(e.type)||e.searchNode.labels.push(e.type)},scrollTo(){this.$nextTick((function(){document.getElementById(this.selectedNode.id.toString()).scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}))},fetchHistory(){this.treeData=null,console.log("[SearchHistoryTree] Search history not available in browser mode")}},beforeDestroy(){o.$off("createBranch"),o.$off("eventAnnotated"),o.$off("triggerScrollTo"),o.$off("selected-node-from-dropdown")},created:function(){o.$on("createBranch",this.createBranch),o.$on("eventAnnotated",this.annotateNode),o.$on("triggerScrollTo",this.scrollTo),o.$on("selected-node-from-dropdown",this.handleClickFromDropdown),this.fetchHistory()},watch:{selectedNode:function(){this.$store.dispatch("updateSearchNode",this.selectedNode),this.scrollTo()}}},W=V,G=Object(d["a"])(W,M,N,!1,null,null,null),Y=G.exports,J=function(){var e=this,t=e._self._c;return t("span",[t("v-btn",{attrs:{icon:"",disabled:!e.hasParent},on:{click:e.searchHistoryBack}},[t("v-icon",{attrs:{title:"Go back to your last search"}},[e._v("mdi-arrow-left")])],1),t("v-btn",{attrs:{icon:"",disabled:!e.hasChild},on:{click:e.searchHistoryForward}},[t("v-icon",{attrs:{title:"Go to your next search"}},[e._v("mdi-arrow-right")])],1),t("v-btn",{attrs:{icon:""},on:{click:function(t){return e.$emit("toggleSearchHistory")}}},[t("v-icon",{attrs:{title:"Open your search history"}},[e._v("mdi-history")])],1)],1)},K=[],X={computed:{currentSearchNode(){return this.$store.state.currentSearchNode},hasParent(){return!!this.currentSearchNode&&"number"===typeof this.currentSearchNode.parent},hasChild(){return!!this.currentSearchNode&&this.currentSearchNode.children.length}},methods:{searchHistoryBack:function(){o.$emit("selected-node-from-dropdown",this.currentSearchNode.parent)},searchHistoryForward:function(){if(!this.currentSearchNode.children.length)return;let e=this.currentSearchNode.children.slice(-1).pop();o.$emit("selected-node-from-dropdown",e)}}},Z=X,ee=(i("669b"),Object(d["a"])(Z,J,K,!1,null,"5fd1791a",null)),te=ee.exports,ie=function(){var e=this,t=e._self._c;return t("v-card",{staticStyle:{overflow:"hidden"},attrs:{outlined:"","min-height":"550"}},[t("v-row",[e.matches.savedSearches.length?t("v-col",{attrs:{cols:"3"}},[t("h5",{staticClass:"mt-3 ml-4"},[e._v("Saved searches")]),t("v-list",{staticClass:"overflow-y-auto",class:e.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},e._l(e.matches.savedSearches,(function(i){return t("v-list-item",{key:i.id,staticStyle:{"font-size":"0.9em"},on:{click:function(t){return e.$emit("setActiveView",i)}}},[t("v-list-item-content",[e._v("\n            "+e._s(i.name)+"\n          ")])],1)})),1)],1):e._e(),t("v-divider",{attrs:{vertical:""}}),e.matches.timeFilters.length?t("v-col",{attrs:{cols:"3"}},[t("h5",{staticClass:"mt-3 ml-4"},[e._v("Last time filters")]),t("v-list",{staticClass:"overflow-y-auto",class:e.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},[e._l(e.matches.timeFilters.slice(0,e.MAX_TIMELINE_ELEMENTS),(function(i){return[t("v-list-item",{key:i.value,staticStyle:{"font-size":"0.9em"},on:{click:function(t){return e.setTimeFilter(i)}}},[t("v-list-item-content",[e._v("\n              "+e._s(i.value.split(",")[0])+" - "+e._s(i.value.split(",")[1])+"\n            ")])],1)]}))],2)],1):e._e(),t("v-divider",{attrs:{vertical:""}}),t("v-col",{attrs:{cols:"3"}},[t("h5",{staticClass:"mt-3 ml-4"},[e._v("Data types")]),t("v-list",{staticClass:"overflow-y-auto",class:e.scrollbarTheme,staticStyle:{height:"500px"},attrs:{dense:""}},e._l(e.matches.eventActions,(function(i){return t("v-list-item",{key:e.dataType.data_type,staticStyle:{"font-size":"0.9em"},on:{click:function(t){return e.searchForDataType(e.dataType.data_type)}}},[t("v-list-item-content",[t("span",[e._v(e._s(e.dataType.data_type)+"\n              "),t("span",{staticClass:"font-weight-bold",staticStyle:{"font-size":"0.8em"}},[e._v("("+e._s(e._f("compactNumber")(e.dataType.count))+")")])])])],1)})),1)],1),t("v-divider",{attrs:{vertical:""}}),e.matches.labels.length||e.matches.tags.length?t("v-col",{attrs:{cols:"3"}},[t("h5",{staticClass:"mt-3 ml-5"},[e._v("Tags")]),t("ts-tags-list")],1):e._e()],1)],1)},se=[],ae=function(){var e=this,t=e._self._c;return t("div",[t("div",[t("v-data-iterator",{attrs:{items:e.allTagsAndLabels,"items-per-page":e.itemsPerPage,search:e.search,"hide-default-footer":e.allTagsAndLabels.length<=e.itemsPerPage},on:{"update:itemsPerPage":function(t){e.itemsPerPage=t},"update:items-per-page":function(t){e.itemsPerPage=t}},scopedSlots:e._u([e.allTagsAndLabels.length>e.itemsPerPage?{key:"header",fn:function(){return[t("v-toolbar",{attrs:{flat:""}},[t("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for tags ..."},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)]},proxy:!0}:null,{key:"default",fn:function(i){return e._l(i.items,(function(i){return t("div",{key:i.tag||i.label,staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(t){return e.applyFilterChip(i.tag||i.label,i.tag?"tag":"",i.tag?"term":"label")}}},[t("v-row",{staticClass:"pa-2 pl-5",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},["__ts_star"===i.label?t("v-icon",{attrs:{left:"",small:"",color:"amber"}},[e._v("mdi-star")]):e._e(),"__ts_comment"===i.label?t("v-icon",{attrs:{left:"",small:""}},[e._v("mdi-comment-multiple-outline")]):e._e(),e.getQuickTag(i.tag)?t("v-icon",{attrs:{small:"",left:"",color:e.getQuickTag(i.tag).color}},[e._v(e._s(e.getQuickTag(i.tag).label))]):e._e(),t("span",[e._v("\n              "+e._s(e._f("formatLabelText")(i.tag||i.label))+" ("),t("small",[t("strong",[e._v(e._s(e._f("compactNumber")(i.count)))])]),e._v(")\n            ")])],1)],1)}))}}],null,!0)})],1)])},ne=[],re={props:[],data:function(){return{quickTags:[{tag:"bad",color:"red",textColor:"white",label:"mdi-alert-circle-outline"},{tag:"suspicious",color:"orange",textColor:"white",label:"mdi-help-circle-outline"},{tag:"good",color:"green",textColor:"white",label:"mdi-check-circle-outline"}],itemsPerPage:10,search:""}},computed:{meta(){return this.$store.state.meta},tags(){return this.$store.state.tags},labels(){return this.meta.filter_labels||[]},customTags(){return this.tags.filter(e=>!this.getQuickTag(e.tag))},assignedQuickTags(){return this.tags.filter(e=>this.getQuickTag(e.tag))},allTagsAndLabels(){const e=["__ts_star","__ts_comment","bad","suspicious","good"],t=Array.isArray(this.labels)?this.labels:[];return[...t,...this.assignedQuickTags,...this.customTags].filter(e=>e.tag||e.label).filter(e=>!(e.label&&e.label.startsWith("__ts_fact"))).sort((t,i)=>{const s=t.tag||t.label,a=i.tag||i.label,n=!!t.label,r=!!i.label;if(n&&!r)return-1;if(!n&&r)return 1;const o=e.indexOf(s),l=e.indexOf(a);return o>-1&&l>-1?o-l:o>-1?-1:l>-1?1:s.localeCompare(a)})}},methods:{getQuickTag(e){return this.quickTags.find(t=>t.tag===e)},applyFilterChip(e,t="",i="label"){let s={doSearch:!0,queryString:"*"},a={field:t,value:e,type:i,operator:"must",active:!0};s.chip=a,o.$emit("setQueryAndFilter",s)}}},oe=re,le=Object(d["a"])(oe,ae,ne,!1,null,null,null),ce=le.exports,de=i("bd86");i("a481");function ue(e){return"string"!==typeof e?e:e.replace(/\\/g,"\\\\").replace(/%/g,"\\%").replace(/_/g,"\\_")}function me(e={}){const t=[],i=[];if(e.query&&e.query.trim()){const s=ue(e.query.trim());t.push("(e.message LIKE ? OR e.attributes LIKE ?)"),i.push(`%${s}%`,`%${s}%`)}if(e.upload_id){const s=Array.isArray(e.upload_id)?e.upload_id:[e.upload_id];if(s.length>0){const e=s.map(()=>"?").join(",");t.push(`e.upload_id IN (${e})`),i.push(...s)}}if(e.category){const s=Array.isArray(e.category)?e.category:[e.category];if(s.length>0){const e=s.map(()=>"?").join(",");t.push(`e.category IN (${e})`),i.push(...s)}}return e.labels&&Array.isArray(e.labels)&&e.labels.length>0&&e.labels.forEach(e=>{t.push("json_extract(e.labels, '$') LIKE ?"),i.push(`%"${ue(e)}"%`)}),e.dateRange&&(e.dateRange.start&&(t.push("e.timestamp >= ?"),i.push(e.dateRange.start)),e.dateRange.end&&(t.push("e.timestamp <= ?"),i.push(e.dateRange.end))),e.event_kind&&(t.push("e.event_kind = ?"),i.push(e.event_kind)),{clause:t.length>0?"WHERE "+t.join(" AND "):"",params:i}}function he(e={}){const t=(e.order||"desc").toUpperCase(),i=e.orderBy||"timestamp",s=["timestamp","id","message","category"],a=s.includes(i)?i:"timestamp",n=["ASC","DESC"].includes(t)?t:"DESC";return`ORDER BY e.${a} ${n}`}function pe(e={}){const t=parseInt(e.size||40,10),i=parseInt(e.from||0,10);return{clause:"LIMIT ? OFFSET ?",params:[t,i]}}function ve(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function fe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(i),!0).forEach((function(t){Object(de["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ve(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}async function ge(e="",t={}){const i=await Qe(),{clause:s,params:a}=me(fe(fe({},t),{},{query:e})),n=he(t),{clause:r,params:o}=pe(t),l=`\n    SELECT \n      e.id, e.upload_id, e.timestamp, e.message, e.attributes, e.tags, e.labels,\n      e.event_category, e.event_type, e.event_action, e.event_kind,\n      f.opfs_filename as source_file, \n      u.given_name as timeline_name, u.platform\n    FROM events e\n    LEFT JOIN uploaded_files f ON json_extract(e.file_ids, '$[0]') = f.id\n    LEFT JOIN uploads u ON e.upload_id = u.id\n    ${s}\n    ${n}\n    ${r}\n  `,c=[...a,...o],d=await i.exec(l,{bind:c,returnValue:"resultRows",rowMode:"object"}),u=await Se(i,s,a),m=await xe(i,s,a),h=d.map(e=>Ce(e));return{objects:h,meta:{total_count:u,count_per_timeline:m}}}async function _e(){const e=await Qe(),t=await e.exec("SELECT COUNT(*) as count FROM events",{returnValue:"resultRows",rowMode:"object"});return t[0]&&t[0].count||0}async function ye(e){const t=await Qe(),i=Array.isArray(e)?e:[e];if(0===i.length)return;const s=i.map(()=>"?").join(","),a=`DELETE FROM events WHERE id IN (${s})`;await t.exec(a,{bind:i})}async function be(){const e=await Qe(),t="\n    SELECT event_action, COUNT(*) as count \n    FROM events \n    WHERE event_action IS NOT NULL AND event_action != ''\n    GROUP BY event_action \n    ORDER BY count DESC\n  ",i=await e.exec(t,{returnValue:"resultRows",rowMode:"object"});return i.map(e=>({action:e.event_action,count:e.count}))}async function we(){const e=await Qe(),t="\n    SELECT tags \n    FROM events \n    WHERE tags IS NOT NULL AND tags != '' AND tags != '[]'\n  ",i=await e.exec(t,{returnValue:"resultRows",rowMode:"object"}),s={};return i.forEach(e=>{try{const t=JSON.parse(e.tags);Array.isArray(t)&&t.forEach(e=>{e&&(s[e]=(s[e]||0)+1)})}catch(t){console.warn("Failed to parse tags:",e.tags,t)}}),Object.entries(s).map(([e,t])=>({tag:e,count:t})).sort((e,t)=>t.count-e.count)}async function Se(e,t,i){const s="SELECT COUNT(*) as count FROM events e "+t,a=await e.exec(s,{bind:i,returnValue:"resultRows",rowMode:"object"});return a[0]&&a[0].count||0}async function xe(e,t,i){const s=`\n    SELECT e.upload_id, COUNT(*) as count \n    FROM events e \n    ${t} \n    GROUP BY e.upload_id\n  `,a=await e.exec(s,{bind:i,returnValue:"resultRows",rowMode:"object"}),n={};return a.forEach(e=>{n[e.upload_id]=e.count}),n}function Ce(e){let t={},i=[],s=[],a=[],n=[];try{t=e.attributes?JSON.parse(e.attributes):{}}catch(o){console.warn("Failed to parse attributes:",o)}try{i=e.tags?JSON.parse(e.tags):[]}catch(o){console.warn("Failed to parse tags:",o)}try{s=e.labels?JSON.parse(e.labels):[]}catch(o){console.warn("Failed to parse labels:",o)}try{a=e.event_category?JSON.parse(e.event_category):[]}catch(o){console.warn("Failed to parse event_category:",o)}try{n=e.event_type?JSON.parse(e.event_type):[]}catch(o){console.warn("Failed to parse event_type:",o)}const r=fe(fe({},t),{},{primary_timestamp:e.timestamp,timestamp:e.timestamp,message:e.message,category:a,type:n,event_action:e.event_action,event_kind:e.event_kind,tags:i,labels:s,timeline_name:e.timeline_name,timeline_id:e.upload_id,platform:e.platform,filename:e.source_file});return{_id:String(e.id),_index:e.upload_id,_source:r}}async function ke(e,t){if(!e||0===e.length||!t||0===t.length)return;const i=await Qe();for(const a of e){const e=await i.exec("SELECT labels FROM events WHERE id = ?",{bind:[a],returnValue:"resultRows",rowMode:"array"});if(0===e.length)continue;let n=[];try{n=e[0][0]?JSON.parse(e[0][0]):[]}catch(s){console.error("[addLabelEvent] Failed to parse labels:",s),n=[]}const r=[...new Set([...n,...t])];await i.exec("UPDATE events SET labels = ? WHERE id = ?",{bind:[JSON.stringify(r),a]})}}async function Te(e,t){if(!e||0===e.length||!t||0===t.length)return;const i=await Qe();for(const a of e){const e=await i.exec("SELECT labels FROM events WHERE id = ?",{bind:[a],returnValue:"resultRows",rowMode:"array"});if(0===e.length)continue;let n=[];try{n=e[0][0]?JSON.parse(e[0][0]):[]}catch(s){console.error("[removeLabelEvent] Failed to parse labels:",s);continue}const r=n.filter(e=>!t.includes(e));await i.exec("UPDATE events SET labels = ? WHERE id = ?",{bind:[JSON.stringify(r),a]})}}async function Ee(e,t){const i=await Qe();await i.exec("UPDATE events SET tags = ? WHERE id = ?",{bind:[JSON.stringify(t||[]),e]})}async function De(){const e=await Qe(),t="\n    SELECT \n      u.id,\n      u.given_name as name,\n      u.platform,\n      u.upload_timestamp as created_at,\n      u.updated_at,\n      COALESCE(u.color, '5E75C2') as color,\n      'ready' as status,\n      COUNT(e.id) as event_count\n    FROM uploads u\n    LEFT JOIN events e ON e.upload_id = u.id\n    GROUP BY u.id\n    ORDER BY u.upload_timestamp DESC\n  ",i=await e.exec(t,{returnValue:"resultRows",rowMode:"object"});return{objects:i||[]}}async function Oe(e){if(!e)return console.error("[Uploads DB] No uploadId provided"),null;const t=await Qe(),i="\n    SELECT \n      u.id,\n      u.given_name as name,\n      u.platform,\n      u.upload_timestamp as created_at,\n      u.updated_at,\n      COALESCE(u.color, '5E75C2') as color,\n      'ready' as status,\n      COUNT(e.id) as event_count\n    FROM uploads u\n    LEFT JOIN events e ON e.upload_id = u.id\n    WHERE u.id = ?\n    GROUP BY u.id\n  ",s=await t.exec(i,{bind:[parseInt(e,10)],returnValue:"resultRows",rowMode:"object"});return s.length>0?s[0]:null}async function Pe(e,t){const i=await Qe(),s=["given_name","color"],a=[],n=[];for(const[o,l]of Object.entries(t))s.includes(o)&&(a.push(o+" = ?"),n.push(l));if(0===a.length)return void console.log("[uploadDB.updateUpload] No allowed fields found to update");a.push("updated_at = ?"),n.push(Date.now()/1e3),n.push(e);const r=`UPDATE uploads SET ${a.join(", ")} WHERE id = ?`;await i.exec(r,{bind:n})}async function Fe(e){const t=await Qe();await t.exec("DELETE FROM events WHERE upload_id = ?",{bind:[e]}),await t.exec("DELETE FROM uploaded_files WHERE upload_id = ?",{bind:[e]}),await t.exec("DELETE FROM raw_data WHERE upload_id = ?",{bind:[e]}),await t.exec("DELETE FROM uploads WHERE id = ?",{bind:[e]})}async function Le(e){const t=await Qe(),i="\n    SELECT id, event_id, comment, created_at, updated_at\n    FROM event_comments\n    WHERE event_id = ?\n    ORDER BY created_at ASC\n  ",s=await t.exec(i,{bind:[e],returnValue:"resultRows",rowMode:"object"});return s||[]}async function Ae(e,t){const i=await Qe(),s=(new Date).toISOString(),a="\n    INSERT INTO event_comments (event_id, comment, created_at, updated_at)\n    VALUES (?, ?, ?, ?)\n  ";await i.exec(a,{bind:[e,t,s,s]});const n=await i.exec("SELECT last_insert_rowid() as id",{returnValue:"resultRows",rowMode:"object"});return{id:n[0]&&n[0].id||null,event_id:e,comment:t,created_at:s,updated_at:s}}async function $e(e,t){const i=await Qe(),s=(new Date).toISOString(),a="\n    UPDATE event_comments\n    SET comment = ?, updated_at = ?\n    WHERE id = ?\n  ";await i.exec(a,{bind:[t,s,e]});const n=await i.exec("SELECT * FROM event_comments WHERE id = ?",{bind:[e],returnValue:"resultRows",rowMode:"object"});return n[0]||null}async function Ie(e){const t=await Qe(),i="DELETE FROM event_comments WHERE id = ?";await t.exec(i,{bind:[e]})}async function Re(){const e=await Qe();if(!e)throw new Error("Database not initialized");const t=await e.exec("SELECT COUNT(*) as count FROM events",{returnValue:"resultRows",rowMode:"object"});let i=[],s=0,a=[];if(0!=t.length){i=await e.exec("SELECT field, type FROM v_event_field_mappings ORDER BY field ASC",{returnValue:"resultRows",rowMode:"object"}),s=t[0]&&t[0].count||0;try{a=await we()}catch(n){console.warn("Failed to get event tags:",n),a=[]}}return{mappings:i||[],attributes:{},filter_labels:a||[],count_per_index:{},emojis:{},search_node:null,total_items:s}}async function Me(){const e=await Qe(),t=await e.exec("SELECT field, type FROM v_device_field_mappings ORDER BY field ASC",{returnValue:"resultRows",rowMode:"object"}),i=await e.exec("SELECT COUNT(*) as count FROM auth_devices_initial",{returnValue:"resultRows",rowMode:"object"}),s=i[0]&&i[0].count||0;return{mappings:t||[],attributes:{},filter_labels:[],count_per_index:{},emojis:{},search_node:null,total_items:s}}var Ne=i("e2c1");let je=null,Ue=0;function Be(e,t){return new Promise((i,s)=>{const a=Ue++,n=e=>{if(e.data.id===a)if(je.removeEventListener("message",n),e.data.error){const t=new Error(e.data.error.message);t.name=e.data.error.name,t.stack=e.data.error.stack,s(t)}else i(e.data.result)};je.addEventListener("message",n),je.postMessage({id:a,method:e,args:t})})}async function Qe(){return je||(console.log("[Database] Initializing stateless sqlite-worker..."),je=new Worker("/sqlite-worker.js"),window.dbWorker=je),{exec(e,t){return Be("exec",{sql:e,options:t||{},schemaPath:"/schema.sql"})}}}async function ze(){je&&(je.terminate(),je=null,console.log("[Database] Connection closed, sqlite-worker thread terminated"))}async function qe(){const e=await Qe(),t=["uploads","uploaded_files","raw_data","events","auth_devices_initial","event_comments"];for(const i of t)await e.exec(`DELETE FROM ${i};`);console.log("[Database] All imported data rows have been cleared.")}var He={getDB:Qe,closeDB:ze,clearAllTables:qe,searchEvents:ge,getEventCount:_e,getEventActions:be,getEventTags:we,deleteEvents:ye,addLabelEvent:ke,removeLabelEvent:Te,updateEventTags:Ee,getUploads:De,getUploadById:Oe,updateUpload:Pe,deleteUpload:Fe,getEventComments:Le,addEventComment:Ae,updateEventComment:$e,deleteEventComment:Ie,getEventMeta:Re,getDeviceMeta:Me},Ve={components:{TsTagsList:ce},props:["selectedLabels","queryString"],data(){return{eventActions:[]}},async mounted(){try{this.eventActions=await He.getEventActions()}catch(e){console.error("Error loading eventActions:",e),this.eventActions=[]}},computed:{sketch(){return this.$store.state.sketch},meta(){return this.$store.state.meta},searchHistory(){return this.$store.state.searchHistory},tags(){return this.$store.state.tags},eventActionsForDropdown(){return this.eventActions},filteredMetaLabels(){return this.meta.filter_labels.filter(e=>!e.label.startsWith("__ts_fact"))},all(){return{fields:this.meta.mappings,tags:this.tags,labels:this.filteredMetaLabels,eventActions:this.eventActions,savedSearches:this.meta.views,timeFilters:this.timeFilters}},timeFilters(){return this.$store.state.timeFilters},scrollbarTheme(){return this.$vuetify.theme.dark?"dark":"light"},matches(){let e={};return this.queryString?(e.fields=this.meta.mappings.filter(e=>e.field.toLowerCase().includes(this.queryString.toLowerCase())),e.tags=this.tags.filter(e=>e.tag.toLowerCase().includes(this.queryString.toLowerCase())),e.labels=this.filteredMetaLabels.filter(e=>e.label.toLowerCase().includes(this.queryString.toLowerCase())),e.eventActions=this.eventActions.filter(e=>e.action.toLowerCase().includes(this.queryString.toLowerCase())),e.savedSearches=this.meta.views.filter(e=>e.name.toLowerCase().includes(this.queryString.toLowerCase())),Object.values(e).filter(e=>e.length).length?e:this.all):this.all}},methods:{searchForDataType(e){let t={doSearch:!0};t.queryString='data_type:"'+e+'"',this.$emit("setQueryAndFilter",t)},searchForField(e){let t={},i="";""!==this.queryString&&(i=this.queryString+" "),this.queryString.includes(" ")||(i=""),t.doSearch=!1,t.queryString=i+e+":",this.$emit("setQueryAndFilter",t)},setTimeFilter(e){this.$emit("addChip",e)},fetchTimeFilters(){this.$store.dispatch("updateTimeFilters")}},created:function(){this.fetchTimeFilters()},setup:function(){return{MAX_TIMELINE_ELEMENTS:10}}},We=Ve,Ge=(i("f072"),Object(d["a"])(We,ie,se,!1,null,"35ea72a2",null)),Ye=Ge.exports,Je=function(){var e=this,t=e._self._c;return t("span",[e._l(e.allTimelines,(function(i){return t("ts-timeline-chip",{key:i.id+i.name,staticClass:"mr-2 mb-3 timeline-chip",attrs:{timeline:i,"is-selected":e.isSelected(i),"is-empty-state":e.isEmptyState,"events-count":e.getCount(i)},on:{remove:e.remove,save:e.save,toggle:e.toggleTimeline,disableAllOtherTimelines:e.disableAllOtherTimelines}})})),e.sketch.timelines.length>20?t("v-btn",{staticClass:"mt-n3 mr-5",attrs:{small:"",text:"",rounded:"",color:"primary"},on:{click:function(t){e.showAll=!e.showAll}}},[e.showAll?t("span",[e._v(" show less ")]):t("span",[e._v(" "+e._s(e.sketch.timelines.length-20)+" more.. ")])]):e._e(),t("br")],2)},Ke=[],Xe=function(){var e=this,t=e._self._c;return t("ts-timeline-component",{attrs:{timeline:e.timeline,eventsCount:e.eventsCount,isSelected:e.isSelected,isEmptyState:e.isEmptyState},on:{toggle:function(t){return e.$emit("toggle",...arguments)},disableAllOtherTimelines:function(t){return e.$emit("disableAllOtherTimelines",...arguments)},save:function(t){return e.$emit("save",...arguments)},remove:function(t){return e.$emit("remove",...arguments)}},scopedSlots:e._u([{key:"processing",fn:function(i){return[t("v-chip",e._g({style:e.timelineStyle(i.timelineStatus)},i.events.on),[t("span",{staticClass:"timeline-name-ellipsis"},[e._v(e._s(e.timeline.name))]),t("span",{staticClass:"ml-1"},[t("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:20,width:1}})],1)])]}},{key:"processed",fn:function(i){return[t("v-chip",{staticClass:"pr-1 timeline-chip",class:[{failed:i.timelineFailed},e.$vuetify.theme.dark?"dark-highlight":"light-highlight"],style:e.timelineStyle(i.timelineStatus),attrs:{ripple:!i.timelineFailed},on:{click:i.events.toggleTimeline}},[t("div",{staticClass:"chip-content"},[i.timelineFailed?t("v-icon",{attrs:{title:"Import failed; click for details",left:"",color:"red",size:"x-large"},on:{click:i.events.openDialog}},[e._v("\n          mdi-alert-circle-outline\n        ")]):e._e(),i.timelineFailed?e._e():t("v-icon",{staticClass:"ml-n2",attrs:{title:"Toggle visibility",left:"",color:i.timelineChipColor,size:"26"}},[e._v(" mdi-circle ")]),t("v-tooltip",{attrs:{bottom:"",disabled:e.timeline.name.length<30,"open-delay":"200"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:a}){return[t("span",e._g(e._b({staticClass:"timeline-name-ellipsis",class:{disabled:!e.isSelected&&("processing"===i.timelineStatus||"ready"===i.timelineStatus)}},"span",a,!1),s),[e._v(e._s(e.timeline.name))])]}}],null,!0)},[t("span",[e._v(e._s(e.timeline.name))])]),t("span",{staticClass:"right"},["processing"===i.timelineStatus?t("span",{staticClass:"ml-3"},[t("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:20,width:2}})],1):e._e(),i.timelineFailed?e._e():t("span",{staticClass:"events-count",attrs:{"x-small":""}},[e._v("\n            "+e._s(e._f("compactNumber")(e.eventsCount))+"\n          ")]),t("v-btn",e._g({staticClass:"ma-1",attrs:{"x-small":"",icon:""}},i.events.menuOn),[t("v-icon",{attrs:{title:"Manage Timeline"}},[e._v(" mdi-dots-vertical ")])],1)],1)],1)])]}}])})},Ze=[],et=function(){var e=this,t=e._self._c;return e.timeline&&e.timeline.id?t("span",[t("v-menu",{ref:"timelineChipMenuRef",attrs:{"offset-y":"","max-width":"385","close-on-content-click":!1,"content-class":"menu-with-gap"},scopedSlots:e._u([{key:"activator",fn:function({on:t}){return[e._t("processed",null,{timelineFailed:e.timelineFailed,timelineChipColor:e.timelineChipColor,timelineStatus:e.timeline.status,events:{toggleTimeline:e.toggleTimeline,openDialog:e.openDialog,menuOn:t}})]}}],null,!0)},[t("v-sheet",{attrs:{flat:""}},[t("v-list",{attrs:{dense:""}},[t("v-dialog",{attrs:{width:"600"},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-list-item",e._g(e._b({},"v-list-item",s,!1),i),[t("v-list-item-action",[t("v-icon",[e._v("mdi-square-edit-outline")])],1),t("v-list-item-subtitle",[e._v("Rename")])],1)]}}],null,!1,1061110918),model:{value:e.dialogRename,callback:function(t){e.dialogRename=t},expression:"dialogRename"}},[t("v-card",{staticClass:"pa-4"},[t("v-form",{on:{submit:function(t){return t.preventDefault(),e.rename()}}},[t("h3",[e._v("Rename timeline")]),t("br"),t("v-text-field",{attrs:{clearable:"",outlined:"",dense:"",autofocus:"",rules:e.timelineNameRules},on:{focus:function(e){return e.target.select()}},model:{value:e.newTimelineName,callback:function(t){e.newTimelineName=t},expression:"newTimelineName"}}),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:function(t){e.dialogRename=!1}}},[e._v(" Cancel ")]),t("v-btn",{attrs:{disabled:!e.newTimelineName||e.newTimelineName.length>255,color:"primary",text:""},on:{click:function(t){return e.rename()}}},[e._v(" Save ")])],1)],1)],1)],1),e.timelineAvailable?t("v-list-item",{on:{click:function(t){return e.$emit("toggle",e.timeline)}}},[t("v-list-item-action",[e.isSelected?t("v-icon",[e._v("mdi-eye-off")]):t("v-icon",[e._v("mdi-eye")])],1),e.isSelected?t("v-list-item-subtitle",[e._v("Temporarily disabled")]):t("v-list-item-subtitle",[e._v("Re-enable")])],1):e._e(),e.timelineAvailable?t("v-list-item",{on:{click:function(t){return e.$emit("disableAllOtherTimelines",e.timeline)}}},[t("v-list-item-action",[t("v-icon",[e._v("mdi-checkbox-marked-circle-minus-outline")])],1),t("v-list-item-subtitle",[e._v("Unselect other timelines")])],1):e._e(),t("v-dialog",{attrs:{width:"800"},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-list-item",e._g(e._b({},"v-list-item",s,!1),i),[t("v-list-item-action",[t("v-icon",{attrs:{color:"mdi-alert-circle-outline"===e.iconStatus?"red":""}},[e._v(e._s(e.iconStatus))])],1),t("v-list-item-subtitle",[e._v("Uploaded files ("+e._s(e.documentMetadata.length)+")")])],1)]}}],null,!1,1846829707),model:{value:e.dialogStatus,callback:function(t){e.dialogStatus=t},expression:"dialogStatus"}},[t("v-card",[t("div",{staticClass:"pa-4"},[t("ul",{staticStyle:{"list-style-type":"none"}},[t("li",[t("strong",[e._v("Timeline name: ")]),e._v(e._s(e.timeline.name))]),"processing"===e.timeline.status||"ready"===e.timeline.status?t("li",[t("strong",[e._v("Number of events: ")]),e._v("\n                  "+e._s(e._f("compactNumber")(e.allIndexedEvents))+"\n                ")]):e._e(),t("li",[t("strong",[e._v("Created at: ")]),e._v(e._s(e._f("shortDateTime")(e.timeline.created_at))+"\n                  "),t("small",[e._v("("+e._s(e._f("timeSince")(e.timeline.created_at))+")")])]),t("li",[t("strong",[e._v("Number of files uploaded: ")]),e._v(e._s(e.documentMetadata.length))])]),e._l(e.documentMetadata,(function(i){return t("v-alert",{key:i.id,staticClass:"ma-5",attrs:{outlined:"",text:"",color:i.source_config&&i.source_config.parse_error_message?"error":"success"}},[t("ul",{staticStyle:{"list-style-type":"none"}},[t("li",[t("strong",[e._v("File name:")]),e._v(" "+e._s(i.file_name))]),t("li",[t("strong",[e._v("Path in ZIP:")]),e._v(" "+e._s(i.path))]),t("li",[t("strong",[e._v("File size:")]),e._v(" "+e._s(e._f("compactBytes")(i.size_bytes)))]),t("li",[t("strong",[e._v("MIME type:")]),e._v(" "+e._s(i.mime_type))]),t("li",[t("strong",[e._v("Rows parsed:")]),e._v(" "+e._s(e._f("compactNumber")(i.source_config&&i.source_config.rows_parsed||0)))]),i.labels&&i.labels.length?t("li",[t("strong",[e._v("Labels:")]),e._v(" "+e._s(i.labels.join(", ")))]):e._e(),i.source_config&&i.source_config.parse_error_message?t("li",[t("strong",[e._v("Parse error:")]),t("code",[e._v(" "+e._s(i.source_config.parse_error_message))])]):t("li",{staticClass:"text-success"},[e._v("✓ Parsed successfully")])])])}))],2),t("v-divider"),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.dialogStatus=!1}}},[e._v(" Close ")])],1)],1)],1),e.timelineAvailable?t("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.deleteConfirmation=!0}}},[t("v-list-item-action",[t("v-icon",[e._v("mdi-trash-can-outline")])],1),t("v-list-item-subtitle",[e._v("Delete")])],1):e._e(),t("v-dialog",{attrs:{"max-width":"500"},model:{value:e.deleteConfirmation,callback:function(t){e.deleteConfirmation=t},expression:"deleteConfirmation"}},[t("v-card",[t("v-card-title",[t("v-icon",{staticClass:"mr-2 ml-n3",attrs:{color:"red"}},[e._v("mdi-alert-octagon-outline")]),e._v(" Delete Timeline?\n            ")],1),t("v-card-text",[t("ul",{staticStyle:{"list-style-type":"none"}},[t("li",[t("strong",[e._v("Name: ")]),e._v(e._s(e.timeline.name))]),t("li",[t("strong",[e._v("Status: ")]),e._v(e._s(e.timeline.status))]),"processing"===e.timeline.status||"ready"===e.timeline.status?t("li",[t("strong",[e._v("Number of events: ")]),e._v("\n                  "+e._s(e._f("compactNumber")(e.allIndexedEvents))+"\n                ")]):e._e(),t("strong",[e._v("Number of events: ")]),e._v("\n                "+e._s(e._f("compactNumber")(e.allIndexedEvents))+"\n                "),t("li",[t("strong",[e._v("Created at: ")]),e._v(e._s(e._f("shortDateTime")(e.timeline.created_at))+"\n                  "),t("small",[e._v("("+e._s(e._f("timeSince")(e.timeline.created_at))+")")])])])]),t("v-card-actions",[t("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.deleteConfirmation=!1}}},[e._v(" cancel ")]),t("v-spacer"),t("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){return e.remove()}}},[e._v(" delete ")])],1)],1)],1)],1),e.timelineFailed?e._e():t("div",{staticClass:"px-4"},[t("v-color-picker",{attrs:{value:"#"+e.timeline.color,"show-swatches":!e.showCustomColorPicker,swatches:e.colorPickerSwatches,"hide-canvas":!e.showCustomColorPicker,"hide-sliders":!e.showCustomColorPicker,"hide-inputs":"",mode:"hexa","dot-size":"15"},on:{"update:color":e.updateColor}}),t("v-btn",{staticClass:"mt-2",attrs:{text:"","x-small":""},on:{click:function(t){e.showCustomColorPicker=!e.showCustomColorPicker}}},[e.showCustomColorPicker?t("span",[e._v("Palette")]):t("span",[e._v("Custom color")])])],1),t("br")],1)],1)],1):e._e()},tt=[],it=i("2ef0"),st=i.n(it);const at=[["#222"],["#42b3f4"],["red","orange","yellow"],["purple","violet"],["#00c6ff","#F0F","#FF0"],["#f72047","#ffd200","#1feaea"]];var nt={props:["timeline","eventsCount","isSelected","isEmptyState"],data(){return{allIndexedEvents:0,totalEvents:null,dialogStatus:!1,dialogRename:!1,documentMetadata:[],eventsPerSecond:[],newTimelineName:[...this.timeline.name],sparkline:{width:2,radius:10,padding:8,lineCap:"round",gradient:at[5],gradientDirection:"bottom",gradients:at,fill:!1,type:"trend",autoDrawDuration:4e3,autoLineWidth:!1},showCustomColorPicker:!1,colorPickerSwatches:[["#5E75C2","#BB77C4","#FD7EAC"],["#FF9987","#FFC66A","#F9F871"],["#FFB5BC","#97D788","#9BC1AF"],["#FFC7A0","#FFDF79","#FFEAEF"],["#DEBBFF","#9AB0FB","#CFFBE2"]],deleteConfirmation:!1,timelineNameRules:[e=>!!e||"Timeline name is required.",e=>e&&e.length<=255||"Timeline name is too long."]}},computed:{meta(){return this.$store.state.meta},sketch(){return this.$store.state.sketch},iconStatus(){return"ready"===this.timeline.status?"mdi-information-outline":"processing"===this.timeline.status?"mdi-circle-slice-7":"mdi-alert-circle-outline"},timelineFailed(){return"fail"===this.timeline.status},timelineAvailable(){return"ready"===this.timeline.status||"fail"===this.timeline.status||this.settings.showProcessingTimelineEvents&&"processing"===this.timeline.status},timelineChipColor(){return this.timeline&&this.timeline.color?this.timeline.color.startsWith("#")?this.timeline.color:"#"+this.timeline.color:"#5E75C2"},settings(){return this.$store.state.settings}},methods:{openDialog(){this.dialogStatus=!0},rename(){this.dialogRename=!1,this.$emit("save",this.timeline,this.newTimelineName)},remove(){this.$emit("remove",this.timeline),this.deleteConfirmation=!1,this.successSnackBar("Timeline deleted")},toggleTimeline(){this.timelineFailed||this.$emit("toggle",this.timeline)},updateColor(e){s["default"].set(this.timeline,"color",e.hex.substring(1)),this.$emit("save",this.timeline)},async loadDocumentMetadata(){this.documentMetadata=[]},dataSourceStatus(e){},datasourceStatusColors(e){},totalEventsDatasource(e){}},created(){if(!this.timeline||!this.timeline.status)return;this.meta&&this.meta.stats_per_timeline&&this.meta.stats_per_timeline[this.timeline.id];this.newTimelineName=this.timeline.name,this.loadDocumentMetadata()},beforeDestroy(){clearInterval(this.t),this.t=!1}},rt=nt,ot=(i("48bb"),Object(d["a"])(rt,et,tt,!1,null,"0e839b1e",null)),lt=ot.exports,ct={props:["timeline","eventsCount","isSelected","isEmptyState"],components:{TsTimelineComponent:lt},methods:{timelineStyle(e){const t=("processing"===e||"ready"===e)&&!this.isSelected;return{opacity:t?"50%":"100%",backgroundColor:this.$vuetify.theme.dark?"#303030":"#f5f5f5"}}}},dt=ct,ut=(i("ac72"),Object(d["a"])(dt,Xe,Ze,!1,null,"27e3d2d2",null)),mt=ut.exports,ht={components:{TsTimelineChip:mt},props:["currentQueryFilter","countPerIndex","countPerTimeline"],computed:{sketch(){return this.$store.state.sketch},allTimelines(){let e=[...this.sketch.timelines];return e=e.sort((function(e,t){return e.name.localeCompare(t.name)})),this.showAll||(e=e.slice(0,20)),e},activeTimelines(){let e=[...this.sketch.timelines];return e.sort((function(e,t){return e.name.localeCompare(t.name)}))},isEmptyState(){return void 0===this.countPerTimeline}},data(){return{isDarkTheme:!1,isLoading:!1,showAll:!1}},methods:{isSelected(e){return this.$store.state.enabledTimelines.includes(e.id)},getCount(e){if(this.countPerTimeline){const t=this.countPerTimeline[e.id];if("number"===typeof t)return t}return 0},async remove(e){this.isLoading=!0;try{await He.deleteUpload(e.id),await this.$store.dispatch("updateSketch",this.sketch.id),this.syncSelectedTimelines()}catch(t){console.error("[TimelinePicker] Failed to delete upload:",t)}finally{this.isLoading=!1}},async save(e,t=!1){t&&(this.isLoading=!0);try{await He.updateUpload(e.id,{given_name:t||e.name,color:e.color}),await this.$store.dispatch("updateSketch",this.sketch.id),this.syncSelectedTimelines()}catch(i){console.error("[TimelinePicker] Failed to update upload:",i)}finally{t&&(this.isLoading=!1)}},disableAllOtherTimelines(e){this.$store.dispatch("updateEnabledTimelines",[e.id])},toggleTimeline(e){this.$store.dispatch("toggleEnabledTimeline",e.id)},toggleTheme(){this.isDarkTheme=!this.isDarkTheme},syncSelectedTimelines(){if(this.currentQueryFilter.indices.includes("_all"))return void this.updateEnabledTimelinesIfChanged(this.activeTimelines.map(e=>e.id));let e=[];this.currentQueryFilter.indices.forEach(t=>{let i=this.activeTimelines.find(e=>String(e.id)===String(t));i&&e.push(i)}),this.updateEnabledTimelinesIfChanged(e.map(e=>e.id))},updateEnabledTimelinesIfChanged(e){st.a.isEqual(e,this.$store.state.enabledTimelines)||this.$store.dispatch("updateEnabledTimelines",e)}},created(){o.$on("isDarkTheme",this.toggleTheme)},watch:{"currentQueryFilter.indices"(e){this.syncSelectedTimelines()},deep:!0}},pt=ht,vt=(i("9783"),Object(d["a"])(pt,Je,Ke,!1,null,"db0c8324",null)),ft=vt.exports,gt=function(){var e=this,t=e._self._c;return t("v-card",{staticStyle:{overflow:"visible"},attrs:{width:"700"}},[t("v-container",{staticClass:"px-8"},[t("br"),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(t){return e.getDateRange(0,"days")}}},[e._v("Today")]),t("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(t){return e.getDateRange(7,"days")}}},[e._v("Last 7 days")]),t("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(t){return e.getDateRange(30,"days")}}},[e._v("Last 30 days")]),t("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(t){return e.getDateRange(90,"days")}}},[e._v("Last 90 days")]),t("v-btn",{staticClass:"mr-2",attrs:{small:"",depressed:""},on:{click:function(t){return e.getDateRange(1,"year")}}},[e._v("Last 1 year")])],1)],1),t("v-row",[t("v-col",{attrs:{cols:"6"}},[t("v-text-field",{attrs:{value:e.formatStartTime,label:"From",outlined:"","hide-details":""},on:{click:function(t){e.showPicker=!0},change:e.setStartTime}})],1),t("v-col",{attrs:{cols:"6"}},[t("v-text-field",{attrs:{value:e.formatEndTime,label:"To (optional)",outlined:"","hide-details":"","append-outer-icon":e.showPicker?"mdi-calendar-remove":"mdi-calendar"},on:{click:function(t){e.showPicker=!0},change:e.setEndTime,"click:append-outer":function(t){e.showPicker=!e.showPicker}}})],1)],1),e.showPicker?t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("date-picker",{ref:"picker",attrs:{mode:"dateTime",timezone:"UTC","is-dark":e.$vuetify.theme.dark,is24hr:"","is-range":"","is-expanded":""},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1)],1):e._e(),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:e.clearAndCancel}},[e._v(" Cancel ")]),t("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.submit()}}},[e._v(" Add filter ")])],1)],1)],1)},_t=[],yt=i("707c"),bt=i("404b"),wt=i.n(bt),St={props:["selectedChip"],components:{DatePicker:wt.a},data(){return{range:{start:"",end:""},filterTab:null,showPicker:!1}},computed:{dateRange:{set(e){e&&e.start&&e.end?(this.range.start=yt["a"].utc(e.start).millisecond(0).toISOString(),this.range.end=yt["a"].utc(e.end).millisecond(0).toISOString()):(this.range.start="",this.range.end="")},get(){let e={start:this.range.start,end:this.range.end};return e}},formatStartTime:function(){return this.range.start},formatEndTime:function(){return this.range.start!==this.range.end&&this.range.start?this.range.end:""}},created(){this.selectedChip&&(this.range.start=this.selectedChip.value.split(",")[0],this.range.end=this.selectedChip.value.split(",")[1])},methods:{getDateRange:function(e,t){let i=yt["a"].utc(),s=i.subtract(e,t),a="datetime_range",n=s.format("YYYY-MM-DD")+","+i.format("YYYY-MM-DD"),r={field:"",type:a,value:n,operator:"must",active:!0};return this.addChip(r),this.$emit("cancel"),{start:i,end:s}},setStartTime:function(e){e?(this.range.start=yt["a"].utc(e).toISOString(),this.range.end||this.range.start&&(this.range.end=this.range.start||""),this.$refs.picker.focusDate(this.range.start)):this.range.start=""},setEndTime:function(e){e?(this.range.end=yt["a"].utc(e).toISOString(),this.$refs.picker.focusDate(this.range.start)):this.range.end=""},addDateTimeChip:function(e){const t="datetime_range";let i={field:"",type:t,value:e,operator:"must",active:!0};this.addChip(i),this.range={start:null,end:null}},clearAndCancel:function(){this.range={start:"",end:""},this.$emit("cancel")},addChip:function(e){this.selectedChip?this.$emit("updateChip",e):this.$emit("addChip",e)},submit:function(){if(this.range.start){if(this.range.start===this.range.end){let e=this.range.start.split("T"),t=e[0],i=t+","+t;this.addDateTimeChip(i)}if(this.range.start,this.range.end,this.range.start!==this.range.end){let e="datetime_range",t=this.range.start+","+this.range.end,i={field:"",type:e,value:t,operator:"must",active:!0};this.addChip(i),this.range={start:"",end:""}}this.$emit("cancel")}}}},xt=St,Ct=Object(d["a"])(xt,gt,_t,!1,null,"be4e6400",null),kt=Ct.exports,Tt=function(){var e=this,t=e._self._c;return t("PlatformSelector",{scopedSlots:e._u([{key:"default",fn:function(i){return["small"===e.btnType?t("v-btn",e._g(e._b({attrs:{small:"",text:"",rounded:"",color:"primary"}},"v-btn",i.attrs,!1),i.on),[t("v-icon",{attrs:{left:"",small:""}},[e._v(" mdi-plus ")]),e._v("\n      Add Data Export\n    ")],1):t("v-btn",e._g(e._b({attrs:{rounded:"",depressed:"",color:"primary"}},"v-btn",i.attrs,!1),i.on),[t("v-icon",{attrs:{left:""}},[e._v(" mdi-plus ")]),e._v("\n      Add Data Export\n    ")],1)]}}])})},Et=[],Dt=function(){var e=this,t=e._self._c;return t("v-dialog",{attrs:{persistent:"","max-width":"700px"},on:{"click:outside":e.closeDialog},scopedSlots:e._u([{key:"activator",fn:function({on:t,attrs:i}){return[e._t("default",null,{attrs:i,on:t})]}}],null,!0),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t("v-card",["platform-selection"===e.step?t("div",{staticClass:"pa-8"},[t("h2",{staticClass:"text-h5 font-weight-medium mb-2"},[e._v("Select Platform")]),t("p",{staticClass:"text-body2 text-muted mb-6"},[e._v("\n        Choose which service's data export you'd like to analyze to start. You will be able to upload more data later.\n      ")]),t("v-row",{staticClass:"mb-8"},e._l(e.platforms,(function(i){return t("v-col",{key:i.id,attrs:{cols:"12",sm:"6"}},[t("v-card",{staticClass:"platform-card pa-4 cursor-pointer",attrs:{outlined:e.selectedPlatformId!==i.id,color:e.selectedPlatformId===i.id?"primary":"white",hover:""},on:{click:function(t){return e.selectPlatform(i.id)}}},[t("div",{staticClass:"d-flex align-center"},[t("div",{staticClass:"platform-logo mr-4"},[t("v-icon",{attrs:{size:"48",color:e.selectedPlatformId===i.id?"white":"primary"}},[e._v("\n                  "+e._s(i.icon)+"\n                ")])],1),t("div",{staticClass:"flex-grow-1"},[t("h3",{staticClass:"text-body1 font-weight-medium",class:e.selectedPlatformId===i.id?"white--text":""},[e._v("\n                  "+e._s(i.name)+"\n                ")]),t("p",{staticClass:"text-caption mb-0",class:e.selectedPlatformId===i.id?"white--text":"text-muted"},[e._v("\n                  "+e._s(i.description)+"\n                ")])]),e.selectedPlatformId===i.id?t("v-icon",{staticClass:"ml-2",attrs:{color:"white"}},[e._v("\n                mdi-check-circle\n              ")]):e._e()],1)])],1)})),1),t("div",{staticClass:"mb-6 pa-4 bg-info-lighten rounded"},[t("div",{staticClass:"d-flex align-center"},[t("v-icon",{staticClass:"mr-2",attrs:{small:""}},[e._v("mdi-information-outline")]),t("p",{staticClass:"text-body2 mb-0"},[e._v("\n            Don't have your data yet?\n            "),t("router-link",{staticClass:"font-weight-medium",attrs:{to:"/how-to-request",target:"_blank"}},[e._v("\n              View step-by-step instructions\n            ")]),e._v("\n            for requesting your data export.\n          ")],1)],1)]),t("div",{staticClass:"d-flex justify-end gap-2"},[t("v-btn",{attrs:{text:""},on:{click:e.closeDialog}},[e._v("\n          Cancel\n        ")]),t("v-btn",{attrs:{color:"primary",disabled:!e.selectedPlatformId},on:{click:e.proceedToUpload}},[e._v("\n          Next: Upload Data\n          "),t("v-icon",{attrs:{right:""}},[e._v("mdi-arrow-right")])],1)],1)],1):e._e(),"file-upload"===e.step?t("div",{staticClass:"pa-0"},[t("PlatformUploadForm",{attrs:{selectedPlatform:e.selectedPlatformId},on:{close:e.closeDialog,success:e.handleUploadSuccess}})],1):e._e()]),t("PrivacySettingsModal",{on:{close:e.finalizeUpload},model:{value:e.showPrivacySettings,callback:function(t){e.showPrivacySettings=t},expression:"showPrivacySettings"}})],1)},Ot=[],Pt=function(){var e=this,t=e._self._c;return t("span",[t("upload-progress-dialog",{attrs:{open:e.isUploading,progress:e.percentCompleted,"status-message":e.statusMessage},on:{"update:open":function(t){e.isUploading=t}}}),t("v-dialog",{attrs:{persistent:"","max-width":"700px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t("v-card",[t("v-card-title",{staticClass:"pb-2"},[t("span",[e._v("Import "+e._s(e.platformName)+" Data")]),t("v-spacer"),t("v-btn",{attrs:{icon:"",small:""},on:{click:e.closeDialog}},[t("v-icon",[e._v("mdi-close")])],1)],1),t("v-divider"),t("v-card-text",{staticClass:"pa-6"},[t("div",{staticClass:"mb-6"},[t("div",{staticClass:"d-flex align-center mb-4"},[t("v-icon",{staticClass:"mr-4",attrs:{size:"48",color:"primary"}},[e._v(e._s(e.platformIcon))]),t("div",[t("h3",{staticClass:"text-body1 font-weight-medium"},[e._v("Upload your "+e._s(e.platformName)+" data export")])])],1)]),t("v-alert",{staticClass:"mb-6",attrs:{outlined:"",type:"info"}},[t("h4",{staticClass:"text-body2 font-weight-medium mb-2"},[e._v("Before you upload:")]),t("ul",{staticClass:"text-body2 mb-0"},[t("li",[e._v("Make sure you've downloaded the ZIP file from "+e._s(e.platformName))]),t("li",[e._v("The file should contain the exported data structure exactly as downloaded")]),t("li",[e._v("Do not modify or extract files from the ZIP before uploading")])])]),t("div",{staticClass:"mb-6 pa-4 bg-blue-lighten rounded"},[t("div",{staticClass:"d-flex align-center"},[t("v-icon",{staticClass:"mr-2",attrs:{small:""}},[e._v("mdi-help-circle-outline")]),t("span",{staticClass:"text-body2"},[e._v("\n              Unsure how to get this data?\n              "),t("router-link",{staticClass:"font-weight-medium",attrs:{to:"/how-to-request",target:"_blank"}},[e._v("\n                View our step-by-step guide\n              ")])],1)],1)]),t("upload-error-display",{attrs:{"error-type":e.uploadErrorType,errors:e.uploadErrors,warnings:e.uploadWarnings,"local-errors":e.localErrors}}),t("div",{staticClass:"mb-6"},[t("v-file-input",{attrs:{label:"Choose ZIP file",outlined:"",dense:"",accept:".zip","prepend-icon":"mdi-file-archive","show-size":""},on:{change:e.handleFileSelected,"click:clear":e.clearFile},model:{value:e.selectedFile,callback:function(t){e.selectedFile=t},expression:"selectedFile"}})],1),e.selectedFile?t("div",{staticClass:"mb-6"},[t("v-text-field",{attrs:{label:"Timeline Name",outlined:"",dense:"",placeholder:`e.g., '${e.platformName} Data Export'`,rules:e.nameRules,counter:"255",hint:"Choose a descriptive name for this data export file","persistent-hint":""},model:{value:e.timelineName,callback:function(t){e.timelineName=t},expression:"timelineName"}})],1):e._e(),e.selectedFile&&e.fileValid?t("div",{staticClass:"mb-6 pa-4 bg-green-lighten rounded"},[t("div",{staticClass:"d-flex align-center"},[t("v-icon",{staticClass:"mr-2",attrs:{small:"",color:"success"}},[e._v("mdi-check-circle")]),t("div",{staticClass:"text-body2"},[t("strong",[e._v("Ready to import:")]),t("br"),e._v("\n              "+e._s(e.selectedFile.name)+" ("+e._s(e.formatFileSize(e.selectedFile.size))+")\n            ")])],1)]):e._e()],1),t("v-card-actions",{staticClass:"pa-4"},[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:e.closeDialog}},[e._v("\n          Cancel\n        ")]),t("v-btn",{attrs:{color:"primary",disabled:!e.canSubmit,loading:e.isUploading},on:{click:e.submitUpload}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-upload")]),e._v("\n          Import Data\n        ")],1)],1)],1)],1)],1)},Ft=[],Lt=(i("3b2b"),i("ac4d"),i("8a81"),i("72ba"));let At=null,$t=0;function It(){return At||(At=new Worker("/pyodide-worker.js"),console.log("[PyodideClient] Created Pyodide worker (singleton)")),At}function Rt(e,t){return new Promise((i,s)=>{const a=It(),n=$t++,r=e=>{if(e.data.id===n)if(a.removeEventListener("message",r),e.data.success)i(e.data.result);else{const t=new Error(e.data.error);t.errorType=e.data.errorType||"UNKNOWN_ERROR",t.source=e.data.source||"worker",s(t)}};a.addEventListener("message",r),a.postMessage({id:n,command:e,args:t})})}function Mt(){At&&(At.terminate(),At=null,console.log("[PyodideClient] Worker terminated"))}function Nt(e){var t,i,s,a=2;for("undefined"!=typeof Symbol&&(i=Symbol.asyncIterator,s=Symbol.iterator);a--;){if(i&&null!=(t=e[i]))return t.call(e);if(s&&null!=(t=e[s]))return new jt(t.call(e));i="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function jt(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return jt=function(e){this.s=e,this.n=e.next},jt.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var i=this.s.return;return void 0===i?Promise.resolve({value:e,done:!0}):t(i.apply(this.s,arguments))},throw:function(e){var i=this.s.return;return void 0===i?Promise.reject(e):t(i.apply(this.s,arguments))}},new jt(e)}class Ut{constructor(){this.opfsRoot=null,this.storageDir=null,this.dbFilename=null,this.whitelistPatterns=[],this.isInitialized=!1}async init(e){if(this.isInitialized)return;const t=await fetch("/config.yaml");if(!t.ok)throw new Error("[OPFSManager] Failed to fetch config.yaml");const i=Ne["a"].load(await t.text()),s=(i.storage||{}).temp_zip_storage;if(!s)throw new Error("[OPFSManager] storage.temp_zip_storage missing from config.yaml");const a=(i.database||{}).db_path||"",n=a.split("/").filter(Boolean);this.dbFilename=n[n.length-1];const r="/"+n.slice(0,-1).join("/"),o=s.startsWith(r)?s.slice(r.length):s;console.log(`[OPFSManager] Config: db_path=${a}, temp_zip_storage=${s}`),console.log(`[OPFSManager] Mount prefix: "${r}", relative storage path: "${o}"`),this.opfsRoot=await navigator.storage.getDirectory();const l=o.split("/").filter(Boolean);let c=this.opfsRoot;for(const g of l)c=await c.getDirectoryHandle(g,{create:!0}),console.log(`[OPFSManager] Created/opened OPFS dir segment: "${g}"`);this.storageDir=c;const d=[];var u,m=!1,h=!1;try{for(var p,v=Nt(this.opfsRoot.entries());m=!(p=await v.next()).done;m=!1){const[e]=p.value;d.push(e)}}catch(f){h=!0,u=f}finally{try{m&&null!=v.return&&await v.return()}finally{if(h)throw u}}if(console.log("[OPFSManager] OPFS root contents at init:",d),console.log(`[OPFSManager] Initialized. storageDir=[${l.join("/")}], dbFilename=${this.dbFilename}`),this.storageDir===this.opfsRoot)throw console.error("[OPFSManager] ERROR: storageDir is pointing to OPFS root! This would delete the database on cleanup."),new Error("OPFSManager storageDir misconfiguration: pointing to OPFS root");if(e)try{const t=await Rt("get_whitelist",{platform:e});this.whitelistPatterns=(t||[]).map(e=>{const t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return new RegExp(`(^|/)${t}$`,"i")}),console.log(`[OPFSManager] Loaded ${this.whitelistPatterns.length} whitelist patterns`)}catch(f){console.warn("[OPFSManager] Failed to load whitelist – accepting all files:",f),this.whitelistPatterns=[]}this.isInitialized=!0}isWhitelisted(e){if(0===this.whitelistPatterns.length)return!0;const t=e.replace(/\\/g,"/");return this.whitelistPatterns.some(e=>e.test(t))}flattenPath(e){return e.replace(/\//g,"___")}async processZipUpload(e,t){return await this.init(t),console.log("[OPFSManager] Processing upload: "+e.name),new Promise((t,i)=>{const s=[];let a=0,n=0,r=0,o=0;const l=new Lt["a"](e=>{if(!e.name.endsWith("/")&&(a++,this.isWhitelisted(e.name))){n++;const t=this.flattenPath(e.name);console.log(`[OPFSManager] Accepted [${n}]: ${e.name}  →  ${t}`);const i=this._saveFileEntry(t,e).then(()=>{r++}).catch(e=>{o++,console.error(`[OPFSManager] WRITE FAILED for ${t}:`,e)});s.push(i)}});l.register(Lt["b"]),l.onerror=e=>i(e);const c=e.stream().getReader(),d=this.storageDir,u=async()=>{while(1){const{done:f,value:g}=await c.read();if(f){l.push(new Uint8Array(0),!0),await Promise.all(s),console.log(`[OPFSManager] ZIP done: ${a} scanned, ${n} accepted, ${r} written, ${o} failed.`);const c=[];var e,u=!1,m=!1;try{for(var h,p=Nt(d.entries());u=!(h=await p.next()).done;u=!1){const[e]=h.value;c.push(e)}}catch(v){m=!0,e=v}finally{try{u&&null!=p.return&&await p.return()}finally{if(m)throw e}}console.log(`[OPFSManager] VERIFICATION: storageDir contains ${c.length} file(s):`,c),o>0?i(new Error(`${o} of ${n} OPFS writes failed — check console for details.`)):0===c.length&&n>0?i(new Error("Writes reported success but storageDir is empty — OPFS may not be persisting.")):t();break}l.push(g)}};u().catch(i)})}async clearTempStorage(){try{if(this.isInitialized||await this.init(),!this.storageDir||this.storageDir===this.opfsRoot)return void console.warn("[OPFSManager] Safety check: storageDir is root or null, aborting cleanup");let r=0;var e,t=!1,i=!1;try{for(var s,a=Nt(this.storageDir.entries());t=!(s=await a.next()).done;t=!1){const[e]=s.value;await this.storageDir.removeEntry(e,{recursive:!0}),r++}}catch(n){i=!0,e=n}finally{try{t&&null!=a.return&&await a.return()}finally{if(i)throw e}}console.log(`[OPFSManager] Temp storage cleared (${r} entries removed).`)}catch(r){throw console.error("[OPFSManager] Failed to clear temp storage:",r),r}}async clearDatabase(){try{this.isInitialized||await this.init();const t=[this.dbFilename,this.dbFilename+"-wal",this.dbFilename+"-shm"];let i=0;for(const s of t)try{await this.opfsRoot.removeEntry(s),console.log("[OPFSManager] Removed DB file: "+s),i++}catch(e){if("NotFoundError"!==e.name)throw e}console.log(`[OPFSManager] Database cleared (${i} file(s) removed).`)}catch(t){throw console.error("[OPFSManager] Failed to clear database:",t),t}}async nukeAll(){try{const r=await navigator.storage.getDirectory(),o=[];var e,t=!1,i=!1;try{for(var s,a=Nt(r.entries());t=!(s=await a.next()).done;t=!1){const[e]=s.value;o.push(e)}}catch(n){i=!0,e=n}finally{try{t&&null!=a.return&&await a.return()}finally{if(i)throw e}}console.log(`[OPFSManager] Nuking OPFS root (${o.length} entries):`,o);for(const e of o)await r.removeEntry(e,{recursive:!0});this.opfsRoot=null,this.storageDir=null,this.dbFilename=null,this.isInitialized=!1,console.log(`[OPFSManager] OPFS nuked – ${o.length} top-level entries removed.`)}catch(r){throw console.error("[OPFSManager] Failed to nuke OPFS:",r),r}}async _saveFileEntry(e,t){let i,s;console.log("[OPFSManager] _saveFileEntry START: "+e);try{i=await this.storageDir.getFileHandle(e,{create:!0}),console.log("[OPFSManager] Got file handle for: "+e)}catch(a){throw console.error(`[OPFSManager] getFileHandle FAILED for ${e}:`,a),a}try{s=await i.createWritable()}catch(a){throw console.error(`[OPFSManager] createWritable FAILED for ${e}:`,a),a}return new Promise((a,n)=>{let r,o=Promise.resolve(),l=0,c=0,d=!1;const u=()=>{r&&clearTimeout(r),r=setTimeout(()=>{if(!d){const t=`[OPFSManager] TIMEOUT: ${e} stalled (${c} chunks, ${l} bytes)`;console.error(t),s.close().catch(()=>{}),n(new Error(t))}},1e4)};u(),t.ondata=(t,m,h)=>{if(u(),t)return clearTimeout(r),console.error(`[OPFSManager] fflate ondata error for ${e}:`,t),void(o=o.then(()=>s.close()).catch(()=>{}).then(()=>n(t)));c++,l+=m.byteLength,o=o.then(()=>s.write(m)),h&&(d=!0,clearTimeout(r),o=o.then(()=>s.close()).then(async()=>{const t=await i.getFile();console.log(`[OPFSManager] Wrote ${e}: ${c} chunks, ${(l/1024).toFixed(1)} KB sent, ${(t.size/1024).toFixed(1)} KB on disk`),0===t.size&&l>0&&console.error(`[OPFSManager] FILE IS EMPTY ON DISK despite writing ${l} bytes!`),a()}).catch(t=>{console.error(`[OPFSManager] write/close FAILED for ${e}:`,t),n(t)}))},t.start()})}}const Bt={INVALID_ZIP:"INVALID_ZIP",MISSING_FILES:"MISSING_FILES",INVALID_JSON:"INVALID_JSON",INVALID_CSV:"INVALID_CSV",SCHEMA_MISMATCH:"SCHEMA_MISMATCH",MISSING_REQUIRED_FIELDS:"MISSING_REQUIRED_FIELDS",EMPTY_EXPORT:"EMPTY_EXPORT",PYODIDE_INIT_FAILED:"PYODIDE_INIT_FAILED",WORKER_TIMEOUT:"WORKER_TIMEOUT",WORKER_CRASHED:"WORKER_CRASHED",PARSER_ERROR:"PARSER_ERROR",DATABASE_ERROR:"DATABASE_ERROR",NETWORK_ERROR:"NETWORK_ERROR",UNKNOWN_ERROR:"UNKNOWN_ERROR"};function Qt(e){const t=[Bt.INVALID_ZIP,Bt.MISSING_FILES,Bt.INVALID_JSON,Bt.INVALID_CSV,Bt.SCHEMA_MISMATCH,Bt.MISSING_REQUIRED_FIELDS,Bt.EMPTY_EXPORT];return t.includes(e)}function zt(e){const t={[Bt.INVALID_ZIP]:"The uploaded file is not a valid ZIP archive.",[Bt.MISSING_FILES]:"Required files are missing from the export.",[Bt.INVALID_JSON]:"JSON data could not be parsed. The file may be corrupted.",[Bt.INVALID_CSV]:"CSV data could not be parsed. Please check the file format.",[Bt.SCHEMA_MISMATCH]:"The file format does not match the expected schema.",[Bt.MISSING_REQUIRED_FIELDS]:"Required data fields are missing from the export.",[Bt.EMPTY_EXPORT]:"No valid data found in the export.",[Bt.PYODIDE_INIT_FAILED]:"Failed to initialize the parsing engine. Please try again.",[Bt.WORKER_TIMEOUT]:"The parser is taking too long. Please try a smaller file.",[Bt.WORKER_CRASHED]:"The parser encountered an unexpected error. Please try again.",[Bt.PARSER_ERROR]:"An error occurred while parsing the data.",[Bt.DATABASE_ERROR]:"Failed to save data. Please try again.",[Bt.NETWORK_ERROR]:"Failed to fetch required resources. Please check your connection.",[Bt.UNKNOWN_ERROR]:"An unexpected error occurred."};return t[e]||"An error occurred."}const qt=!0;function Ht(...e){qt&&console.log("[UploadService]",...e)}function Vt(...e){console.error("[UploadService]",...e)}async function Wt(e,t,i,s){const a=Date.now(),n={success:!1,platform:t,totalEventsAdded:0,totalStatesAdded:0,errors:[],errorType:null,warnings:[],processingTimeMs:0};try{s&&s.commit("START_UPLOAD",e.name),Ht(`Starting upload process for ${t} platform with file: ${e.name}`),Ht("Step 1: Extracting ZIP to OPFS..."),s&&s.commit("UPDATE_UPLOAD_PROGRESS",{status:"validating",progress:10});const i=new Ut;try{await i.processZipUpload(e,t),Ht("ZIP extraction complete")}catch(r){const e="Failed to extract ZIP: "+r.message;return n.errors.push(e),s&&s.commit("FAIL_UPLOAD",{errors:[e],errorType:Bt.FILE_ERROR}),n}Ht("Step 2: Checking parser status..."),s&&s.commit("UPDATE_UPLOAD_PROGRESS",{status:"parsing",progress:25});try{const e=await Rt("isPyodideReady",{});e.pyodideReady||(Ht("Parser not ready yet, waiting for initialization..."),s&&s.commit("UPDATE_UPLOAD_PROGRESS",{status:"initializing",progress:28}))}catch(r){Ht("Warning: Could not check parser status: "+r.message)}let o;Ht("Step 3: Running Python extractor..."),s&&s.commit("UPDATE_UPLOAD_PROGRESS",{status:"parsing",progress:30});try{const i=await Rt("extract",{platform:t,givenName:e.name});if("success"!==i.status){const e=i.error||"Extraction failed";throw console.error("[UploadService] Extractor returned failure:",e),new Error(e)}if(o=i.upload_id,!o)throw Vt("Extractor did not return an upload ID"),new Error("Extractor did not return an upload ID");Ht("Extraction complete. Upload ID: "+o)}catch(r){await He.getDB();const e="Python extraction error: "+r.message;return n.errors.push(e),n.errorType=r.errorType||Bt.PARSER_ERROR,s&&s.commit("FAIL_UPLOAD",n),n}Ht("Step 4: Cleaning up OPFS temp files...");try{await i.clearTempStorage(),Ht("OPFS temp files cleared")}catch(r){Ht("Warning: failed to clear OPFS temp files: "+r.message),n.warnings.push("Temp files may not have been cleaned up from local storage.")}Ht("Step 5: Running Python semantic mapper..."),s&&s.commit("UPDATE_UPLOAD_PROGRESS",{status:"inserting",progress:60});try{if(!o)throw new Error("Upload ID not available for semantic mapping");const e=await Rt("semantic_map",{platform:t,uploadId:o});if("success"!==e.status)throw new Error(e.error||"Semantic mapping failed");n.totalEventsAdded=e.events_count||0,n.totalStatesAdded=e.devices_count||0,Ht(`Semantic mapping complete. ${n.totalEventsAdded} events, ${n.totalStatesAdded} devices`)}catch(r){const e="Python semantic mapping error: "+r.message;return n.errors.push(e),n.errorType=r.errorType||Bt.DATABASE_ERROR,s&&s.commit("FAIL_UPLOAD",n),n}Ht("Step 6: Refreshing UI..."),s&&s.commit("UPDATE_UPLOAD_PROGRESS",{status:"complete",progress:90});try{const e=await He.getUploads(),t={id:1,name:"Local Takeout Workspace",description:"Browser-only processing",status:[{status:"ready"}],timelines:e.objects||[]},i=await He.getEventMeta();s.commit("SET_SKETCH",{objects:[t],meta:i}),n.success=!0,s.commit("COMPLETE_UPLOAD",n),Ht("Upload complete")}catch(r){const e="Failed to refresh UI: "+r.message;n.errors.push(e),n.warnings.push("Data uploaded but UI refresh failed. Try reloading the page."),s&&s.commit("COMPLETE_UPLOAD",n)}}catch(r){console.error("[UploadService] Unexpected error during upload process:",r),n.errors.push("Unexpected error: "+r.message),n.errorType||(n.errorType=r.errorType||Bt.UNKNOWN_ERROR),s&&s.commit("FAIL_UPLOAD",n)}finally{n.processingTimeMs=Date.now()-a,Ht(`Upload process completed in ${n.processingTimeMs}ms`)}return n}var Gt=function(){var e=this,t=e._self._c;return t("v-dialog",{attrs:{persistent:"",width:"700"},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[t("v-card",{staticClass:"pa-5",attrs:{flat:""}},[t("h3",{staticClass:"mb-4"},[e._v("Processing Your Data Export...")]),t("br"),t("v-progress-linear",{attrs:{color:"primary",height:"25",value:e.progress}},[e._v("\n      "+e._s(e.progress)+"%\n    ")]),t("v-divider",{staticClass:"my-4"}),t("p",{staticClass:"text-body2 text-muted"},[e._v("\n      "+e._s(e.statusMessage)+"\n    ")])],1)],1)},Yt=[],Jt={name:"UploadProgressDialog",props:{open:{type:Boolean,required:!0},progress:{type:Number,default:0},statusMessage:{type:String,default:"Processing..."}},computed:{isOpen:{get(){return this.open},set(e){this.$emit("update:open",e)}}}},Kt=Jt,Xt=(i("2e25"),Object(d["a"])(Kt,Gt,Yt,!1,null,"25721887",null)),Zt=Xt.exports,ei=function(){var e=this,t=e._self._c;return t("div",[e.errorType?t("div",{staticClass:"mb-6"},[t("v-alert",{staticClass:"mb-2",attrs:{outlined:"",type:e.isUserError?"warning":"error"}},[t("strong",[e._v(e._s(e.isUserError?"Please fix your data:":"System Error:"))]),t("br"),e._v("\n      "+e._s(e.errorDisplayMessage)+"\n    ")]),e.errors.length>1?t("div",{staticClass:"mt-2"},[t("details",{staticClass:"text-body2"},[t("summary",[e._v("Additional details")]),t("div",{staticClass:"mt-2"},e._l(e.errors.slice(1),(function(i,s){return t("div",{key:s,staticClass:"text-body2 mb-1"},[e._v("\n            • "+e._s(i)+"\n          ")])})),0)])]):e._e()],1):e._e(),e.warnings.length>0?t("div",{staticClass:"mb-6"},e._l(e.warnings,(function(i,s){return t("v-alert",{key:s,staticClass:"mb-2",attrs:{outlined:"",type:"info"}},[e._v("\n      "+e._s(i)+"\n    ")])})),1):e._e(),e.localErrors.length>0&&!e.errorType?t("div",{staticClass:"mb-6"},e._l(e.localErrors,(function(i,s){return t("v-alert",{key:s,staticClass:"mb-2",attrs:{outlined:"",type:"error"}},[e._v("\n      "+e._s(i)+"\n    ")])})),1):e._e()])},ti=[],ii={name:"UploadErrorDisplay",props:{errorType:{type:String,default:null},errors:{type:Array,default:()=>[]},warnings:{type:Array,default:()=>[]},localErrors:{type:Array,default:()=>[]}},computed:{isUserError(){return!!this.errorType&&Qt(this.errorType)},errorDisplayMessage(){if(!this.errorType)return this.errors&&this.errors[0]||"An error occurred";const e=zt(this.errorType);return this.isUserError?e:e+" (Please try again or contact support)"}}},si=ii,ai=(i("9453"),Object(d["a"])(si,ei,ti,!1,null,"b2565378",null)),ni=ai.exports;const ri={google:{name:"Google Takeout",icon:"mdi-google"},discord:{name:"Discord",icon:"mdi-discord"},apple:{name:"Apple Data",icon:"mdi-apple"},facebook:{name:"Facebook/Meta",icon:"mdi-facebook"},instagram:{name:"Instagram",icon:"mdi-instagram"},snapchat:{name:"Snapchat",icon:"mdi-snapchat"}};function oi(e){const t=ri[e];return t?t.name:"Unknown Platform"}function li(e){const t=ri[e];return t?t.icon:"mdi-package"}function ci(e){const t=[];if(!e)return{valid:!1,errors:["No file selected"]};e.name.toLowerCase().endsWith(".zip")||t.push("Please select a ZIP file");const i=5368709120;return e.size>i&&t.push("File size exceeds 5GB limit"),{valid:0===t.length,errors:t}}function di(e){if(0===e)return"0 B";const t=1024,i=["B","KB","MB","GB"],s=Math.floor(Math.log(e)/Math.log(t));return Math.round(e/Math.pow(t,s)*100)/100+" "+i[s]}function ui(e){return e.replace(/\.zip$/i,"")}var mi={name:"PlatformUploadForm",components:{UploadProgressDialog:Zt,UploadErrorDisplay:ni},props:{selectedPlatform:{type:String,required:!0}},data(){return{dialog:!0,selectedFile:null,timelineName:"",nameRules:[e=>!!e||"Timeline name is required",e=>e&&e.length<=255||"Name must be less than 255 characters"],localErrors:[],fileValid:!1}},computed:{platformName(){return oi(this.selectedPlatform)},platformIcon(){return li(this.selectedPlatform)},canSubmit(){return this.selectedFile&&this.fileValid&&this.timelineName.trim().length>0&&!this.isUploading},isUploading(){return this.$store.state.uploadState.isProcessing},percentCompleted(){return this.$store.state.uploadState.progress},statusMessage(){return this.$store.state.uploadState.status},uploadErrorType(){return this.$store.state.uploadState.errorType},uploadErrors(){return this.$store.state.uploadState.errors},uploadWarnings(){return this.$store.state.uploadState.warnings}},watch:{statusMessage(e){"complete"===e&&(this.$emit("success"),this.closeDialog())}},mounted(){this.suggestTimelineName()},methods:{handleFileSelected(e){if(this.localErrors=[],this.fileValid=!1,!e)return;const t=ci(e);this.localErrors=t.errors,this.fileValid=t.valid,this.fileValid&&(this.timelineName=ui(e.name))},clearFile(){this.selectedFile=null,this.timelineName="",this.fileValid=!1,this.localErrors=[]},async suggestTimelineName(){this.timelineName&&""!==this.timelineName||(this.timelineName=this.selectedPlatform)},async submitUpload(){if(!this.canSubmit)return;const e=this.$store.state.sketch.id;if(e)try{await Wt(this.selectedFile,this.selectedPlatform,e,this.$store)}catch(t){this.localErrors.push(t.message||"An error occurred during upload")}else this.localErrors.push("No active sketch found")},formatFileSize(e){return di(e)},closeDialog(){this.dialog=!1,this.$emit("close")}}},hi=mi,pi=(i("e044"),Object(d["a"])(hi,Pt,Ft,!1,null,"3d60dadc",null)),vi=pi.exports,fi=function(){var e=this,t=e._self._c;return t("v-dialog",{attrs:{"max-width":"600px",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t("v-card",[t("v-toolbar",{staticClass:"grey lighten-4",attrs:{flat:"",dense:""}},[t("v-icon",{staticClass:"text--primary",attrs:{left:"",large:""}},[e._v("mdi-shield-account")]),t("v-toolbar-title",{staticClass:"text-h6 ma-4"},[e._v("Privacy & Visibility Settings")]),t("v-spacer"),t("v-btn",{attrs:{icon:""},on:{click:e.handleClose}},[t("v-icon",[e._v("mdi-close")])],1)],1),t("v-card-text",{staticClass:"pa-6"},[t("div",{staticClass:"mb-3"},[t("div",{staticClass:"mb-3"},[e._v("\n          In addition to login information, your data export contains records of account activity that might useful to you. Some of this data might be sensitive.\n        ")]),t("div",{staticClass:"mb-3"},[t("strong",[e._v("You are in full control of what data is visible on the screen.")])])]),t("div",{staticClass:"py-2"}),t("v-expansion-panels",[t("v-expansion-panel",[t("v-expansion-panel-header",[t("div",{staticClass:"d-flex align-center"},[t("v-icon",{attrs:{left:""}},[e._v("mdi-email-multiple-outline")]),t("div",{staticClass:"px-4"},[e._v("Message Contents")])],1)]),t("v-expansion-panel-content",[t("div",{staticClass:"text--secondary"},[e._v("\n                  Controls visibility of the written contents of texts, direct messages, & emails. Images are not processed.\n              ")]),t("v-radio-group",{staticClass:"mt-2",model:{value:e.settings.messagesEmails,callback:function(t){e.$set(e.settings,"messagesEmails",t)},expression:"settings.messagesEmails"}},[t("v-radio",{attrs:{label:e.LABELS.BLUR_BY_DEFAULT,value:e.VALUES.BLUR_BY_DEFAULT}}),t("v-radio",{attrs:{label:e.LABELS.SHOW_ALL,value:e.VALUES.SHOW_ALL}})],1)],1)],1),t("v-expansion-panel",[t("v-expansion-panel-header",[t("div",{staticClass:"d-flex align-center"},[t("v-icon",{attrs:{left:""}},[e._v("mdi-account-box-outline")]),t("div",{staticClass:"px-4"},[e._v("Contact Information")])],1)]),t("v-expansion-panel-content",[t("div",{staticClass:"text--secondary"},[e._v("Controls visibility of sender and recipient details of messages (texts, direct messages, & emails) and friend/follower requests.")]),t("v-radio-group",{staticClass:"mt-2",model:{value:e.settings.contactInfo,callback:function(t){e.$set(e.settings,"contactInfo",t)},expression:"settings.contactInfo"}},[t("v-radio",{attrs:{label:e.LABELS.BLUR_BY_DEFAULT,value:e.VALUES.BLUR_BY_DEFAULT}}),t("v-radio",{attrs:{label:e.LABELS.SHOW_ALL,value:e.VALUES.SHOW_ALL}})],1)],1)],1),t("v-expansion-panel",[t("v-expansion-panel-header",[t("div",{staticClass:"d-flex align-center"},[t("v-icon",{attrs:{left:""}},[e._v("mdi-thumb-up-outline")]),t("div",{staticClass:"px-4"},[e._v("Social Posts")])],1)]),t("v-expansion-panel-content",[t("div",{staticClass:"text--secondary"},[e._v("Controls visibility of text contents of social posts, comments, and likes.")]),t("v-radio-group",{staticClass:"mt-2",model:{value:e.settings.socialPosts,callback:function(t){e.$set(e.settings,"socialPosts",t)},expression:"settings.socialPosts"}},[t("v-radio",{attrs:{label:e.LABELS.BLUR_BY_DEFAULT,value:e.VALUES.BLUR_BY_DEFAULT}}),t("v-radio",{attrs:{label:e.LABELS.SHOW_ALL,value:e.VALUES.SHOW_ALL}})],1)],1)],1),t("v-expansion-panel",[t("v-expansion-panel-header",[t("div",{staticClass:"d-flex align-center"},[t("v-icon",{attrs:{left:""}},[e._v("mdi-history")]),t("div",{staticClass:"px-4"},[e._v("Search History")])],1)]),t("v-expansion-panel-content",[t("div",{staticClass:"text--secondary"},[e._v("Controls visibility of text contents of searches.")]),t("v-radio-group",{staticClass:"mt-2",model:{value:e.settings.searchHistory,callback:function(t){e.$set(e.settings,"searchHistory",t)},expression:"settings.searchHistory"}},[t("v-radio",{attrs:{label:e.LABELS.BLUR_BY_DEFAULT,value:e.VALUES.BLUR_BY_DEFAULT}}),t("v-radio",{attrs:{label:e.LABELS.SHOW_ALL,value:e.VALUES.SHOW_ALL}})],1)],1)],1)],1)],1),t("v-card-actions",{staticClass:"pa-4"},[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:e.handleClose}},[e._v("\n        Cancel\n      ")]),t("v-btn",{attrs:{color:"primary"},on:{click:e.handleSave}},[e._v("\n        Save & Continue\n      ")])],1)],1)],1)},gi=[],_i={name:"PrivacySettingsModal",props:{value:{type:Boolean,default:!1}},data(){return{LABELS:{SHOW_ALL:"Show all unblurred",BLUR_BY_DEFAULT:"Blur by default, click to unblur (Default)"},VALUES:{SHOW_ALL:"showAll",BLUR_BY_DEFAULT:"blurByDefault"},settings:{messagesEmails:"blurByDefault",searchHistory:"blurByDefault",socialPosts:"blurByDefault",contactInfo:"blurByDefault"}}},computed:{dialog:{get(){return this.value},set(e){this.$emit("input",e)}}},methods:{handleClose(){this.dialog=!1,this.$emit("close")},handleSave(){console.log("[PrivacySettings] Saved:",this.settings),this.handleClose()}}},yi=_i,bi=Object(d["a"])(yi,fi,gi,!1,null,null,null),wi=bi.exports,Si={name:"PlatformSelector",components:{PlatformUploadForm:vi,PrivacySettingsModal:wi},data(){return{dialog:!1,step:"platform-selection",selectedPlatformId:null,showPrivacySettings:!1,platforms:[{id:"google",name:"Google",icon:"mdi-google",description:"Includes Gmail, Drive, Photos"},{id:"discord",name:"Discord",icon:"mdi-discord",description:""},{id:"apple",name:"Apple",icon:"mdi-apple",description:"Includes iCloud activity, but not iMessages"},{id:"facebook",name:"Facebook",icon:"mdi-facebook",description:"Includes Meta account data if connected"},{id:"instagram",name:"Instagram",icon:"mdi-instagram",description:"Includes Meta account data if connected"},{id:"snapchat",name:"Snapchat",icon:"mdi-snapchat",description:""}]}},methods:{selectPlatform(e){this.selectedPlatformId=e},proceedToUpload(){this.step="file-upload"},closeDialog(){this.dialog=!1,this.step="platform-selection",this.selectedPlatformId=null},handleUploadSuccess(){this.showPrivacySettings=!0},finalizeUpload(){this.$emit("success"),this.closeDialog()}}},xi=Si,Ci=(i("1525"),Object(d["a"])(xi,Dt,Ot,!1,null,"7774c324",null)),ki=Ci.exports,Ti={props:["btnType"],components:{PlatformSelector:ki}},Ei=Ti,Di=Object(d["a"])(Ei,Tt,Et,!1,null,null,null),Oi=Di.exports,Pi=function(){var e=this,t=e._self._c;return t("v-card",{staticStyle:{overflow:"visible"},attrs:{width:"700"}},[t("v-container",{staticClass:"px-8"},[t("br"),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-text-field",{attrs:{value:e.datetime,label:"Datetime",outlined:"","hide-details":""},on:{click:function(t){e.showPicker=!0}},model:{value:e.datetime,callback:function(t){e.datetime=t},expression:"datetime"}})],1)],1),e.showPicker?t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("date-picker",{ref:"picker",attrs:{mode:"dateTime",timezone:"UTC","is-dark":e.$vuetify.theme.dark,is24hr:"","is-date":"","is-expanded":""},model:{value:e.dateFromPicker,callback:function(t){e.dateFromPicker=t},expression:"dateFromPicker"}})],1)],1):e._e(),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-text-field",{attrs:{value:e.message,label:"Message",outlined:"","hide-details":""},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1)],1),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-text-field",{attrs:{value:e.timestampDesc,label:"Timestamp Description",outlined:"","hide-details":""},model:{value:e.timestampDesc,callback:function(t){e.timestampDesc=t},expression:"timestampDesc"}})],1)],1),e._l(e.attributes,(function(i,s){return t("v-row",{key:s},[t("v-col",{attrs:{cols:"6"}},[t("v-text-field",{attrs:{label:"Attribute Name",outlined:"","hide-details":""},model:{value:e.attributes[s].name,callback:function(t){e.$set(e.attributes[s],"name",t)},expression:"attributes[index].name"}})],1),t("v-col",{attrs:{cols:"6"}},[t("v-text-field",{attrs:{label:"Attribute Value",outlined:"","hide-details":""},model:{value:e.attributes[s].value,callback:function(t){e.$set(e.attributes[s],"value",t)},expression:"attributes[index].value"}})],1)],1)})),t("v-card-actions",[t("v-btn",{attrs:{text:"",color:"primary",disabled:e.isDisabled},on:{click:function(t){return e.attributes.push({name:"",value:""})}}},[t("v-icon",[e._v("mdi-plus")]),e._v("\n        Add Attribute\n      ")],1),t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:function(t){return e.clearAndCancel()}}},[e._v(" Cancel ")]),t("v-btn",{attrs:{text:"",color:"primary"},on:{click:e.submit}},[e._v(" Save ")])],1)],2)],1)},Fi=[],Li={props:["datetimeProp"],components:{DatePicker:wt.a},data(){return{message:null,timestampDesc:null,filterTab:null,showPicker:!1,attributes:[],datetime:this.datetimeProp}},watch:{datetimeProp:function(e){this.datetime=e}},computed:{dateFromPicker:{set(e){null!==e&&(this.datetime=yt["a"].utc(e).millisecond(0).toISOString())},get(){return this.datetime}},isDisabled(){return this.attributes.some(e=>""===e.name||""===e.value)}},methods:{clearAndCancel:function(){this.datetime=null,this.message=null,this.timestampDesc=null,this.attributes=[],this.$emit("cancel")},submit:function(){if(null===this.datetime||null===this.message||null===this.timestampDesc)return;let e=this.$store.state.sketch.id,t={headers:{"Content-Type":"application/json"}},i={};this.attributes.filter(e=>!(""===e.name||""===e.value)).reduce((e,t)=>{i[t.name]=t.value},i),He.createEvent(e,this.datetime,this.message,this.timestampDesc,i,t).then(e=>{this.clearAndCancel()}).catch(e=>{})}}},Ai=Li,$i=Object(d["a"])(Ai,Pi,Fi,!1,null,"608c5b07",null),Ii=$i.exports,Ri=function(){var e=this,t=e._self._c;return t("div",[t("v-alert",{attrs:{dense:"",dismissible:"",type:"info"},model:{value:e.showBanner,callback:function(t){e.showBanner=t},expression:"showBanner"}},[e._v("\n    Data may be incomplete. Some timelines are still loading.\n  ")]),t("v-dialog",{attrs:{width:"700"},model:{value:e.exportDialog,callback:function(t){e.exportDialog=t},expression:"exportDialog"}},[t("v-card",{staticClass:"pa-5",attrs:{flat:""}},[t("v-progress-circular",{attrs:{indeterminate:"",size:"20",width:"1"}}),t("span",{staticClass:"ml-5"},[e._v("Exporting "+e._s(e.totalHits)+" events")])],1)],1),e.disableSaveSearch?e._e():t("v-dialog",{attrs:{width:"500"},model:{value:e.saveSearchMenu,callback:function(t){e.saveSearchMenu=t},expression:"saveSearchMenu"}},[t("v-card",{staticClass:"pa-4"},[t("h3",[e._v("Save Search")]),t("br"),t("v-text-field",{attrs:{clearable:"",required:"",placeholder:"Name your saved search",outlined:"",dense:"",autofocus:"",rules:e.saveSearchNameRules},on:{focus:function(e){return e.target.select()}},model:{value:e.saveSearchFormName,callback:function(t){e.saveSearchFormName=t},expression:"saveSearchFormName"}}),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:function(t){e.saveSearchMenu=!1}}},[e._v(" Cancel ")]),t("v-btn",{attrs:{text:"",color:"primary",disabled:!e.saveSearchFormName||e.saveSearchFormName.length>255},on:{click:e.saveSearch}},[e._v("\n          Save\n        ")])],1)],1)],1),e.eventList.objects.length||e.searchInProgress||e.currentQueryString?e._e():t("div",[t("ts-explore-welcome-card")],1),e.eventList.objects.length||e.searchInProgress||!e.currentQueryString?e._e():t("div",{staticClass:"ml-3"},[t("ts-search-not-found-card",{attrs:{currentQueryString:e.currentQueryString,filterChips:e.filterChips,disableSaveSearch:e.disableSaveSearch},on:{"save-search-clicked":function(t){e.saveSearchMenu=!0}}})],1),t("div",{staticClass:"ts-event-list-container"},[(e.eventList.objects.length>0||e.searchInProgress)&&e.userSettings.eventSummarization&&!e.eventList.meta.summaryError?t("v-card",{staticClass:"ts-ai-summary-card",attrs:{outlined:""}},[t("v-card-title",{staticClass:"ts-ai-summary-card-title"},[t("v-btn",{staticClass:"ts-ai-summary-fold-btn",attrs:{icon:"",small:""},on:{click:e.toggleSummary}},[t("v-icon",[e._v(e._s(e.summaryCollapsed?"mdi-chevron-down":"mdi-chevron-up"))])],1),t("v-icon",{staticClass:"ml-1 mr-2 ts-ai-summary-icon",attrs:{small:"",color:"primary"}},[e._v("mdi-shimmer")]),t("div",{staticClass:"ts-ai-summary-text-group"},[t("span",{staticClass:"ts-ai-summary-title"},[e._v("AI Summary")]),e.eventList.objects.length>0?t("span",{staticClass:"ts-ai-summary-subtitle"},[e._v("\n            (for "+e._s(e.eventList.objects.length)+" events in this view)\n          ")]):e._e()]),t("v-btn",{staticClass:"ml-1 ts-ai-summary-info-btn",attrs:{icon:"",small:"",title:e.summaryInfoMessage}},[t("v-icon",{attrs:{small:""}},[e._v("mdi-information-outline")])],1)],1),t("v-card-text",{directives:[{name:"show",rawName:"v-show",value:!e.summaryCollapsed,expression:"!summaryCollapsed"}],staticClass:"ts-ai-summary-text"},[e.isSummaryLoading||!e.eventList.meta.summary?t("div",[t("div",{staticClass:"ts-summary-placeholder-line shimmer"}),t("div",{staticClass:"ts-summary-placeholder-line shimmer short"}),t("div",{staticClass:"ts-summary-placeholder-line shimmer long"})]):t("div",{domProps:{innerHTML:e._s(e.eventList.meta.summary)}})])],1):e._e()],1),e.eventList.objects.length||e.searchInProgress?t("div",[t("v-data-table",{attrs:{headers:e.headers,items:e.DEBUG_filteredEventList,"footer-props":{"items-per-page-options":[10,40,80,100,200,500],"show-current-page":!0},loading:e.searchInProgress,options:e.tableOptions,"server-items-length":e.totalHitsForPagination,"item-key":"_id","loading-text":"Searching... Please wait","show-select":"","disable-filtering":"","must-sort":"","sort-desc":e.sortOrderAsc,"sort-by":"_source.timestamp","hide-default-footer":e.totalHits<11||e.disablePagination,expanded:e.expandedRows,dense:e.displayOptions.isCompact,"fixed-header":""},on:{"update:options":function(t){e.tableOptions=t},"update:sortDesc":function(t){e.sortOrderAsc=t},"update:sort-desc":[function(t){e.sortOrderAsc=t},e.sortEvents]},scopedSlots:e._u([{key:"top",fn:function({pagination:i,options:s,updateOptions:a}){return[t("v-toolbar",{attrs:{dense:"",flat:"",color:"transparent"}},[e.selectedEvents.length?t("div",{staticClass:"actions"},[t("small",{staticClass:"mr-2"},[e._v("Actions:")]),t("v-btn",{attrs:{"x-small":"",outlined:""},on:{click:function(t){return e.toggleMultipleStars()}}},[t("v-icon",{attrs:{left:"",color:"amber"}},[e._v("mdi-star")]),e._v("\n                Toggle star\n              ")],1),t("v-menu",{attrs:{"offset-x":"","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-btn",e._g(e._b({attrs:{"x-small":"",outlined:""}},"v-btn",s,!1),i),[t("v-icon",{attrs:{left:""}},[e._v("mdi-tag-plus-outline")]),e._v("\n                    Modify Tags\n                  ")],1)]}}],null,!0),model:{value:e.showEventTagMenu,callback:function(t){e.showEventTagMenu=t},expression:"showEventTagMenu"}},[t("ts-event-tag-dialog",{attrs:{events:e.selectedEvents},on:{close:function(t){e.showEventTagMenu=!1}}})],1),t("v-btn",{attrs:{"x-small":"",outlined:"",color:"error"},on:{click:e.deleteSelectedEvents}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-trash-can-outline")]),e._v("\n                Delete Selected\n              ")],1),t("v-btn",{attrs:{"x-small":"",outlined:"",color:"orange"},on:{click:function(t){return e.DEBUG_hideSelectedEvents()}}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-eye-off")]),e._v("\n                [DEBUG] Hide Selected\n              ")],1),e.DEBUG_hiddenEventIds.size>0?t("v-btn",{attrs:{"x-small":"",outlined:"",color:"warning"},on:{click:function(t){return e.DEBUG_resetHiddenEvents()}}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-refresh")]),e._v("\n                [DEBUG] Unhide All ("+e._s(e.DEBUG_hiddenEventIds.size)+" hidden)\n              ")],1):e._e()],1):t("div",[t("span",{staticStyle:{display:"inline-block","min-width":"200px"}},[t("small",[e._v(e._s(e.fromEvent)+"-"+e._s(e.toEvent)+" of "+e._s(e.totalHits)+" events ("+e._s(e.totalTime)+"s)")])]),[e.disableSaveSearch?e._e():t("v-btn",{attrs:{icon:""},on:{click:function(t){e.saveSearchMenu=!0}}},[t("v-icon",{attrs:{title:"Save current search"}},[e._v("mdi-content-save-outline")])],1)],[e.disableHistogram?e._e():t("v-btn",{attrs:{icon:""},on:{click:function(t){e.showHistogram=!e.showHistogram}}},[t("v-icon",{attrs:{title:"Toggle event histogram"}},[e._v("mdi-chart-bar")])],1)],e.disableColumns?e._e():t("v-dialog",{attrs:{"max-width":"500px",scrollable:""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",s,!1),i),[t("v-icon",{attrs:{title:"Modify columns"}},[e._v("mdi-view-column-outline")])],1)]}}],null,!0),model:{value:e.columnDialog,callback:function(t){e.columnDialog=t},expression:"columnDialog"}},[t("v-card",{attrs:{height:"50vh"}},[t("v-card-title",[e._v("Select columns")]),t("v-card-text",[t("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.searchColumns,callback:function(t){e.searchColumns=t},expression:"searchColumns"}}),t("br"),t("v-data-table",{attrs:{headers:e.columnHeaders,items:e.meta.mappings,search:e.searchColumns,"hide-default-footer":!0,"item-key":"field","disable-pagination":"","show-select":"",dense:""},on:{input:e.updateSelectedFields},model:{value:e.selectedFields,callback:function(t){e.selectedFields=t},expression:"selectedFields"}})],1),t("v-divider"),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:function(t){e.selectedFields=[{field:"message",type:"text"}]}}},[e._v(" Reset ")]),t("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.columnDialog=!1}}},[e._v(" Set columns ")])],1)],1)],1),t("v-btn",{attrs:{icon:""},on:{click:function(t){return e.exportSearchResult()}}},[t("v-icon",{attrs:{title:"Download current view as CSV"}},[e._v("mdi-download")])],1),e.disableSettings?e._e():t("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",s,!1),i),[t("v-icon",{attrs:{title:"View settings"}},[e._v("mdi-dots-horizontal")])],1)]}}],null,!0)},[t("v-card",{staticClass:"mx-auto",attrs:{outlined:"","max-width":"475"}},[t("v-list",{attrs:{subheader:"","two-line":"",flat:"",dense:""}},[t("v-subheader",[e._v("Density")]),t("v-list-item-group",[t("v-list-item",{attrs:{ripple:!1}},[[t("v-list-item-action",[t("v-radio-group",{model:{value:e.displayOptions.isCompact,callback:function(t){e.$set(e.displayOptions,"isCompact",t)},expression:"displayOptions.isCompact"}},[t("v-radio",{attrs:{value:!1}})],1)],1),t("v-list-item-content",[t("v-list-item-title",[e._v("Comfortable")]),t("v-list-item-subtitle",[e._v("More space between rows")])],1)]],2),t("v-list-item",{attrs:{ripple:!1}},[[t("v-list-item-action",[t("v-radio-group",{model:{value:e.displayOptions.isCompact,callback:function(t){e.$set(e.displayOptions,"isCompact",t)},expression:"displayOptions.isCompact"}},[t("v-radio",{attrs:{value:!0}})],1)],1),t("v-list-item-content",[t("v-list-item-title",[e._v("Compact")]),t("v-list-item-subtitle",[e._v("Less space between rows")])],1)]],2)],1),t("v-divider"),t("v-list",{attrs:{subheader:"","two-line":"",flat:""}},[t("v-subheader",[e._v("Misc")]),t("v-list-item-group",[t("v-list-item",{attrs:{ripple:!1}},[t("v-list-item-action",[t("v-switch",{attrs:{dense:"",color:""},model:{value:e.displayOptions.showTags,callback:function(t){e.$set(e.displayOptions,"showTags",t)},expression:"displayOptions.showTags"}})],1),t("v-list-item-content",[t("v-list-item-title",[e._v("Tags")]),t("v-list-item-subtitle",[e._v("Show tags")])],1)],1)],1),t("v-list-item-group",[t("v-list-item",{attrs:{ripple:!1}},[t("v-list-item-action",[t("v-switch",{attrs:{dense:""},model:{value:e.displayOptions.showEmojis,callback:function(t){e.$set(e.displayOptions,"showEmojis",t)},expression:"displayOptions.showEmojis"}})],1),t("v-list-item-content",[t("v-list-item-title",[e._v("Emojis")]),t("v-list-item-subtitle",[e._v("Show emojis")])],1)],1)],1),t("v-list-item-group",[t("v-list-item",{attrs:{ripple:!1}},[t("v-list-item-action",[t("v-switch",{attrs:{dense:""},model:{value:e.displayOptions.showTimelineName,callback:function(t){e.$set(e.displayOptions,"showTimelineName",t)},expression:"displayOptions.showTimelineName"}})],1),t("v-list-item-content",[t("v-list-item-title",[e._v("Timeline name")]),t("v-list-item-subtitle",[e._v("Show timeline name")])],1)],1)],1)],1)],1)],1)],1)],2),t("v-spacer"),e.totalHits>11&&!e.disablePagination?t("v-data-footer",{staticClass:"mr-n3",staticStyle:{border:"0"},attrs:{pagination:i,options:s,"show-current-page":!0,"items-per-page-options":[10,40,80,100,200,500],"items-per-page-text":"Rows per page:"},on:{"update:options":a}}):e._e()],1),e.showHistogram?t("v-card",{staticClass:"my-3",attrs:{outlined:""}},[t("v-toolbar",{attrs:{dense:"",flat:"",color:"transparent"}},[t("v-spacer"),e.timeFilterChips.length?t("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.removeChips(e.timeFilterChips)}}},[e._v("\n                reset\n              ")]):e._e(),t("v-btn",{attrs:{icon:""},on:{click:function(t){e.showHistogram=!1}}},[t("v-icon",{attrs:{title:"Close histogram"}},[e._v("mdi-close")])],1)],1),t("ts-bar-chart",{attrs:{"chart-data":e.eventList.meta.count_over_time},on:{addChip:function(t){return e.addChipFromHistogram(t)}}})],1):e._e()]}},{key:"expanded-item",fn:function({headers:i,item:s}){return[t("td",{attrs:{colspan:i.length}},[s.showDetails?t("v-container",{staticClass:"mt-4",attrs:{fluid:""}},[t("ts-event-detail",{attrs:{event:s}})],1):e._e(),s.showDetails&&s.deltaDays?t("v-divider"):e._e(),s.deltaDays>0?t("div",{staticClass:"ml-7"},[t("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color",style:e.getTimeBubbleColor(s)}),t("div",{staticClass:"ts-time-bubble ts-time-bubble-color",style:e.getTimeBubbleColor(s)},[t("div",{staticClass:"ts-time-bubble-text"},[t("b",[e._v(e._s(e._f("compactNumber")(s.deltaDays)))]),e._v(" days\n                ")])]),t("div",{staticClass:"ts-time-bubble-vertical-line ts-time-bubble-vertical-line-color",style:e.getTimeBubbleColor(s)})]):e._e()],1)]}},{key:"item.actions",fn:function({item:i}){return[t("v-btn",{attrs:{small:"",icon:""},on:{click:function(t){return e.toggleStar(i)}}},[i._source.labels&&i._source.labels.includes("__ts_star")?t("v-icon",{attrs:{title:"Toggle star status",color:"amber"}},[e._v("mdi-star")]):t("v-icon",{attrs:{title:"Toggle star status"}},[e._v("mdi-star-outline")])],1),t("ts-event-tag-menu",{attrs:{event:i}}),t("ts-event-action-menu",{attrs:{event:i},on:{showContextWindow:function(t){return e.showContextWindow(t)}}})]}},{key:"item._source.primary_timestamp",fn:function({item:i}){return[t("div",{staticClass:"datetime-table-cell"},[null!==i._source.primary_timestamp&&""!==i._source.primary_timestamp?t("span",[e._v("\n                "+e._s(e.$options.filters.shortDateTimeLocal(i._source.primary_timestamp))+"\n            ")]):t("span",{staticStyle:{"font-style":"italic"}},[e._v("undated")])])]}},e._l(e.headers,(function(i,s){return{key:e.getFieldName(i.text),fn:function({item:a}){return[t("div",{key:i.text,staticClass:"ts-event-field-container",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.toggleDetailedEvent(a)}}},[t("span",{class:{"ts-event-field-highlight":a._id===e.highlightEventId}},[e.displayOptions.showTags&&("message"===i.text||4===s&&"_source.comment"===e.headers[3].value)&&a._source.tags&&a._source.tags.length>0?t("span",[t("ts-event-tags",{attrs:{item:a,tagConfig:e.tagConfig,showDetails:a.showDetails}})],1):e._e(),e.displayOptions.showEmojis&&("message"===i.text||4===s&&"_source.comment"===e.headers[3].value)&&a._source.__ts_emojis?t("span",e._l(a._source.__ts_emojis,(function(i){return t("span",{key:i,staticClass:"mr-2",attrs:{title:e.meta.emojis&&e.meta.emojis[i]},domProps:{innerHTML:e._s(i+";")}})})),0):e._e(),t("span",[e._v(e._s(a._source[i.text]))])])])]}}})),{key:"item.timeline_name",fn:function({item:i}){return[t("v-chip",{staticStyle:{"margin-top":"1px","margin-bottom":"1px","font-size":"0.8em"},style:e.getTimelineColor(i),attrs:{label:""}},[t("span",{staticClass:"timeline-name-ellipsis",staticStyle:{width:"130px","text-align":"center"}},[e._v(e._s(e.getTimeline(i).name))])])]}},{key:"item._source.comment",fn:function({item:i}){return[t("div",{staticClass:"d-inline-block"},[i._source.comment&&i._source.comment.length?t("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.toggleDetailedEvent(i)}}},[t("v-badge",{attrs:{"offset-y":10,"offset-x":10,bordered:"",content:i._source.comment.length}},[t("v-icon",{attrs:{title:i["showDetails"]?"Close event & comments":"Open event & comments",small:""}},[e._v("\n                  mdi-comment-text-multiple-outline\n                ")])],1)],1):e._e()],1),!i["showDetails"]||i._source.comment&&i._source.comment.length||i.showComments?e._e():t("div",{staticClass:"d-inline-block"},[t("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.newComment(i)}}},[t("v-icon",{attrs:{title:"Add a comment"}},[e._v(" mdi-comment-plus-outline ")])],1)],1),!i["showDetails"]||i._source.comment&&i._source.comment.length||!i.showComments?e._e():t("div",{staticClass:"d-inline-block"},[t("v-btn",{attrs:{icon:"",small:""},on:{click:function(e){i.showComments=!1}}},[t("v-icon",{attrs:{title:"Close comments"}},[e._v(" mdi-comment-remove-outline ")])],1)],1)]}}],null,!0),model:{value:e.selectedEvents,callback:function(t){e.selectedEvents=t},expression:"selectedEvents"}})],1):e._e()],1)},Mi=[],Ni=function(){var e=this,t=e._self._c;return t("div",[t("apexchart",{attrs:{height:"250",options:e.options,series:e.series}})],1)},ji=[],Ui=i("1321"),Bi=i.n(Ui),Qi={props:["chartData"],components:{Apexchart:Bi.a},data:function(){return{options:{chart:{type:"bar",zoom:{enabled:!1,type:"x",autoScaleYaxis:!0},foreColor:"#fff",animations:{enabled:!0,easing:"easeinout",speed:50,animateGradually:{enabled:!0,delay:50},dynamicAnimation:{enabled:!0,speed:50}},colors:["#4285f"],toolbar:{show:!0,tools:{download:!1,selection:!0,zoom:!0,zoomin:!0,zoomout:!0}},events:{dataPointSelection:(e,t,i)=>{this.emitFilterRequest(i)}}},tooltip:{enabled:!0,followCursor:!1,theme:"dark",x:{formatter:e=>{let t=this.getBucketDateTimeRange(e),i=this.$moment.duration(t.start.diff(t.end));return`${t.start.format("YYYY-MM-DD HH:mm:ss")} + ${i.humanize()}`}}},plotOptions:{bar:{columnWidth:"95%",borderRadius:4}},dataLabels:{enabled:!1},grid:{xaxis:{lines:{show:!1}},yaxis:{lines:{show:!1}}},xaxis:{type:"datetime",tickPlacement:"on"}}}},computed:{series(){let e={name:"Events",data:[]};return this.chartData?(e.data=Object.entries(this.chartData.data).map(e=>[parseInt(e[0]),e[1]]),[e]):[e]}},methods:{getBucketDateTimeRange(e){let t=this.$moment.utc(e),i=this.chartData.interval.split(/(\d+)/),s=i[1],a=i[2],n=this.$moment.utc(e).add(parseInt(s),a);return{start:t,end:n}},emitFilterRequest(e){let t=e.selectedDataPoints[0][0],i=e.w.config.series[0]["data"];if(1===i.length)return;let s=i[t][0],a=this.getBucketDateTimeRange(s),n={field:"",type:"datetime_range",value:a.start.toISOString()+","+a.end.toISOString(),operator:"must",active:!0};this.$emit("addChip",n)},setTheme(){"dark"===localStorage.theme?this.options={chart:{foreColor:"#fff"},tooltip:{theme:"dark"}}:this.options={chart:{foreColor:"#333"},tooltip:{theme:"light"}}}},created(){o.$on("isDarkTheme",this.setTheme)},mounted(){this.setTheme()}},zi=Qi,qi=Object(d["a"])(zi,Ni,ji,!1,null,null,null),Hi=qi.exports,Vi=function(){var e=this,t=e._self._c;return t("div",[t("v-row",[t("v-col",{attrs:{cols:e.event.showComments?8:0}},[t("v-card",{attrs:{outlined:"",height:"100%"}},[t("v-simple-table",{attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[t("tbody",e._l(e.fullEventFiltered,(function(i,s){return t("tr",{key:s,on:{mouseover:function(t){e.c_key=s},mouseleave:function(t){e.c_key=-1}}},[s==e.c_key?t("td",{staticClass:"text-right",staticStyle:{"min-width":"105px"}},[e.ignoredAggregatorFields.has(s)?e._e():t("v-btn",{staticClass:"mr-1",attrs:{icon:"","x-small":""},on:{click:function(t){return t.stopPropagation(),e.loadAggregation(s,i)}}},[t("v-icon",{attrs:{title:"Aggregation dialog"}},[e._v("mdi-chart-bar")])],1),e.ignoreFilterChips.has(s)?e._e():t("v-btn",{staticClass:"mr-1",attrs:{icon:"","x-small":""},on:{click:function(t){return t.stopPropagation(),e.applyFilterChip(s,i,"must")}}},[t("v-icon",{attrs:{title:"Filter for value"}},[e._v("mdi-filter-plus-outline")])],1),e.ignoreFilterChips.has(s)?e._e():t("v-btn",{staticClass:"mr-1",attrs:{icon:"","x-small":""},on:{click:function(t){return t.stopPropagation(),e.applyFilterChip(s,i,"must_not")}}},[t("v-icon",{attrs:{title:"Filter out value"}},[e._v("mdi-filter-minus-outline")])],1),t("v-btn",{staticClass:"pr-1",staticStyle:{cursor:"pointer"},attrs:{icon:"","x-small":""},on:{click:function(t){return e.copyToClipboard(s)}}},[t("v-icon",{attrs:{title:"Copy attribute name",small:""}},[e._v("mdi-content-copy")])],1)],1):t("td",[t("div",{staticClass:"px-12"})]),t("td",[e._v("\n                  "+e._s(s)+"\n                ")]),e.checkContextLinkDisplay(s,i)||s==e.c_key?t("td",{staticClass:"text-right pr-1"},[t("v-btn",{directives:[{name:"show",rawName:"v-show",value:s==e.c_key,expression:"key == c_key"}],staticStyle:{cursor:"pointer"},attrs:{icon:"","x-small":""},on:{click:function(t){return e.copyToClipboard(i)}}},[t("v-icon",{attrs:{small:"",title:"Copy attribute value"}},[e._v("mdi-content-copy")])],1),e.checkContextLinkDisplay(s,i)?t("v-menu",{attrs:{"offset-y":"",transition:"slide-y-transition"},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-btn",e._g(e._b({staticStyle:{cursor:"pointer"},attrs:{icon:"",color:"primary","x-small":""}},"v-btn",s,!1),i),[t("v-icon",{attrs:{title:"Context Lookup",small:""}},[e._v(" mdi-open-in-new ")])],1)]}}],null,!0)},[t("v-list",{attrs:{dense:""}},[t("v-dialog",{attrs:{"max-width":"515","retain-focus":!1},model:{value:e.redirectWarnDialog,callback:function(t){e.redirectWarnDialog=t},expression:"redirectWarnDialog"}},[t("ts-link-redirect-warning",{attrs:{app:"","context-value":e.contextValue,"context-url":e.contextUrl},on:{cancel:function(t){e.redirectWarnDialog=!1}}})],1),t("v-dialog",{staticClass:"asdf",attrs:{"max-width":"80%","min-width":"1000px","max-height":"80%","min-height":"600px","retain-focus":!1},model:{value:e.dfirUnfurlDialog,callback:function(t){e.dfirUnfurlDialog=t},expression:"dfirUnfurlDialog"}},[t("ts-unfurl-dialog",{attrs:{url:e.contextValue},on:{cancel:function(t){e.dfirUnfurlDialog=!1}}})],1),t("v-dialog",{model:{value:e.formatXMLString,callback:function(t){e.formatXMLString=t},expression:"formatXMLString"}},[t("ts-format-xml-string",{attrs:{xmlString:i},on:{close:function(t){e.formatXMLString=!1}}})],1),e._l(e.getContextLinkItems(s),(function(a,n){return t("v-list-item",{key:n,staticStyle:{cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.contextLinkRedirect(s,a,i)}}},[e.getContextLinkRedirectState(s,a)?t("v-list-item-title",[e._v("\n                          "+e._s(a)+" (ext.)")]):t("v-list-item-title",[e._v(e._s(a))])],1)}))],2)],1):e._e()],1):t("td",[t("div",{staticClass:"px-5"})]),t("td",{staticClass:"pl-0",attrs:{width:"100%"}},[e._v("\n                  "+e._s(i)+"\n                ")])])})),0)]},proxy:!0}])})],1)],1),t("v-slide-x-reverse-transition",[t("v-col",{directives:[{name:"show",rawName:"v-show",value:e.event.showComments,expression:"event.showComments"}],attrs:{cols:"4"}},[t("ts-comments",{attrs:{comments:e.comments,event:e.event,currentSearchNode:e.currentSearchNode}})],1)],1)],1),t("v-dialog",{attrs:{scrollable:""},on:{"click:outside":e=>this.aggregatorDialog=!1},model:{value:e.aggregatorDialog,callback:function(t){e.aggregatorDialog=t},expression:"aggregatorDialog"}}),t("br")],1)},Wi=[],Gi=function(){var e=this,t=e._self._c;return t("v-card",[t("div",{staticClass:"pa-8"},[t("pre",{staticStyle:{"font-size":"0.9em"},attrs:{lang:"xml"}},[e._v(e._s(e.xmlString))])]),t("v-divider"),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.close()}}},[e._v(" Close ")])],1)],1)},Yi=[],Ji={props:["xmlString"],methods:{close:function(){this.$emit("close")}}},Ki=Ji,Xi=Object(d["a"])(Ki,Gi,Yi,!1,null,"25ba8c42",null),Zi=Xi.exports,es=function(){var e=this,t=e._self._c;return t("v-card",[t("v-card-title",[t("v-icon",{attrs:{large:"",color:"red"}},[e._v("mdi-shield-alert-outline")]),t("span",{staticClass:"text-h6 ml-2"},[e._v("External redirect warning!")])],1),t("v-card-text",[e.contextValue?t("div",{staticClass:"mb-2"},[e._v("\n      This action will open the link below in a new tab! Do you really\n      want to send the following value to this external service?\n    ")]):t("div",{staticClass:"mb-2"},[e._v("\n      This action will open the link below in a new tab! Do you really\n      want to visit this external website?\n    ")]),e.contextValue?t("div",[t("b",[e._v("Value:")]),t("br"),t("code",{staticClass:"code"},[e._v("\n        "+e._s(e.getContextValue)+"\n      ")])]):e._e(),t("div",[t("b",[e._v("External website:")]),t("br"),t("code",{staticClass:"code"},[e._v("\n        "+e._s(e.getContextUrl)+"\n      ")])])]),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"primary",text:""},on:{click:e.clearAndCancel}},[e._v("\n      cancel\n    ")]),t("v-btn",{attrs:{color:"primary",text:"",href:e.contextUrl,target:"_blank"},on:{click:e.clearAndCancel}},[e._v("\n      continue\n    ")])],1)],1)},ts=[],is=i("c0c4"),ss=i.n(is),as={props:["contextValue","contextUrl"],methods:{clearAndCancel:function(){this.$emit("cancel")}},computed:{getContextValue(){return ss.a.sanitize(this.contextValue)},getContextUrl(){return ss.a.sanitize(this.contextUrl)}}},ns=as,rs=Object(d["a"])(ns,es,ts,!1,null,"5096e762",null),os=rs.exports,ls=function(){var e=this,t=e._self._c;return t("v-card",{attrs:{outlined:""}},[t("v-toolbar",{attrs:{dense:"",flat:""}},[t("v-toolbar-title",{staticStyle:{"font-size":"1.2em"}},[e._v("Comments")])],1),t("v-list",{attrs:{"three-line":""}},e._l(e.comments,(function(i,s){return t("v-list-item",{key:i.id,on:{mouseover:function(t){return e.selectComment(i)},mouseleave:function(t){return e.unSelectComment()}}},[t("v-list-item-avatar",[t("v-avatar",{attrs:{color:"grey lighten-1"}},[t("span",{staticClass:"white--text"},[e._v(e._s(e._f("initialLetter")(i.user.username)))])])],1),t("v-list-item-content",[t("v-list-item-title",[e._v("\n          "+e._s(i.user.username)+"\n        ")]),t("v-list-item-subtitle",[e._v("\n          "+e._s(e._f("shortDateTime")(i.created_at))+" ("+e._s(e._f("timeSince")(i.created_at))+")\n        ")]),i.editable?t("v-card",{staticClass:"mt-5",attrs:{flat:""}},[t("v-textarea",{attrs:{"hide-details":"","auto-grow":"",filled:""},model:{value:e.comments[s].comment,callback:function(t){e.$set(e.comments[s],"comment",t)},expression:"comments[index].comment"}}),i.editable?t("v-card-actions",[t("v-spacer"),i.editable?t("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.editComment(s,!1)}}},[e._v(" Cancel ")]):e._e(),t("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.updateComment(i,s)}}},[e._v(" Save ")])],1):e._e()],1):t("p",{staticClass:"body-2",staticStyle:{"max-width":"90%"}},[e._v(e._s(i.comment))])],1),i===e.selectedComment&&e.currentUser==i.user.username?t("v-list-item-action",{staticStyle:{position:"absolute",right:"0"}},[t("v-chip",{staticStyle:{"margin-right":"10px"},attrs:{outlined:""}},[t("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.editComment(s)}}},[t("v-icon",{attrs:{title:"Edit comment",small:""}},[e._v("mdi-square-edit-outline")])],1),t("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.deleteComment(i.id,s)}}},[t("v-icon",{attrs:{title:"Delete comment",small:""}},[e._v("mdi-trash-can-outline")])],1)],1)],1):e._e()],1)})),1),t("v-card-actions",[t("v-textarea",{staticClass:"mx-2 mb-2",attrs:{"hide-details":"","auto-grow":"",filled:"",label:"Add comment",rows:"1"},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}}),t("v-btn",{attrs:{icon:""},on:{click:e.postComment}},[t("v-icon",{attrs:{title:"Submit comment"}},[e._v("mdi-send")])],1)],1)],1)},cs=[],ds={props:["event","currentSearchNode"],data(){return{comment:"",comments:[],selectedComment:!1}},computed:{currentUser(){return this.$store.state.currentUser},formattedComments(){return this.comments||[]}},watch:{event:{handler(e){e&&e._id&&this.fetchComments()},immediate:!0}},methods:{async fetchComments(){try{if(!this.event||!this.event._id)return;this.comments=await He.getEventComments(this.event._id)}catch(e){console.error("Failed to load comments",e)}},async postComment(){if(this.comment.trim())try{await He.addEventComment(this.event._id,this.comment),this.comment="",await this.fetchComments()}catch(e){console.error("Failed to post comment",e)}},async updateComment(e,t){try{await He.updateEventComment(e.id,e.comment),e.editable=!1,e.updated_at=(new Date).toISOString(),this.comments.splice(t,1,e)}catch(i){console.error("Error updating comment:",i)}},async deleteComment(e,t){if(confirm("Are you sure?"))try{await He.deleteEventComment(e),this.comments.splice(t,1),this.$store.dispatch("updateEventLabels",{label:"__ts_comment",num:-1})}catch(i){console.error("Error deleting comment:",i)}},editComment(e,t=!0){const i=this.comments[e];i.editable=t,this.comments.splice(e,1,i)},selectComment(e){this.selectedComment=e},unSelectComment(){this.selectedComment=!1}}},us=ds,ms=Object(d["a"])(us,ls,cs,!1,null,null,null),hs=ms.exports,ps=function(){var e=this,t=e._self._c;return t("v-card",[t("v-toolbar",{attrs:{flat:"",color:"transparent"}},[t("v-img",{staticClass:"ml-2",attrs:{position:"left",src:e.getUnfurlLogo,"max-height":"24",contain:""}})],1),t("v-card-subtitle",{staticClass:"pt-1"},[t("div",{staticClass:"mb-2"},[t("b",[e._v("Input: ")]),t("code",{staticClass:"code"},[e._v(e._s(e.url))])]),e.unfurlReady?t("div",[t("b",[e._v("Selected node info: ")]),t("code",{staticClass:"code",domProps:{innerHTML:e._s(e.sanitizeHtml(e.nodeContext))}})]):e._e()]),t("v-card-text",[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.unfurlReady,expression:"!unfurlReady"}]},[t("v-progress-linear",{attrs:{color:"primary",indeterminate:""}})],1),t("v-toolbar",{directives:[{name:"show",rawName:"v-show",value:e.unfurlReady,expression:"unfurlReady"}],staticClass:"mt-n8",attrs:{dense:"",flat:"",color:"transparent"}},[t("v-spacer"),t("div",[t("v-btn",{attrs:{icon:""},on:{click:function(t){return e.resizeCanvas()}}},[t("v-icon",{attrs:{title:"fit graph to canvas"}},[e._v("mdi-fit-to-page-outline")])],1),t("v-btn",{attrs:{icon:""},on:{click:function(t){return e.zoomGraph("plus")}}},[t("v-icon",{attrs:{title:"zoom-in"}},[e._v("mdi-plus")])],1),t("v-btn",{attrs:{icon:""},on:{click:function(t){return e.zoomGraph("minus")}}},[t("v-icon",{attrs:{title:"zoom-out"}},[e._v("mdi-minus")])],1)],1)],1),t("v-card",{directives:[{name:"show",rawName:"v-show",value:e.unfurlReady,expression:"unfurlReady"}],attrs:{outlined:""}},[t("div",{ref:"graphContainer",style:{height:e.canvasHeight,width:"100%"}},[t("div",{ref:"cy",staticClass:"pa-2",style:{"min-height":e.canvasHeight},attrs:{width:"100%"}})])]),t("small",[e._v("Powered by "),t("a",{attrs:{href:"https://github.com/obsidianforensics/unfurl",target:"_blank"}},[e._v("dfir-unfurl")])])],1),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"primary",text:""},on:{click:e.clearAndCancel}},[e._v(" close ")])],1)],1)},vs=[],fs=i("fef5"),gs=i("b17d"),_s=i.n(gs),ys=i("7c5c");function bs(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function ws(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?bs(Object(i),!0).forEach((function(t){Object(de["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):bs(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}fs["a"].use(_s.a);var Ss={props:["url"],data(){return{unfurlReady:!1,unfurlData:{},canvasHeight:"400px",nodeContext:"",nodeContextDefault:"Select a node in the graph below to get more information.",config:{style:[{selector:"node",style:{shape:"roundrectangle",width:"data(labelWidth)",height:"data(labelHeight)",label:"data(label)","font-size":"10","text-outline-width":"0px",padding:"7px","background-color":"#e0e0e0","text-outline-color":"#e0e0e0","text-wrap":"wrap","text-max-width":"12em","text-halign":"center","text-valign":"center",color:"#000000"}},{selector:"node:selected",style:{"border-color":" #000","border-width":"2px"}},{selector:"edge",style:{width:1,"curve-style":"bezier","control-point-step-size":70,"target-arrow-shape":"triangle","font-size":11,"text-rotation":"autorotate","text-outline-width":3,"text-outline-color":"#FFFFFF",label:"data(label)"}},{selector:"edge.highlight",style:{lineColor:"grey",width:3}}],layout:{name:"dagre",animated:!1,prelayout:!1,spacingFactor:1}}}},computed:{getUnfurlLogo(){return this.$vuetify.theme.dark?"/images/unfurl-logo-dark.png":"/images/unfurl-logo.png"}},methods:{sanitizeHtml(e){return ss.a.sanitize(Object(ys["marked"])(e))},clearAndCancel:function(){this.$emit("cancel")},getUnfurlData:function(e){console.log("[UnfurlDialog] Unfurl not available in browser mode"),this.$emit("cancel")},resizeCanvasWithDelay:function(){this.resizeTimeout=setTimeout(()=>{this.resizeCanvas()},250)},resizeCanvas:function(){if(!this.$refs.graphContainer)return;let e=this.$refs.graphContainer.style.height,t=this.$refs.graphContainer.style.width,i=this.$refs.cy;i.style.minHeight=e+"px",i.style.height=e+"px",i.style.minWidth=t+"px",i.style.width=t+"px",this.cy.resize(),this.cy.fit()},zoomGraph(e){const t=this.cy.zoom();"plus"===e&&this.cy.zoom({level:t+.2}),"minus"===e&&this.cy.zoom({level:t-.2})},buildUnfurlGraph:function(e={}){this.cy.elements().remove();let t=[];e.nodes.forEach(e=>{t.push({group:"nodes",data:{id:e.id,label:e.label,labelWidth:6*e.label.length,labelHeight:13,context:e.title}})}),e.edges.forEach(e=>{t.push({group:"edges",data:{id:`e${e.from}${e.to}`,source:e.from,target:e.to,label:e.label,context:e.title}})}),this.cy.style(this.config.style),this.cy.add(t),this.cy.layout(this.config.layout).run(),this.resizeCanvasWithDelay()},nodeSelection:function(e){this.cy.edges().removeClass("highlight"),e.target.outgoers("edge").addClass("highlight"),this.nodeContext=e.target.data().context?e.target.data().context:"No context available for this node.",this.resizeCanvas()}},mounted(){window.addEventListener("resize",this.resizeCanvasWithDelay),this.unfurlReady=!1,this.nodeContext=this.nodeContextDefault,this.getUnfurlData(this.url),this.cy=Object(fs["a"])(ws({container:this.$refs.cy},this.config)),this.cy.on("select","node",e=>{this.nodeSelection(e)}),this.cy.on("unselect","node",e=>{this.cy.elements().removeClass("highlight"),this.nodeContext=this.nodeContextDefault})}},xs=Ss,Cs=(i("682d"),Object(d["a"])(xs,ps,vs,!1,null,"7f071d42",null)),ks=Cs.exports,Ts={components:{TsFormatXmlString:Zi,TsLinkRedirectWarning:os,TsComments:hs,TsUnfurlDialog:ks},props:["event"],data(){return{aggregatorDialog:!1,ignoredAggregatorFields:new Set(["datetime","message","path_spec","strings","timestamp","xml_string"]),ignoreFilterChips:new Set(["datetime","tags"]),eventKey:"",eventValue:"",eventTimestamp:0,eventTimestampDesc:"",formatXMLString:!1,redirectWarnDialog:!1,dfirUnfurlDialog:!1,contextUrl:"",contextValue:"",c_key:-1}},computed:{sketch(){return this.$store.state.sketch},meta(){return this.$store.state.meta},currentUser(){return this.$store.state.currentUser},currentSearchNode(){return this.$store.state.currentSearchNode},fullEventFiltered(){const e=this.event._source||{},t=["label","__ts_star","__ts_comment","_index","_id","_type","tag"];return Object.keys(e).filter(e=>!t.includes(e)&&!e.startsWith("__ts")).reduce((t,i)=>(t[i]=e[i],t),{})},contextLinkConf(){return this.$store.state.contextLinkConf},settings(){return this.$store.state.settings},comments(){const e=this.event._source||{};return e.comment||[]}},methods:{getEvent:function(){const e=this.event._source||{};this.eventTimestamp=e.timestamp||e.primary_timestamp,this.eventTimestampDesc=e.timestamp_desc||"Datetime",e.comment&&e.comment.length>0&&(this.event.showComments=!0)},getContextLinkItems(e){if(!this.contextLinkConf)return[];let t=this.contextLinkConf[e.toLowerCase()]?this.contextLinkConf[e.toLowerCase()]:[],i=t.map(e=>e.short_name);return i},checkContextLinkDisplay(e,t){if(!this.contextLinkConf)return!1;const i=this.contextLinkConf[e.toLowerCase()]?this.contextLinkConf[e.toLowerCase()]:[];for(const s of i){if(""!==s["validation_regex"]&&void 0!==s["validation_regex"]){let e=s["validation_regex"],i=e.slice(e.lastIndexOf("/")+1),a=e.slice(e.indexOf("/")+1,e.lastIndexOf("/")),n=new RegExp(a,i);return!!n.test(t)}return!0}return!1},contextLinkRedirect(e,t,i){if(!this.contextLinkConf)return;const s=this.contextLinkConf[e.toLowerCase()]?this.contextLinkConf[e.toLowerCase()]:[];for(const a of s)if(a["short_name"]===t)if("hardcoded_modules"===a["type"]){if("xml_formatter"===a["module"])return this.formatXMLString=!0,void(this.contextValue=i);if("unfurl_graph"===a["module"])return this.dfirUnfurlDialog=!0,void(this.contextValue=i);if("threat_intel"===a["module"])return void o.$emit("addIndicator",i)}else a["redirect_warning"]?(this.redirectWarnDialog=!0,this.contextValue=i,this.contextUrl=a["context_link"].replace("<ATTR_VALUE>",encodeURIComponent(i))):(window.open(a["context_link"].replace("<ATTR_VALUE>",encodeURIComponent(i)),"_blank"),this.redirectWarnDialog=!1)},getContextLinkType(e,t){const i=this.contextLinkConf[e.toLowerCase()]?this.contextLinkConf[e.toLowerCase()]:[];for(const s of i)if(s["short_name"]===t)return s["type"]},getContextLinkRedirectState(e,t){const i=this.contextLinkConf[e.toLowerCase()]?this.contextLinkConf[e.toLowerCase()]:[];for(const s of i)if(s["short_name"]===t)return!!s["redirect_warning"]&&s["redirect_warning"]},loadAggregation(e,t){this.eventKey=e,this.eventValue=t,this.aggregatorDialog=!0},copyToClipboard(e){try{navigator.clipboard.writeText(e),this.infoSnackBar("copied")}catch(t){this.errorSnackBar("Failed copying to the clipboard!"),console.error(t)}},applyFilterChip(e,t,i){let s={doSearch:!0},a={field:e,value:t,type:"term",operator:i,active:!0};s.chip=a,o.$emit("setQueryAndFilter",s)}},created:function(){this.getEvent()}},Es=Ts,Ds=(i("f874"),Object(d["a"])(Es,Vi,Wi,!1,null,null,null)),Os=Ds.exports,Ps=function(){var e=this,t=e._self._c;return t("v-menu",{attrs:{"offset-x":"","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[e.assignedTags.length>0?t("v-icon",e._g(e._b({staticClass:"ml-1",attrs:{title:"Modify tags"}},"v-icon",s,!1),i),[e._v("mdi-tag-plus")]):t("v-icon",e._g(e._b({staticClass:"ml-1",attrs:{title:"Modify tags"}},"v-icon",s,!1),i),[e._v("mdi-tag-plus-outline")])]}}]),model:{value:e.showMenu,callback:function(t){e.showMenu=t},expression:"showMenu"}},[t("ts-event-tag-dialog",{attrs:{events:[e.event]},on:{close:function(t){e.showMenu=!1}}})],1)},Fs=[],Ls=function(){var e=this,t=e._self._c;return t("v-card",{staticClass:"mx-auto",attrs:{"min-width":"500px","max-width":"500px","min-height":"260px"}},[t("v-btn",{staticClass:"float-right mr-1 mt-1",attrs:{icon:""},on:{click:function(t){return e.$emit("close")}}},[t("v-icon",{attrs:{title:"Close dialog"}},[e._v("mdi-close")])],1),t("v-card-text",[t("strong",[e._v("Quick tags")]),t("v-chip-group",e._l(e.quickTags,(function(i){return t("v-chip",{key:i.tag,staticClass:"text-center",attrs:{color:i.color,"text-color":i.textColor,disabled:!!e.tagsAssignedToAll.includes(i.tag),small:"",title:"Add quick tag"},on:{click:[function(t){return e.addTags(i.tag)},function(t){return t.stopPropagation(),e.$emit("close")}]}},[t("v-icon",{attrs:{small:"",left:""}},[e._v(" "+e._s(i.label)+" ")]),e._v("\n        "+e._s(i.tag)+"\n      ")],1)})),1),t("strong",[e._v("Assigned tags")]),t("v-chip-group",{attrs:{column:""}},e._l(e.assignedTags,(function(i){return t("v-chip",{key:i,staticClass:"text-center",attrs:{color:e.getQuickTag(i)?e.getQuickTag(i).color:"","text-color":e.getQuickTag(i)?e.getQuickTag(i).textColor:"",small:"",close:"",title:"Remove "},on:{"click:close":function(t){return e.removeTags(i)}}},[e.getQuickTag(i)?t("v-icon",{attrs:{small:"",left:""}},[e._v(e._s(e.getQuickTag(i).label))]):e._e(),e._v("\n        "+e._s(i)+"\n      ")],1)})),1),t("br"),t("v-combobox",{attrs:{"hide-no-data":!e.search,items:e.customTags,"search-input":e.search,"hide-selected":"",label:"Add tags ...","small-chips":"",outlined:""},on:{"update:searchInput":function(t){e.search=t},"update:search-input":function(t){e.search=t},change:function(t){return e.addTags(e.selectedTags)}},scopedSlots:e._u([{key:"no-data",fn:function(){return[t("v-list-item",[t("span",{staticClass:"subheading"},[e._v("Create new tag: ")]),t("v-chip",{staticClass:"ml-1",attrs:{small:""}},[e._v("\n            "+e._s(e.search)+"\n          ")])],1)]},proxy:!0},{key:"item",fn:function({item:i}){return[t("v-chip",{attrs:{small:""}},[e._v("\n          "+e._s(i)+"\n        ")])]}}]),model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}})],1)],1)},As=[],$s={props:["events"],data(){return{listItems:[],selectedTags:null,quickTags:[{tag:"bad",color:"red",textColor:"white",label:"mdi-alert-circle-outline"},{tag:"suspicious",color:"orange",textColor:"white",label:"mdi-help-circle-outline"},{tag:"good",color:"green",textColor:"white",label:"mdi-check-circle-outline"}],search:null}},computed:{sketch(){return this.$store.state.sketch},tags(){return this.$store.state.tags.map(e=>e.tag)},event(){return this.events[0]},assignedTags(){let e=new Set;for(const t of this.events)t._source.tags&&Array.isArray(t._source.tags)&&t._source.tags.forEach(t=>e.add(t));return[...e]},tagsAssignedToAll(){return this.quickTags.filter(e=>this.events.every(t=>{const i=t._source.tags||[];return i.includes(e.tag)})).map(e=>e.tag)},customTags(){if(!this.events.every(e=>!e._source.tags))return[];let e=this.tags.filter(e=>!this.getQuickTag(e));return e=e.filter(e=>!this.assignedTags.includes(e)),e.sort((e,t)=>e.localeCompare(t)),e}},methods:{getQuickTag(e){return this.quickTags.find(t=>t.tag===e)},async removeTags(e){for(const t of this.events)if(t._source&&t._source.tags){const i=t._source.tags.filter(t=>t!==e);i.length!==t._source.tags.length&&(await He.updateEventTags(t._id,i),t._source.tags=i)}this.$store.dispatch("updateEventLabels",{label:e,num:-1})},async addTags(e){if(!e)return;const t=Array.isArray(e)?e:[e];for(const s of this.events){const e=s._source||{},a=e.tags||[],n=[...new Set([...a,...t])];try{await He.updateEventTags(s._id,n),s._source||(s._source={}),s._source.tags=n}catch(i){console.error(i)}}this.$emit("close"),this.$store.dispatch("updateEventLabels",{label:t[0],num:1}),this.$nextTick(()=>{this.selectedTags=null,this.search=null})}}},Is=$s,Rs=Object(d["a"])(Is,Ls,As,!1,null,"8e5a69e4",null),Ms=Rs.exports,Ns={components:{TsEventTagDialog:Ms},props:["event"],data(){return{showMenu:!1,selectedTags:null,quickTags:[{tag:"bad",color:"red",textColor:"white",label:"mdi-alert-circle-outline"},{tag:"suspicious",color:"orange",textColor:"white",label:"mdi-help-circle-outline"},{tag:"good",color:"green",textColor:"white",label:"mdi-check-circle-outline"}],search:null}},computed:{assignedTags(){return this.event._source.tags?this.event._source.tags:[]}}},js=Ns,Us=Object(d["a"])(js,Ps,Fs,!1,null,"ac354c62",null),Bs=Us.exports,Qs=function(){var e=this,t=e._self._c;return t("span",[t("v-menu",{attrs:{"offset-y":"",transition:"slide-y-transition"},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-icon",e._g(e._b({staticClass:"ml-1",attrs:{title:"Event Action Menu"}},"v-icon",s,!1),i),[e._v("mdi-dots-vertical")])]}}]),model:{value:e.showMenu,callback:function(t){e.showMenu=t},expression:"showMenu"}},[t("v-list",{staticClass:"mx-auto",attrs:{dense:""}},[t("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.copyEventUrlToClipboard()}}},[t("v-list-item-icon",[t("v-icon",{attrs:{small:""}},[e._v("mdi-link-variant")])],1),t("v-list-item-title",[e._v("Copy link to event")])],1),t("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.copyEventAsJSON()}}},[t("v-list-item-icon",[t("v-icon",{attrs:{small:""}},[e._v("mdi-code-json")])],1),t("v-list-item-title",[e._v("Copy event data as JSON")])],1)],1)],1)],1)},zs=[],qs={props:["event"],data(){return{showMenu:!1,originalContext:!1}},computed:{sketch(){return this.$store.state.sketch},settings(){return this.$store.state.settings}},methods:{showContextWindow(){o.$emit("showContextWindow",this.event)},copyEventAsJSON(){try{const e={_id:this.event._id,_source:this.event._source},t=JSON.stringify(e,null,3);navigator.clipboard.writeText(t),this.infoSnackBar("Event JSON copied to clipboard")}catch(e){this.errorSnackBar("Failed to copy JSON to clipboard"),console.error(e)}},copyEventUrlToClipboard(){try{let e=window.location.origin+this.$route.path+"?q=_id:"+this.event._id;navigator.clipboard.writeText(e),this.infoSnackBar("Event URL copied to clipboard")}catch(e){this.errorSnackBar("Failed to load Event URL into the clipboard"),console.error(e)}}}},Hs=qs,Vs=Object(d["a"])(Hs,Qs,zs,!1,null,"aef8b3a8",null),Ws=Vs.exports,Gs=function(){var e=this,t=e._self._c;return t("span",[e._l(e.sortedTags,(function(i){return t("span",{key:i},[t("v-chip",{staticClass:"mr-1",attrs:{small:"",color:e.tagColor(i).color,"text-color":e.tagColor(i).textColor}},[i in e.tagConfig?t("v-icon",{attrs:{left:"",small:""}},[e._v(e._s(e.tagConfig[i].label))]):e._e(),e._v("\n      "+e._s(i)+"\n    ")],1)],1)})),e._l(e.item._source.labels,(function(i){return t("span",{key:i},[i.startsWith("__ts")?e._e():t("v-chip",{staticClass:"mr-2",attrs:{small:"",outlined:""}},[e._v("\n      "+e._s(i)+"\n    ")])],1)}))],2)},Ys=[],Js={props:["item","tagConfig","showDetails"],computed:{sketch(){return this.$store.state.sketch},sortedTags(){if(!this.item._source.tags)return[];let e=this.item._source.tags;return e.sort((e,t)=>"bad"===e?-1:"bad"===t?1:"suspicious"===e?-1:"suspicious"===t?1:"good"===e?-1:"good"===t?1:e.localeCompare(t)),e}},methods:{tagColor:function(e){return this.tagConfig[e]?this.tagConfig[e]:"lightgrey"}}},Ks=Js,Xs=Object(d["a"])(Ks,Gs,Ys,!1,null,null,null),Zs=Xs.exports,ea=function(){var e=this,t=e._self._c;return t("ts-search-guide-card",{attrs:{flat:e.inDialog,"show-tags":e.showTags,"show-data-types":e.showDataTypes,"show-saved-searches":e.showSavedSearches},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"pa-4 pb-0"},[t("v-card-title",[t("v-icon",{attrs:{large:"",left:""}},[e._v("mdi-file-search-outline")]),e._v("\n        Start Exploring\n        "),t("v-spacer"),e.inDialog?t("v-btn",{attrs:{icon:"",title:"Close dialog"},on:{click:function(t){return e.$emit("close-dialog")}}},[t("v-icon",[e._v("mdi-close")])],1):e._e()],1),t("v-card-subtitle",{staticClass:"mt-1"},[e._v(" Find below some examples on how to explore your data. ")]),t("v-divider")],1)]},proxy:!0}])})},ta=[],ia=function(){var e=this,t=e._self._c;return t("v-card",{class:{"ma-4":!e.flat},attrs:{outlined:!e.flat}},[e._t("header"),t("v-card-text",[t("v-row",{attrs:{"no-gutters":""}},[t("v-col",{staticStyle:{"min-width":"250px","flex-basis":"25%"}},[t("div",{staticClass:"pa-2"},[t("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[t("thead",[t("tr",[t("th",{staticClass:"text-left"},[e._v("Description")]),t("th",{staticClass:"text-left"},[e._v("Example Query")])])]),t("tbody",[t("tr",[t("td",[e._v("Search for all events")]),t("td",[t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.emitSetQueryAndFilter("*")}}},[t("code",[e._v("*")])])])]),t("tr",[t("td",[e._v("Search a word in the message field")]),t("td",[t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.emitSetQueryAndFilter("message:error")}}},[t("code",[e._v('message:"error"')])])])]),t("tr",[t("td",[e._v("Search filenames ending with "),t("code",[e._v(".exe")])]),t("td",[t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.emitSetQueryAndFilter("filename:*.exe")}}},[t("code",[e._v("filename:*.exe")])])])]),t("tr",[t("td",[e._v("\n                    Search on the\n                    "),t("a",{attrs:{href:"https://docs.opensearch.org/docs/2.19/field-types/supported-field-types/keyword/"}},[e._v("keyword field type")]),t("br"),e._v("(exact matches & substring search)\n                  ")]),t("td",[t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.emitSetQueryAndFilter("filename.keyword:malicious.exe")}}},[t("code",[e._v("filename.keyword:malicious.exe")])]),t("br"),t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.emitSetQueryAndFilter("message.keyword:*System32*")}}},[t("code",[e._v("message.keyword:*System32*")])])])]),t("tr",[t("td",[e._v("Search using regex (between "),t("code",[e._v("//")]),e._v(")")]),t("td",[t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.emitSetQueryAndFilter("url.keyword:/.*\\/sketch\\/[1-100]\\/.*/")}}},[t("code",[e._v("url.keyword:/.*\\/sketch\\/[1-100]\\/.*/")])])])]),t("tr",[t("td",[e._v("Combine searches with AND, OR, NOT")]),t("td",[t("a",{attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.emitSetQueryAndFilter("event_identifier:(4624 OR 4625) AND LogonType:3")}}},[t("code",[e._v("event_identifier:(4624 OR 4625) AND NOT LogonType:3")])])])]),t("tr",[t("td",[e._v("Search events that have an url field")]),t("td",[t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.emitSetQueryAndFilter("_exists_:url")}}},[t("code",[e._v("_exists_:url")])]),t("br"),t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.emitSetQueryAndFilter("url:*")}}},[t("code",[e._v("url:*")])])])]),t("tr",[t("td",[e._v("Search for a range of numbers")]),t("td",[t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.emitSetQueryAndFilter("http_status_code:[200 TO 204] AND bytes_transferred:>10000")}}},[t("code",[e._v("status_code:[200 TO 204] AND transferred:>10000")])])])]),t("tr",[t("td",[e._v("Filter by a specific date/time range (UTC)")]),t("td",[t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.emitSetQueryAndFilter(`datetime:[${e.firstOfCurrentMonth} TO ${e.nowDateTimeUTC}]`)}}},[t("code",[e._v("datetime:["+e._s(e.firstOfCurrentMonth)+" TO "+e._s(e.nowDateTimeUTC)+"]")])])])]),t("tr",[t("td",[e._v("Filter for events before or after a date (UTC)")]),t("td",[t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.emitSetQueryAndFilter(`datetime:[${e.firstOfCurrentMonth} TO *]`)}}},[t("code",[e._v("datetime:["+e._s(e.firstOfCurrentMonth)+" TO *]")])]),t("br"),t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.emitSetQueryAndFilter(`datetime:[* TO ${e.firstOfCurrentMonth}]`)}}},[t("code",[e._v("datetime:[* TO "+e._s(e.firstOfCurrentMonth)+"]")])])])])])]},proxy:!0}])})],1)]),e.showTags?t("v-col",{staticStyle:{"border-left":"1px solid rgba(0, 0, 0, 0.12)"}},[t("div",{staticClass:"pa-4"},[t("h5",[t("v-icon",{attrs:{left:""}},[e._v("mdi-tag-multiple-outline")]),e._v(" Tags")],1),t("ts-tags-list")],1)]):e._e(),e.showDataTypes?t("v-col",{staticStyle:{"border-left":"1px solid rgba(0, 0, 0, 0.12)"}},[t("div",{staticClass:"pa-4"},[t("h5",[t("v-icon",{attrs:{left:""}},[e._v("mdi-database-outline")]),e._v(" Data Types")],1),t("ts-data-types-list")],1)]):e._e(),e.showSavedSearches?t("v-col",{staticStyle:{"border-left":"1px solid rgba(0, 0, 0, 0.12)"}},[t("div",{staticClass:"pa-4"},[t("h5",[t("v-icon",{attrs:{left:""}},[e._v("mdi-content-save-outline")]),e._v(" Saved Searches")],1),t("ts-saved-searches-list")],1)]):e._e()],1)],1),t("v-divider"),t("v-card-actions",[t("v-btn",{attrs:{text:"",color:"primary",href:"https://timesketch.org/guides/user/search-query-guide/",target:"_blank"}},[e._v("\n      Full Search Guide\n      "),t("v-icon",{attrs:{right:""}},[e._v("mdi-open-in-new")])],1)],1)],2)},sa=[],aa=function(){var e=this,t=e._self._c;return t("div",[t("v-data-iterator",{attrs:{items:e.eventActions,"items-per-page":e.itemsPerPage,search:e.search,"hide-default-footer":e.eventActions.length<=e.itemsPerPage},on:{"update:itemsPerPage":function(t){e.itemsPerPage=t},"update:items-per-page":function(t){e.itemsPerPage=t}},scopedSlots:e._u([e.eventActions.length>e.itemsPerPage?{key:"header",fn:function(){return[t("v-toolbar",{attrs:{flat:""}},[t("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for a category.."},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)]},proxy:!0}:null,{key:"default",fn:function(i){return e._l(i.items,(function(i){return t("div",{key:i.action,staticStyle:{cursor:"pointer","font-size":"0.9em"},on:{click:function(t){return e.setQueryAndFilter(i.action)}}},[t("v-row",{staticClass:"pa-2 pl-5",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[t("span",[e._v(e._s(i.action)+" ("),t("small",[t("strong",[e._v(e._s(e._f("compactNumber")(i.count)))])]),e._v(")")])])],1)}))}}],null,!0)})],1)},na=[],ra={props:[],data:function(){return{itemsPerPage:10,search:""}},computed:{eventActions(){return[...this.$parent.eventActions||[]].sort((e,t)=>e.action.localeCompare(t.action))}},methods:{setQueryAndFilter(e){let t={doSearch:!0};t.queryString='event_action:"'+e+'"',o.$emit("setQueryAndFilter",t)}}},oa=ra,la=(i("95ee"),Object(d["a"])(oa,aa,na,!1,null,"47f4c901",null)),ca=la.exports,da=function(){var e=this,t=e._self._c;return t("div",e._l(e.meta.views,(function(i,s){return t("div",{key:s,staticStyle:{"font-size":"0.9em"},on:{mouseover:function(t){e.c_key=s},mouseleave:function(t){e.c_key=-1}}},[t("v-row",{staticClass:"py-1 pl-5 pr-3",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",attrs:{"no-gutters":""}},[t("v-col",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.setView(i)}}},[t("div",{staticClass:"mt-1"},[e._v(e._s(i.name))])]),t("v-col",{attrs:{cols:"auto"}},[t("v-btn",{staticStyle:{cursor:"pointer"},attrs:{icon:"","x-small":""},on:{click:function(t){return e.copySavedSearchUrlToClipboard(i.id)}}},[t("v-icon",{directives:[{name:"show",rawName:"v-show",value:s==e.c_key,expression:"key == c_key"}],attrs:{title:"Copy link to this search",small:""}},[e._v("mdi-link-variant")])],1),t("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-btn",e._g(e._b({staticClass:"mr-1",attrs:{small:"",icon:""}},"v-btn",s,!1),i),[t("v-icon",{attrs:{title:"More actions",small:""}},[e._v("mdi-dots-vertical")])],1)]}}],null,!0)},[t("v-list",{staticClass:"mx-auto",attrs:{dense:""}},[t("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.copySavedSearchIdToClipboard(i.id)}}},[t("v-list-item-icon",[t("v-icon",{attrs:{small:""}},[e._v("mdi-identifier")])],1),t("v-list-item-title",[e._v("Copy saved search ID")])],1),t("v-list-item",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.copySavedSearchUrlToClipboard(i.id)}}},[t("v-list-item-icon",[t("v-icon",{attrs:{small:""}},[e._v("mdi-link-variant")])],1),t("v-list-item-title",[e._v("Copy link to this search")])],1)],1)],1)],1)],1)],1)})),0)},ua=[],ma={props:[],data:function(){return{c_key:-1}},computed:{sketch(){return this.$store.state.sketch},meta(){return this.$store.state.meta}},methods:{setView:function(e){o.$emit("setActiveView",e)},copySavedSearchIdToClipboard(e){try{navigator.clipboard.writeText(e),this.infoSnackBar("Saved Search ID copied to clipboard")}catch(t){this.errorSnackBar("Failed to load Saved Search ID into the clipboard!"),console.error(t)}},copySavedSearchUrlToClipboard(e){try{let t=window.location.origin+this.$route.path+"?view="+e;navigator.clipboard.writeText(t),this.infoSnackBar("Saved Search URL copied to clipboard")}catch(t){this.errorSnackBar("Failed to load Saved Search URL into the clipboard!"),console.error(t)}}}},ha=ma,pa=Object(d["a"])(ha,da,ua,!1,null,"3b7709bd",null),va=pa.exports,fa={name:"TsSearchGuideCard",props:{flat:{type:Boolean,default:!1},showTags:{type:Boolean,default:!1},showDataTypes:{type:Boolean,default:!1},showSavedSearches:{type:Boolean,default:!1}},components:{TsTagsList:ce,TsDataTypesList:ca,TsSavedSearchesList:va},computed:{firstOfCurrentMonth(){const e=new Date,t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0");return`${t}-${i}-01`},nowDateTimeUTC(){const e=new Date;return e.toISOString().slice(0,19)}},methods:{emitSetQueryAndFilter(e){let t={doSearch:!0};t.queryString=e,o.$emit("setQueryAndFilter",t),this.$emit("search-triggered")}}},ga=fa,_a=Object(d["a"])(ga,ia,sa,!1,null,"fa2a8da6",null),ya=_a.exports,ba={name:"TsExploreWelcomeCard",props:{inDialog:{type:Boolean,default:!1}},components:{TsSearchGuideCard:ya},data(){return{eventActions:[]}},async mounted(){try{this.eventActions=await He.getEventActions()}catch(e){console.error("Error loading event actions:",e),this.eventActions=[]}},methods:{},computed:{showTags(){if(!this.$store.state.tags||!this.$store.state.meta.filter_labels)return!1;const e=this.$store.state.meta.filter_labels.filter(e=>!e.label.startsWith("__ts_fact"));return[...this.$store.state.tags,...e].length>0},showDataTypes(){return this.eventActions.length>0},showSavedSearches(){return(this.$store.state.meta.views||[]).length>0}}},wa=ba,Sa=Object(d["a"])(wa,ea,ta,!1,null,null,null),xa=Sa.exports,Ca=function(){var e=this,t=e._self._c;return t("ts-search-guide-card",{attrs:{flat:e.inDialog,"show-tags":e.showTags,"show-data-types":e.showDataTypes,"show-saved-searches":e.showSavedSearches},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"pa-4 pb-0"},[t("v-card-title",[t("v-icon",{attrs:{large:"",left:""}},[e._v("mdi-alert-circle-outline")]),e._v("\n        No Results Found\n        "),t("v-spacer"),e.inDialog?t("v-btn",{attrs:{icon:"",title:"Close dialog"},on:{click:function(t){return e.$emit("close-dialog")}}},[t("v-icon",[e._v("mdi-close")])],1):e._e()],1),t("v-card-subtitle",{staticClass:"mt-1"},[t("p",[e._v("\n          Your search "),e.currentQueryString?t("code",[e._v("'"+e._s(e.currentQueryString)+"'")]):e._e(),e.filterChips.length?t("span",[e._v("in combination with the selected filter chips\n            "),t("code",[e._v("'"+e._s(e.filterChips.map(e=>e.value).join(", "))+"'")])]):e._e(),e._v("\n          did not match any events.\n        ")]),e.disableSaveSearch?e._e():t("p",[t("v-btn",{attrs:{small:"",depressed:"",title:"Save Search"},on:{click:function(t){return e.$emit("save-search-clicked")}}},[t("v-icon",{attrs:{left:"",small:""}},[e._v("mdi-content-save-outline")]),e._v("\n            Save search\n          ")],1)],1),t("p",[e._v("Suggestions:")]),t("ul",[t("li",[e._v("Try different keywords"),e.filterChips.length?t("span",[e._v(" or filter terms")]):e._e(),e._v(".")]),t("li",[e._v("Try more general keywords.")]),t("li",[e._v("Try fewer keywords"),e.filterChips.length?t("span",[e._v(" or filter terms")]):e._e(),e._v(".")]),t("li",[e._v("Try some of the search examples below.")])])]),t("v-divider")],1)]},proxy:!0}])})},ka=[],Ta={name:"TsSearchNotFoundCard",props:{inDialog:{type:Boolean,default:!1},currentQueryString:{type:String,default:""},filterChips:{type:Array,default:()=>[]},disableSaveSearch:{type:Boolean,default:!1}},components:{TsSearchGuideCard:ya},computed:{showTags(){if(!this.$store.state.tags||!this.$store.state.meta.filter_labels)return!1;const e=this.$store.state.meta.filter_labels.filter(e=>!e.label.startsWith("__ts_fact"));return[...this.$store.state.tags,...e].length>0},showEventActions(){return this.$store.state.eventActions.length>0},showSavedSearches(){return this.$store.state.meta.views.length>0}}},Ea=Ta,Da=Object(d["a"])(Ea,Ca,ka,!1,null,null,null),Oa=Da.exports;function Pa(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Fa(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Pa(Object(i),!0).forEach((function(t){Object(de["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Pa(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}const La=()=>({from:0,terminate_after:40,size:40,indices:["_all"],order:"desc",chips:[]}),Aa=()=>({meta:{count_per_timeline:{},num_events:0,num_states:0,has_next_page:!1},objects:[]});var $a={components:{TsBarChart:Hi,TsEventDetail:Os,TsEventTagMenu:Bs,TsEventTagDialog:Ms,TsEventActionMenu:Ws,TsEventTags:Zs,TsExploreWelcomeCard:xa,TsSearchNotFoundCard:Oa},props:{queryRequest:{type:Object,default:()=>{}},itemsPerPage:{type:Number,default:40},disableSaveSearch:{type:Boolean,default:!1},disableHistogram:{type:Boolean,default:!0},disableColumns:{type:Boolean,default:!1},disableSettings:{type:Boolean,default:!1},disablePagination:{type:Boolean,default:!1},highlightEvent:{type:Object,default:()=>{}}},data(){return{showEventTagMenu:!1,columnHeaders:[{text:"",value:"field"}],tableOptions:{itemsPerPage:this.itemsPerPage},isSummaryLoading:!1,currentItemsPerPage:this.itemsPerPage,expandedRows:[],selectedFields:[{field:"message",type:"text"}],searchColumns:"",columnDialog:!1,saveSearchMenu:!1,saveSearchFormName:"",saveSearchNameRules:[e=>!!e||"Name is required.",e=>e&&e.length<=255||"Name is too long."],selectedEventTags:[],tagConfig:{good:{color:"green",textColor:"white",label:"mdi-check-circle-outline"},bad:{color:"red",textColor:"white",label:"mdi-alert-circle-outline"},suspicious:{color:"orange",textColor:"white",label:"mdi-help-circle-outline"}},searchInProgress:!1,exportDialog:!1,currentPage:1,eventList:{meta:{},objects:[]},currentQueryString:"",currentQueryFilter:La(),selectedEvents:[],displayOptions:{isCompact:!1,showTags:!0,showEmojis:!0,showMillis:!1,showTimelineName:!0},showHistogram:!1,branchParent:null,sortOrderAsc:!0,summaryCollapsed:!1,showBanner:!1,DEBUG_hiddenEventIds:new Set}},computed:{summaryInfoMessage(){const e=this.eventList.meta.summary_event_count,t=this.eventList.meta.summary_unique_event_count;return`[experimental] This summary is based on the message field on your current page (${e} rows, ${t} unique message fields).`},sketch(){return this.$store.state.sketch},meta(){return this.$store.state.meta},highlightEventId(){return this.highlightEvent?this.highlightEvent._id:null},totalHits(){return this.eventList.meta.total_count||0},totalHitsForPagination(){return this.totalHits},totalTime(){return this.eventList.meta.query_time_ms/1e3||0},fromEvent(){return this.currentQueryFilter.from||1},toEvent(){if(!(this.totalHits<this.currentQueryFilter.size))return parseInt(this.currentQueryFilter.from)+parseInt(this.currentQueryFilter.size)},timeFilterChips:function(){return this.currentQueryFilter.chips.filter(e=>e&&e.type&&e.type.startsWith("datetime"))},currentSearchNode(){return this.$store.state.currentSearchNode},userSettings(){return this.$store.state.settings},headers(){let e=[{text:"",value:"data-table-select",sortable:!1},{value:"actions",width:"105",sortable:!1},{text:`Datetime (${this.$store.state.localTimezoneAbbr}) `,align:"start",value:"_source.primary_timestamp",width:"200",sortable:!0},{value:"_source.comment",width:"40",sortable:!1}],t=[];return this.selectedFields.forEach(e=>{let i={text:e.field,align:"start",value:"_source."+e.field,sortable:!1};"message"===e.field?(i.width="100%",t.unshift(i)):t.push(i)}),e.splice(3,0,...t),this.displayOptions.showTimelineName&&e.push({value:"timeline_name",align:"end",sortable:!1}),e},DEBUG_filteredEventList(){return 0===this.DEBUG_hiddenEventIds.size?this.eventList.objects:this.eventList.objects.filter(e=>!this.DEBUG_hiddenEventIds.has(e._id))},activeContext(){return this.$store.state.activeContext},settings(){return this.$store.state.settings},filterChips:function(){return this.currentQueryFilter.chips.filter(e=>e&&e.type&&("label"===e.type||"term"===e.type))}},methods:{toggleSummary(){this.summaryCollapsed=!this.summaryCollapsed,localStorage.setItem("aiSummaryCollapsed",String(this.summaryCollapsed))},async deleteSelectedEvents(){if(!confirm(`Delete ${this.selectedEvents.length} events?`))return;const e=this.selectedEvents.map(e=>e._id);try{await He.deleteEvents(e),this.selectedEvents=[],this.search(!0),this.$store.dispatch("setSnackBar",{message:"Events deleted",color:"success",timeout:3e3})}catch(t){console.error(t),this.$store.dispatch("setSnackBar",{message:"Delete failed",color:"error",timeout:3e3})}},sortEvents(e){this.currentQueryFilter.order=e?"desc":"asc",this.search(!0,!0,!1)},getFieldName:function(e){return"item._source."+e},toggleDetailedEvent:function(e){let t=this.expandedRows.findIndex(t=>t._id===e._id);if(this.expandedRows.some(t=>t._id===e._id)){if(!e.showDetails)return e["showDetails"]=!0,this.expandedRows.splice(t,1),void this.expandedRows.push(e);e["showDetails"]=!1,this.expandedRows.splice(t,1),this.$set(e,"showComments",!1),e.deltaDays&&(this.expandedRows.splice(t,1),this.expandedRows.push(e))}else e["showDetails"]=!0,this.expandedRows.push(e)},newComment:function(e){e.showDetails?this.$set(e,"showComments",!0):(this.$set(e,"showComments",!0),this.toggleDetailedEvent(e))},addTimeBubbles:function(){this.expandedRows=[],this.eventList.objects.forEach((e,t)=>{if(t<1)return;let i=this.eventList.objects[t-1],s=this.$options.filters.formatTimestamp(e._source.primary_timestamp),a=this.$options.filters.formatTimestamp(i._source.primary_timestamp),n=Math.floor(s/1e3),r=Math.floor(a/1e3),o=Math.floor(n-r);"desc"===this.currentQueryFilter.order&&(o=Math.floor(r-n));let l=Math.floor(o/60/60/24);l>0&&(i["deltaDays"]=l,this.expandedRows.push(i))})},getTimeline:function(e){const t=e._source.timeline_id,i=this.sketch.timelines.find(e=>e.id===t);return i||(console.warn("[EventList.getTimeline] Timeline not found for id:",t),{name:"Unknown Timeline",id:t,color:"#999"})},getTimelineColor(e){let t=this.getTimeline(e),i=t.color||"#999";return i.startsWith("#")||(i="#"+i),this.$vuetify.theme.dark?{"background-color":i,filter:"grayscale(25%)",color:"#333"}:{"background-color":i}},getTimeBubbleColor(){let e="#f5f5f5";return this.$vuetify.theme.dark&&(e="#333"),{"background-color":e}},getAllIndices:function(){return this.sketch.timelines.map(e=>e.id)},search:async function(e=!0,t=!1,i=!1){if(console.log("[EventList.search] Called with queryString:",this.currentQueryString,"indices:",this.currentQueryFilter.indices),this.currentQueryFilter.indices&&!this.currentQueryFilter.indices.length)return console.log("[EventList.search] No indices selected, exiting"),void(this.eventList=Aa());const s=this.currentQueryFilter.indices;if("_all"===s||Array.isArray(s)&&(0===s.length||"_all"===s[0])){const e=this.getAllIndices();this.currentQueryFilter.indices=e,console.log("[EventList.search] Expanded _all to timelines:",this.currentQueryFilter.indices)}this.searchInProgress=!0,this.selectedEvents=[],this.eventList=Aa(),e&&(this.tableOptions.page=1,this.currentPage=1,this.currentItemsPerPage=this.tableOptions.itemsPerPage,this.currentQueryFilter.size=this.tableOptions.itemsPerPage,this.currentQueryFilter.from=0);const a=Date.now();try{console.log("[EventList.search] Calling DB.searchEvents with:",{query:this.currentQueryString,filter:this.currentQueryFilter});const e=await He.searchEvents(this.currentQueryString,this.currentQueryFilter);console.log("[EventList.search] Got response.objects length:",e.objects.length),this.eventList.objects=e.objects||[],this.eventList.meta=e.meta||{count_per_timeline:{},total_count:0};this.currentQueryFilter.size;const t=this.currentQueryFilter.from||0;this.eventList.meta.has_next_page=t+this.eventList.objects.length<this.eventList.meta.total_count,this.eventList.meta.query_time_ms=Date.now()-a,console.log("[EventList.search] Updated eventList.objects length:",this.eventList.objects.length),this.updateShowBanner(),this.$emit("countPerTimeline",this.eventList.meta.count_per_timeline),o.$emit("updateCountPerTimeline",this.eventList.meta.count_per_timeline),this.addTimeBubbles()}catch(n){console.error("[EventList.search] Error searching events:",n),this.errorSnackBar("Error fetching search results: "+n.message)}finally{this.searchInProgress=!1,console.log("[EventList.search] searchInProgress is now:",this.searchInProgress)}},exportSearchResult:function(){this.exportDialog=!1},addChip:function(e){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.push(e),this.search()},removeChip:function(e,t=!0){let i=this.currentQueryFilter.chips.findIndex(t=>t.value===e.value);this.currentQueryFilter.chips.splice(i,1),t&&this.search()},removeChips:function(e,t=!0){Array.isArray(e)?(e.forEach(e=>{this.removeChip(e,!1)}),t&&this.search()):this.errorSnackBar("Not an array of chips")},addChipFromHistogram:function(e){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.forEach(e=>{"datetime_range"===e.type&&this.removeChip(e,!1)}),this.addChip(e)},paginate:function(){if(this.tableOptions.itemsPerPage!==this.currentItemsPerPage)return this.tableOptions.page=1,this.currentPage=1,this.currentItemsPerPage=this.tableOptions.itemsPerPage,this.currentQueryFilter.size=this.tableOptions.itemsPerPage,void this.search(!0,!0);this.currentPage!==this.tableOptions.page&&(this.currentQueryFilter.from=this.tableOptions.page*this.currentQueryFilter.size-this.currentQueryFilter.size,this.currentPage=this.tableOptions.page,this.search(!1,!0))},updateSelectedFields:function(e){e.forEach(e=>{!this.headers.filter(t=>t.field===e.field).length>0&&this.search(!0,!0)})},removeField:function(e){this.selectedFields.splice(e,1)},toggleStar(e){e._source.labels||(e._source.labels=[]);const t=e._source.labels.includes("__ts_star");t?(e._source.labels.splice(e._source.labels.indexOf("__ts_star"),1),He.removeLabelEvent([e._id],["__ts_star"]).catch(e=>{console.error("Error updating star in database:",e)})):(e._source.labels.push("__ts_star"),He.addLabelEvent([e._id],["__ts_star"]).catch(e=>{console.error("Error updating star in database:",e)}))},toggleMultipleStars:function(){const e=[],t=[];this.selectedEvents.forEach(i=>{i._source.labels||(i._source.labels=[]),i._source.labels.includes("__ts_star")?(i._source.labels.splice(i._source.labels.indexOf("__ts_star"),1),t.push(i._id)):(i._source.labels.push("__ts_star"),e.push(i._id))}),e.length>0&&He.addLabelEvent(e,["__ts_star"]).catch(e=>{console.error("Error starring events:",e)}),t.length>0&&He.removeLabelEvent(t,["__ts_star"]).catch(e=>{console.error("Error unstarring events:",e)}),this.selectedEvents=[]},saveSearch:function(){this.$store.dispatch("setSnackBar",{message:"Saved searches are not available in browser-only mode",color:"info",timeout:3e3}),this.saveSearchFormName="",this.saveSearchMenu=!1},updateShowBanner:function(){this.showBanner=!!this.settings.showProcessingTimelineEvents&&this.sketch.timelines.filter(e=>this.$store.state.enabledTimelines.includes(e.id)).some(e=>"processing"===e.status)},DEBUG_hideSelectedEvents(){const e=new Set(this.DEBUG_hiddenEventIds);this.selectedEvents.forEach(t=>{e.add(t._id)}),this.DEBUG_hiddenEventIds=e,this.selectedEvents=[],console.log("[DEBUG] Hidden events. Total hidden:",this.DEBUG_hiddenEventIds.size)},DEBUG_resetHiddenEvents(){console.log("[DEBUG] Resetting hidden events. Was hidden:",this.DEBUG_hiddenEventIds.size),this.DEBUG_hiddenEventIds=new Set}},watch:{tableOptions:{handler(e,t){void 0!==t.sortDesc&&e.sortDesc[0]===t.sortDesc[0]&&this.paginate()},deep:!0},queryRequest:{handler(e,t){if(e===t||!e)return;this.currentQueryString=e.queryString||"",this.currentQueryFilter=e.queryFilter||La(),this.currentQueryDsl=e.queryDsl||null;let i=e["resetPagination"]||!1,s=e["incognito"]||!1,a=e["parent"]||!1;this.currentQueryFilter.fields&&(this.selectedFields=this.currentQueryFilter.fields),this.sortOrderAsc?this.currentQueryFilter.order="asc":this.currentQueryFilter.order="desc",this.search(i,s,a)},deep:!0},"settings.showProcessingTimelineEvents":{handler(){this.updateShowBanner()}}},created(){if(console.log("[EventList.created] queryRequest:",this.queryRequest),console.log("[EventList.created] queryRequest.queryString:",this.queryRequest&&this.queryRequest.queryString),this.queryRequest&&this.queryRequest.queryString){this.currentQueryString=this.queryRequest.queryString,this.currentQueryFilter=Fa({},this.queryRequest.queryFilter)||La(),this.currentQueryDsl=Fa({},this.queryRequest.queryDsl),this.currentQueryFilter.fields&&(this.selectedFields=this.currentQueryFilter.fields);const e=localStorage.getItem("aiSummaryCollapsed");"true"===e&&(this.summaryCollapsed=!0),console.log("[EventList.created] Calling search() with queryString:",this.currentQueryString),this.search()}else{console.log("[EventList.created] No queryString in queryRequest, loading all events");const e=localStorage.getItem("aiSummaryCollapsed");"true"===e&&(this.summaryCollapsed=!0),this.search()}}},Ia=$a,Ra=(i("f410"),Object(d["a"])(Ia,Ri,Mi,!1,null,null,null)),Ma=Ra.exports,Na=function(){var e=this,t=e._self._c;return t("ts-search-guide-card",{attrs:{flat:e.flat,"show-tags":!1,"show-data-types":!1,"show-saved-searches":!1},on:{"search-triggered":function(t){return e.$emit("close-dialog")}},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"pa-4 pb-0"},[t("v-card-title",[t("v-icon",{attrs:{large:"",left:""}},[e._v("mdi-file-search-outline")]),e._v("\n        Search Examples and Query Guide\n        "),t("v-spacer"),e.flat?t("v-btn",{attrs:{icon:"",title:"Close dialog"},on:{click:function(t){return e.$emit("close-dialog")}}},[t("v-icon",[e._v("mdi-close")])],1):e._e()],1),t("v-card-subtitle",{staticClass:"mt-1"},[e._v(" Find below some examples on how to explore your data. ")]),t("v-divider")],1)]},proxy:!0}])})},ja=[],Ua={name:"TsSearchHelpCard",props:{flat:{type:Boolean,default:!1}},components:{TsSearchGuideCard:ya}},Ba=Ua,Qa=Object(d["a"])(Ba,Na,ja,!1,null,null,null),za=Qa.exports;const qa=()=>({from:0,terminate_after:40,size:40,indices:"_all",order:"asc",chips:[]});var Ha={directives:{dragscroll:R["a"]},components:{TsSearchHistoryTree:Y,TsSearchHistoryButtons:te,TsSearchDropdown:Ye,TsTimelinePicker:ft,TsFilterMenu:kt,TsUploadTimelineFormButton:Oi,TsAddManualEvent:Ii,TsEventList:Ma,TsSearchHelpCard:za},props:["sketchId"],data(){return{countPerIndex:{},countPerTimeline:{},currentItemsPerPage:40,timeFilterMenu:!1,selectedFields:[{field:"message",type:"text"}],showRightSidePanel:!1,addManualEvent:!1,datetimeManualEvent:"",params:{},contextEvent:!1,originalContext:!1,showSearchDropdown:!1,activeQueryRequest:{},currentQueryString:"",currentQueryFilter:qa(),selectedLabels:[],showSearchHistory:!1,showSearchHelp:!1,zoomLevel:.7,zoomOrigin:{x:0,y:0},quickTags:[{tag:"bad",color:"red",textColor:"white",label:"mdi-alert-circle-outline"},{tag:"suspicious",color:"orange",textColor:"white",label:"mdi-help-circle-outline"},{tag:"good",color:"green",textColor:"white",label:"mdi-check-circle-outline"}],showTimelines:!0}},computed:{sketch(){return this.$store.state.sketch},enabledTimelines(){return this.$store.state.enabledTimelines},meta(){return this.$store.state.meta},filterChips:function(){return this.currentQueryFilter.chips.filter(e=>e&&e.type&&("label"===e.type||"term"===e.type))},timeFilterChips:function(){return this.currentQueryFilter.chips.filter(e=>e&&e.type&&e.type.startsWith("datetime"))},filteredLabels(){return this.$store.state.meta.filter_labels.filter(e=>!e.label.startsWith("__"))},currentSearchNode(){return this.$store.state.currentSearchNode},activeContext(){return this.$store.state.activeContext},activeTimelines(){let e=[...this.sketch.timelines];return e.sort((function(e,t){return e.name.localeCompare(t.name)}))}},watch:{enabledTimelines:function(){this.updateEnabledTimelines(this.enabledTimelines)}},methods:{getQuickTag(e){return this.quickTags.find(t=>t.tag===e)},updateCountPerIndex:function(e){this.countPerIndex=e},updateCountPerTimeline:function(e){this.countPerTimeline=e},toggleSearchHistory:function(){this.showSearchHistory=!this.showSearchHistory,this.showSearchHistory&&this.triggerScrollTo()},setQueryAndFilter:function(e){if("Explore"!==this.$route.name&&this.$router.push({name:"Explore",params:{sketchId:this.sketch.id}}),e.queryString&&(this.currentQueryString=e.queryString),e.queryFilter||(e.queryFilter=this.currentQueryFilter),this.currentQueryFilter=e.queryFilter,e.chip){const t=this.currentQueryFilter.chips.find(t=>t.value===e.chip.value);t||this.currentQueryFilter.chips.push(e.chip)}this.currentQueryFilter.size=this.currentItemsPerPage,this.currentQueryFilter.terminate_after=this.currentItemsPerPage,e.doSearch&&(e.incognito?this.search(!0,!0):this.search())},search:function(e=!0,t=!1,i=!1){let s={};s["queryString"]=this.currentQueryString,s["queryFilter"]=this.currentQueryFilter,s["resetPagination"]=e,s["incognito"]=t,s["parent"]=i,this.activeQueryRequest=s,this.showSearchDropdown=!1},searchContext:function(e){const t=300,i=500;if(this.contextEvent=e,!this.originalContext){let e=JSON.parse(JSON.stringify(this.currentQueryString)),t=JSON.parse(JSON.stringify(this.currentQueryFilter));this.originalContext={queryString:e,queryFilter:t}}const s="YYYY-MM-DDTHH:mm:ss";let a=this.$moment.utc(this.contextEvent._source.datetime),n=a.clone().subtract(t,"s").format(s),r=a.clone().add(t,"s").format(s),o={field:"",value:n+","+a.format(s),type:"datetime_range",operator:"must",active:!0},l={field:"",value:a.format(s)+","+r,type:"datetime_range",operator:"must",active:!0};this.currentQueryString="* OR _id:"+this.contextEvent._id,this.currentQueryFilter.chips=[o,l];const c=this.contextEvent._source.timeline_id||this.contextEvent._source.__ts_timeline_id;c&&(this.currentQueryFilter.indices=[c]),this.currentQueryFilter.size=i,this.search()},removeContext:function(){this.contextEvent=!1,this.currentQueryString=JSON.parse(JSON.stringify(this.originalContext.queryString)),this.currentQueryFilter=JSON.parse(JSON.stringify(this.originalContext.queryFilter)),this.search()},updateEnabledTimelines:function(e){this.currentQueryFilter.indices=e,this.search()},toggleChip:function(e){void 0===e.active&&(e.active=!0),e.active=!e.active,this.search()},copyFilterChip(e){let t="";t=e&&e.type&&e.type.startsWith("datetime")?e.value:"must_not"===e.operator?`NOT ${e.field?e.field+":":""}"${e.value}"`:`${e.field?e.field+":":""}"${e.value}"`,navigator.clipboard.writeText(t).then(()=>{this.infoSnackBar("Copied to clipboard!")}).catch(e=>{this.errorSnackBar("Failed to copy to clipboard."),console.error(e)})},removeChip:function(e,t=!0){let i=this.currentQueryFilter.chips.findIndex(t=>t.value===e.value);this.currentQueryFilter.chips.splice(i,1),"label"===e.type&&(this.selectedLabels=this.selectedLabels.filter(t=>t!==e.value)),t&&this.search()},updateChip:function(e,t){let i=this.currentQueryFilter.chips.findIndex(e=>e.value===t.value&&e.type===t.type);this.currentQueryFilter.chips.splice(i,1,e),this.search()},addChip:function(e){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.push(e),this.search()},addChipFromHistogram:function(e){this.currentQueryFilter.chips||(this.currentQueryFilter.chips=[]),this.currentQueryFilter.chips.forEach(e=>{"datetime_range"===e.type&&this.removeChip(e,!1)}),this.addChip(e)},toggleLabelChip:function(e){let t={field:"",value:e,type:"label",operator:"must",active:!0},i=this.currentQueryFilter.chips;if(i)for(let s=0;s<i.length;s++)if(i[s].value===e)return void this.removeChip(s);this.addChip(t)},updateLabelChips:function(){this.currentQueryFilter.chips=this.currentQueryFilter.chips.filter(e=>"label"!==e.type),this.selectedLabels.forEach(e=>{let t={field:"",value:e,type:"label",operator:"must",active:!0};this.addChip(t),this.showSearchDropdown=!1})},updateLabelList:function(e){-1===this.meta.filter_labels.indexOf(e)&&this.meta.filter_labels.push(e)},jumpInHistory:function(e){if(this.currentQueryString=e.query_string,this.currentQueryFilter=JSON.parse(e.query_filter),this.currentQueryFilter.fields&&this.currentQueryFilter.fields.length||(this.currentQueryFilter.fields=[{field:"message",type:"text"}]),this.selectedFields=this.currentQueryFilter.fields,"_all"===this.currentQueryFilter.indices[0]||"_all"===this.currentQueryFilter.indices){let e=this.sketch.timelines.map(e=>e.id);this.currentQueryFilter.indices=e}let t=this.currentQueryFilter.chips;if(t)for(let i=0;i<t.length;i++)"label"===t[i].type&&this.selectedLabels.push(t[i].value);this.contextEvent=!1,this.search(!0,!0,e.id)},triggerScrollTo:function(){o.$emit("triggerScrollTo")},zoomWithMouse:function(e){this.zoomOrigin.x=e.pageX,this.zoomOrigin.y=e.pageY,e.deltaY<0?this.zoomLevel+=.07:e.deltaY>0&&(this.zoomLevel-=.07)},closeSearchDropdown:function(e){e!==this.$refs.searchInput&&null===e.getAttribute("data-explore-element")&&(this.showSearchDropdown=!1)},onClickOutside:function(e){"tsSearchInput"!==e.target.id&&(this.showSearchDropdown=!1)},enableAllTimelines(){this.$store.dispatch("updateEnabledTimelines",this.activeTimelines.map(e=>e.id))},disableAllTimelines(){this.$store.dispatch("updateEnabledTimelines",[])}},mounted(){this.$refs.searchInput.focus(),o.$on("setQueryAndFilter",this.setQueryAndFilter)},beforeDestroy(){o.$off("setQueryAndFilter"),o.$off("setActiveView")},created:function(){let e=!1;if(this.params={viewId:this.$route.query.view,indexName:this.$route.query.timeline,resultLimit:this.$route.query.limit,queryString:this.$route.query.q},this.params.queryString&&(this.currentQueryString=this.params.queryString,e=!0),this.params.indexName){this.params.queryString||(this.currentQueryString="*");let t=this.sketch.timelines.find(e=>e.id===parseInt(this.params.indexName,10));t&&(this.currentQueryFilter.indices=[t.id]),e=!0}this.currentQueryString||(this.currentQueryFilter.indices=["_all"]),e&&(this.currentQueryFilter.indices.length||(this.currentQueryFilter.indices=["_all"]),this.search())}},Va=Ha,Wa=(i("6d12"),Object(d["a"])(Va,$,I,!1,null,null,null)),Ga=Wa.exports,Ya={props:["sketchId","storyId","ruleId","aggregationId"],components:{Explore:Ga},computed:{currentRouteName(){return this.$route.name}}},Ja=Ya,Ka=Object(d["a"])(Ja,L,A,!1,null,null,null),Xa=Ka.exports,Za=function(){var e=this,t=e._self._c;return t("div",[e.loadingSketch?t("v-progress-linear",{attrs:{indeterminate:"",color:"primary"}}):e._e(),e.sketch.id&&!e.loadingSketch?t("div",{staticStyle:{height:"70vh"}},[e.hasTimelines||e.loadingSketch||e.isArchived?e._e():t("v-container",{attrs:{"fill-height":"",fluid:""}},[t("v-row",{attrs:{align:"center",justify:"center"}},[t("v-sheet",{staticClass:"pa-4",staticStyle:{background:"transparent"}},[t("center",[t("v-img",{attrs:{src:"/images/empty-state.png","max-height":"100","max-width":"300"}}),t("div",{staticClass:"mb-3 mt-3",staticStyle:{"font-size":"2em"}},[e._v("It's empty around here")]),t("ts-upload-timeline-form-button",{attrs:{"btn-size":"normal","btn-type":"rounded"}})],1)],1)],1)],1),t("v-dialog",{attrs:{width:"600"},model:{value:e.renameSketchDialog,callback:function(t){e.renameSketchDialog=t},expression:"renameSketchDialog"}},[t("v-card",{staticClass:"pa-4"},[t("ts-rename-sketch",{on:{close:function(t){e.renameSketchDialog=!1}}})],1)],1),t("v-dialog",{attrs:{width:"700px"},model:{value:e.showSettingsDialog,callback:function(t){e.showSettingsDialog=t},expression:"showSettingsDialog"}},[t("ts-settings-dialog")],1),t("delete-all-data-dialog",{attrs:{open:e.showDeleteDialog},on:{close:function(t){e.showDeleteDialog=!1}}}),e.loadingSketch?e._e():t("v-app-bar",{style:[e.$vuetify.theme.dark?{"border-bottom":"1px solid hsla(0,0%,100%,.12) !important"}:{"border-bottom":"1px solid rgba(0,0,0,.12) !important"}],attrs:{app:"","clipped-left":"",flat:"",color:e.$vuetify.theme.dark?"#121212":"white"}},[!e.hasTimelines||e.loadingSketch||e.isArchived?e._e():t("v-btn",{attrs:{icon:""},on:{click:function(t){return t.stopPropagation(),e.toggleDrawer()}}},[t("v-icon",{attrs:{title:"Toggle left panel"}},[e._v("mdi-menu")])],1),t("v-hover",{scopedSlots:e._u([{key:"default",fn:function({hover:i}){return[t("div",{staticClass:"d-flex align-center",staticStyle:{flex:"1"}},[t("div",{staticClass:"flex-1-0",staticStyle:{"font-size":"1.1em",cursor:"pointer","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},attrs:{title:e.sketch.name},on:{dblclick:function(t){e.renameSketchDialog=!0}}},[t("span",{staticClass:"font-weight-bold"},[e._v("Project:")]),e._v("   "+e._s(e.sketch.name)+"\n          ")]),i?t("v-icon",{staticClass:"ml-3",attrs:{title:"Rename Project",small:""},on:{click:function(t){e.renameSketchDialog=!0}}},[e._v("mdi-pencil")]):e._e()],1)]}}],null,!1,3049073904)}),t("v-spacer"),t("delete-all-data-button",{on:{click:function(t){e.showDeleteDialog=!0}}}),t("PageHeaderMobileMenu",{attrs:{visibilityClass:""}})],1),t("v-navigation-drawer",{attrs:{app:"",clipped:"","disable-resize-watcher":"",stateless:"","hide-overlay":"",width:e.navigationDrawer.width},model:{value:e.showLeftPanel,callback:function(t){e.showLeftPanel=t},expression:"showLeftPanel"}},[t("ts-timelines-table",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),t("ts-devices",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),e.meta&&e.meta.views?t("ts-saved-searches",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}):e._e(),t("ts-data-types",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),t("ts-tags",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),t("ts-search-templates",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()}}}),t("privacy-settings-item",{attrs:{"icon-only":e.isMiniDrawer},on:{toggleDrawer:function(t){return e.toggleDrawer()},openSettings:function(t){e.showPrivacySettings=!0}}})],1),t("privacy-settings-modal",{model:{value:e.showPrivacySettings,callback:function(t){e.showPrivacySettings=t},expression:"showPrivacySettings"}}),e.showRightSidePanel?t("v-navigation-drawer",{staticStyle:{"box-shadow":"0 10px 15px -3px #888"},attrs:{fixed:"",right:"",width:"600"},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("v-toolbar",{attrs:{flat:""}},[t("v-toolbar-title",[e._v("Right Side Panel")]),t("v-spacer"),t("v-btn",{attrs:{icon:""},on:{click:function(t){e.showRightSidePanel=!1}}},[t("v-icon",{attrs:{title:"Close sidepanel"}},[e._v("mdi-close")])],1)],1)]},proxy:!0}],null,!1,3158214288)},[t("v-container",[e._v(" TODO: Add content here ")])],1):e._e(),t("v-main",{staticClass:"notransition"},[e.sketch.status&&e.hasTimelines&&!e.isArchived?t("router-view",{staticClass:"mt-4",on:{setTitle:e=>this.title=e}}):e._e()],1),t("v-bottom-sheet",{attrs:{"hide-overlay":"",persistent:"","no-click-animation":"",scrollable:""},on:{"click:outside":function(t){e.showTimelineView=!1}},model:{value:e.showTimelineView,callback:function(t){e.showTimelineView=t},expression:"showTimelineView"}},[t("v-card",[t("v-toolbar",{attrs:{dense:"",flat:""}},[t("strong",[e._v("Context search")]),t("v-btn-toggle",{staticClass:"ml-10",attrs:{rounded:""},model:{value:e.contextTimeWindowSeconds,callback:function(t){e.contextTimeWindowSeconds=t},expression:"contextTimeWindowSeconds"}},e._l([1,5,10,60,300,600,1800,3600],(function(i){return t("v-btn",{key:i,attrs:{value:i,small:"",outlined:""},on:{click:function(t){return e.updateContextQuery(i)}}},[e._v("\n              "+e._s(e._f("formatSeconds")(i))+"\n            ")])})),1),t("v-btn",{staticClass:"ml-5",attrs:{small:"",text:""},on:{click:function(t){return e.contextToSearch()}}},[e._v("Replace search")]),t("v-spacer"),t("v-btn",{attrs:{icon:"",disabled:e.timelineViewHeight>40},on:{click:function(t){return e.increaseTimelineViewHeight()}}},[t("v-icon",[e._v("mdi-chevron-up")])],1),t("v-btn",{attrs:{icon:"",disabled:0===e.timelineViewHeight},on:{click:function(t){return e.decreaseTimelineViewHeight()}}},[t("v-icon",[e._v("mdi-chevron-down")])],1),t("v-btn",{attrs:{icon:""},on:{click:function(t){e.showTimelineView=!1}}},[t("v-icon",[e._v("mdi-close")])],1)],1),t("v-divider"),t("v-expand-transition",[t("v-card-text",{directives:[{name:"show",rawName:"v-show",value:!e.minimizeTimelineView,expression:"!minimizeTimelineView"}],style:{height:e.timelineViewHeight+"vh"}},[t("ts-event-list",{attrs:{"query-request":e.queryRequest,"highlight-event":e.currentContextEvent}})],1)],1)],1)],1)],1):e._e()],1)},en=[],tn=function(){var e=this,t=e._self._c;return e.iconOnly?t("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(t){e.$emit("toggleDrawer"),e.expanded=!0}}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-content-save-outline")]),t("div",{staticStyle:{height:"1px"}})],1):t("div",[t("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",style:e.meta.views&&e.meta.views.length?"cursor: pointer":"",on:{click:function(t){e.expanded=!e.expanded}}},[t("span",[t("v-icon",{attrs:{left:""}},[e._v("mdi-content-save-outline")]),e._v(" Saved Searches ")],1),t("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[t("small",[t("strong",[e._v(e._s(e.meta.views.length))])])])]),t("v-expand-transition",[t("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded&&e.meta.views.length,expression:"expanded && meta.views.length"}]},[t("ts-saved-searches-list")],1)]),t("v-divider")],1)},sn=[],an={props:{iconOnly:Boolean},components:{TsSavedSearchesList:va},data:function(){return{expanded:!1}},computed:{sketch(){return this.$store.state.sketch},meta(){return this.$store.state.meta}},methods:{}},nn=an,rn=Object(d["a"])(nn,tn,sn,!1,null,null,null),on=rn.exports,ln=function(){var e=this,t=e._self._c;return e.iconOnly?t("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(t){e.$emit("toggleDrawer"),e.expanded=!0}}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-database-outline")]),t("div",{staticStyle:{height:"1px"}})],1):t("div",[t("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",style:e.eventActions&&e.eventActions.length?"cursor: pointer":"",on:{click:function(t){e.expanded=!e.expanded}}},[t("span",[t("v-icon",{attrs:{left:""}},[e._v("mdi-filter-multiple-outline")]),e._v(" Event Actions ")],1),t("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[e.eventActions?t("small",[t("strong",[e._v(e._s(e.eventActions.length))])]):e._e()])]),t("v-expand-transition",[t("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded&&e.eventActions.length,expression:"expanded && eventActions.length"}]},[t("ts-data-types-list")],1)]),t("v-divider")],1)},cn=[],dn={props:{iconOnly:Boolean},components:{TsDataTypesList:ca},data:function(){return{expanded:!1,eventActions:[]}},computed:{sketch(){return this.$store.state.sketch}},async mounted(){try{this.eventActions=await He.getEventActions()}catch(e){console.error("Error loading event actions:",e),this.eventActions=[]}}},un=dn,mn=Object(d["a"])(un,ln,cn,!1,null,"2d8fdf24",null),hn=mn.exports,pn=function(){var e=this,t=e._self._c;return e.iconOnly?t("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(t){e.$emit("toggleDrawer"),e.expanded=!0}}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-tag-multiple-outline")]),t("div",{staticStyle:{height:"1px"}})],1):t("div",[t("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",style:e.tags&&e.tags.length||e.filteredLabels&&e.filteredLabels.length?"cursor: pointer":"",on:{click:function(t){e.expanded=!e.expanded}}},[t("span",[t("v-icon",{attrs:{left:""}},[e._v("mdi-tag-multiple-outline")]),e._v(" Tags ")],1),t("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[t("small",[e.tags&&e.filteredLabels?t("strong",[e._v(e._s((e.tags||[]).length+(e.filteredLabels||[]).length))]):e._e()])])]),t("v-expand-transition",[t("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded&&((e.tags||[]).length||(e.filteredLabels||[]).length),expression:"expanded && ((tags || []).length || (filteredLabels || []).length)"}]},[t("ts-tags-list")],1)]),t("v-divider")],1)},vn=[],fn={props:{iconOnly:Boolean},components:{TsTagsList:ce},data:function(){return{expanded:!1}},computed:{sketch(){return this.$store.state.sketch},meta(){return this.$store.state.meta},tags(){return this.$store.state.tags},filteredLabels(){return this.meta.filter_labels?this.meta.filter_labels.filter(e=>!e.tag.startsWith("__ts_fact")):[]}}},gn=fn,_n=Object(d["a"])(gn,pn,vn,!1,null,null,null),yn=_n.exports,bn=function(){var e=this,t=e._self._c;return e.iconOnly?t("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(t){e.$emit("toggleDrawer"),e.expanded=!0}}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-text-box-search-outline")]),t("div",{staticStyle:{height:"1px"}})],1):t("div",[t("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",style:e.searchtemplates&&e.searchtemplates.length?"cursor: pointer":"",on:{click:function(t){e.expanded=!e.expanded}}},[t("span",[t("v-icon",{attrs:{left:""}},[e._v("mdi-text-box-search-outline")]),e._v(" Search Templates ")],1),t("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[t("small",[t("strong",[e._v(e._s(e.searchtemplates.length))])])])]),t("v-expand-transition",[t("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded&&e.searchtemplates.length,expression:"expanded && searchtemplates.length"}]},[t("v-data-iterator",{attrs:{items:e.searchtemplates,"items-per-page":e.itemsPerPage,search:e.search},on:{"update:itemsPerPage":function(t){e.itemsPerPage=t},"update:items-per-page":function(t){e.itemsPerPage=t}},scopedSlots:e._u([{key:"header",fn:function(){return[t("v-toolbar",{attrs:{flat:""}},[t("v-text-field",{attrs:{clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify",label:"Search for a template.."},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)]},proxy:!0},{key:"default",fn:function(i){return e._l(i.items,(function(e){return t("ts-search-template",{key:e.id,attrs:{searchtemplate:e}})}))}}])})],1)]),t("v-divider")],1)},wn=[],Sn=function(){var e=this,t=e._self._c;return t("div",[e.parameters.length?t("v-row",{staticClass:"pa-2 pl-5",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer","font-size":"0.9em"},attrs:{"no-gutters":""},on:{click:function(t){e.expanded=!e.expanded}}},[e._v("\n    "+e._s(e.searchtemplate.name)+"\n  ")]):t("v-row",{staticClass:"pa-2 pl-5",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer","font-size":"0.9em"},attrs:{"no-gutters":""},on:{click:function(t){return e.search(e.searchtemplate.query_string)}}},[e._v("\n    "+e._s(e.searchtemplate.name)+"\n  ")]),t("v-expand-transition",[t("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}],staticClass:"px-4"},[e._l(e.parameters,(function(i){return t("div",{key:i.name,staticClass:"mt-2"},[t("v-text-field",{attrs:{hint:i.description,label:i.description,outlined:"",dense:"","hide-details":""},model:{value:e.params[i.name],callback:function(t){e.$set(e.params,i.name,t)},expression:"params[parameter.name]"}})],1)})),t("v-card-actions",{staticClass:"pl-0"},[t("v-btn",{attrs:{small:"",depressed:"",color:"primary",disabled:!e.filledOut},on:{click:function(t){return e.parseQueryAndSearch()}}},[e._v(" Search ")])],1)],2)])],1)},xn=[],Cn={props:["searchtemplate"],data:function(){return{expanded:!1,params:{}}},computed:{sketch(){return this.$store.state.sketch},parameters(){return JSON.parse(this.searchtemplate.template_json).parameters},filledOut(){return Object.keys(this.params).length===this.parameters.length},searchTemplateSpec(){return JSON.parse(this.searchtemplate.template_json)}},methods:{search(e){let t={doSearch:!0};t.queryString=e,o.$emit("setQueryAndFilter",t)},parseQueryAndSearch(){let e;console.log("[SearchTemplate] Search templates not implemented").then(t=>{e=t.data.objects[0].query_string,this.search(e)}).catch(e=>{})}}},kn=Cn,Tn=Object(d["a"])(kn,Sn,xn,!1,null,"eaef5454",null),En=Tn.exports,Dn={props:{iconOnly:Boolean},components:{TsSearchTemplate:En},data:function(){return{searchtemplates:[],expanded:!1,itemsPerPage:10,search:""}},computed:{sketch(){return this.$store.state.sketch},meta(){return this.$store.state.meta}},created(){console.log("[SearchTemplates] Search templates not implemented"),Promise.resolve({data:{objects:[]}}).then(e=>{this.searchtemplates=e.data.objects[0],"undefined"===typeof this.searchtemplates&&(this.searchtemplates=[])}).catch(e=>{})}},On=Dn,Pn=(i("31a0"),Object(d["a"])(On,bn,wn,!1,null,"6127702e",null)),Fn=Pn.exports,Ln=function(){var e=this,t=e._self._c;return e.iconOnly?t("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.$emit("toggleDrawer")}}},[t("router-link",{attrs:{to:{name:"Explore",params:{sketchId:e.sketch.id}}}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-magnify")]),t("div",{staticStyle:{height:"1px"}})],1)],1):t("div",[t("router-link",{staticClass:"pa-4",class:e.$vuetify.theme.dark?e.isExploreRoute?"dark-highlight":"dark-hover":e.isExploreRoute?"light-highlight":"light-hover",staticStyle:{cursor:"pointer"},attrs:{to:{name:"Explore",params:{sketchId:e.sketch.id}},custom:""},scopedSlots:e._u([{key:"default",fn:function({navigate:i}){return[t("div",{attrs:{role:"link"},on:{click:i,keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:i.apply(null,arguments)}}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-magnify")]),e._v("Search")],1)]}}])}),t("v-divider")],1)},An=[],$n={props:{iconOnly:Boolean},computed:{sketch(){return this.$store.state.sketch},isExploreRoute(){return"Explore"===this.$route.name},sketchId(){return this.$store.state.sketch.id}}},In=$n,Rn=Object(d["a"])(In,Ln,An,!1,null,null,null),Mn=Rn.exports,Nn=function(){var e=this,t=e._self._c;return t("div",[t("h3",[e._v("Rename project")]),t("br"),t("v-form",{on:{submit:function(t){return t.preventDefault(),e.renameSketch()}}},[t("v-text-field",{attrs:{outlined:"",dense:"",autofocus:"",clearable:"",rules:e.sketchNameRules},on:{focus:function(e){return e.target.select()}},model:{value:e.newSketchName,callback:function(t){e.newSketchName=t},expression:"newSketchName"}}),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:function(t){return e.closeDialog()}}},[e._v(" Cancel ")]),t("v-btn",{attrs:{disabled:!e.newSketchName||e.newSketchName.length>255,text:"",color:"primary"},on:{click:function(t){return e.renameSketch()}}},[e._v("\n        Save\n      ")])],1)],1)],1)},jn=[];function Un(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Bn(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Un(Object(i),!0).forEach((function(t){Object(de["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Un(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Qn={props:["sketchId"],data(){return{newSketchName:"",sketchNameRules:[e=>!!e||"Sketch name is required.",e=>e&&e.length<=255||"Sketch name is too long."]}},computed:{sketch(){return this.$store.state.sketch}},methods:{renameSketch(){localStorage.setItem("sketchName",this.newSketchName);const e=Bn(Bn({},this.sketch),{},{name:this.newSketchName});this.$store.commit("SET_SKETCH",{objects:[e],meta:this.$store.state.meta}),this.$emit("close")},closeDialog:function(){this.newSketchName=this.sketch.name,this.$emit("close")}},created(){this.newSketchName=this.sketch.name}},zn=Qn,qn=Object(d["a"])(zn,Nn,jn,!1,null,"60463cb1",null),Hn=qn.exports,Vn=function(){var e=this,t=e._self._c;return e.iconOnly?t("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:function(t){e.$emit("toggleDrawer"),e.expanded=!0}}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-clock-outline")]),t("div",{staticStyle:{height:"1px"}})],1):t("div",[t("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer"},on:{click:function(t){e.expanded=!e.expanded}}},[t("span",[t("v-icon",{attrs:{left:""}},[e._v("mdi-folder-zip-outline")]),e._v(" Data Exports ")],1),t("span",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[t("small",{staticClass:"ml-3"},[t("strong",[e._v(e._s(e.allTimelines.length))])])])]),t("v-expand-transition",[t("div",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}]},[e.allTimelines.length>=e.paginationThreshold?t("v-text-field",{staticClass:"ma-3",attrs:{label:"Filter timelines","single-line":"",clearable:"","hide-details":"",outlined:"",dense:"","prepend-inner-icon":"mdi-magnify"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}):e._e(),t("v-data-table",{staticClass:"data-table",attrs:{"hide-default-footer":e.allTimelines.length<=e.paginationThreshold,"hide-default-header":!0,items:e.allTimelines,headers:e.headers,"item-key":"id",dense:"","disable-sort":"",search:e.search},scopedSlots:e._u([{key:"item.name",fn:function({item:i}){return[t("ts-timeline-component",{key:i.id+i.name,staticClass:"mb-1 mt-1",attrs:{"is-selected":e.isEnabled(i),timeline:i},on:{toggle:e.toggleTimeline,save:e.save,disableAllOtherTimelines:e.disableAllOtherTimelines},scopedSlots:e._u([{key:"processing",fn:function(s){return[t("div",{staticClass:"chip-content",style:e.timelineStyle(s.timelineStatus,e.isEnabled(i))},[t("span",{staticClass:"timeline-name-ellipsis"},[e._v(e._s(i.name))]),t("span",{staticClass:"right"},["processing"===s.timelineStatus?t("span",{staticClass:"ml-3 mr-3"},[t("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:17,width:2}})],1):e._e()])])]}},{key:"processed",fn:function(s){return[t("div",{staticClass:"chip-content",style:e.timelineStyle(s.timelineStatus,e.isEnabled(i))},[s.timelineFailed?t("v-icon",{staticClass:"ml-n2",attrs:{title:"Import failed; click for details",left:"",color:"red",size:"x-large"},on:{click:s.events.openDialog}},[e._v("\n                  mdi-alert-circle-outline\n                ")]):e._e(),s.timelineFailed?e._e():t("v-icon",{staticClass:"ml-n2",attrs:{left:"",color:s.timelineChipColor,size:"26"}},[e._v("\n                  mdi-circle\n                ")]),t("v-tooltip",{attrs:{bottom:"",disabled:i.name.length<40,"open-delay":"200"},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t("span",e._g({staticClass:"timeline-name-ellipsis",staticStyle:{cursor:"default"}},s),[e._v(e._s(i.name))])]}}],null,!0)},[t("span",[e._v(e._s(i.name))])]),t("span",{staticClass:"right"},["processing"===s.timelineStatus?t("span",{staticClass:"ml-3 mr-3"},[t("v-progress-circular",{attrs:{small:"",indeterminate:"",color:"grey",size:17,width:2}})],1):e._e(),s.timelineFailed?e._e():t("span",{staticClass:"events-count mr-1",attrs:{"x-small":""}},[e._v("\n                    "+e._s(e._f("compactNumber")(e.getCount(i)))+"\n                  ")]),s.timelineFailed?e._e():t("v-btn",{staticClass:"ma-1",attrs:{"x-small":"",icon:""},on:{click:s.events.toggleTimeline}},[e.isEnabled(i)?t("v-icon",[e._v(" mdi-eye ")]):t("v-icon",[e._v(" mdi-eye-off ")])],1),t("v-btn",e._g({staticClass:"ma-1",attrs:{"x-small":"",icon:""}},s.events.menuOn),[t("v-icon",[e._v(" mdi-dots-vertical ")])],1)],1)],1)]}}],null,!0)})]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)]),t("v-divider")],1)},Wn=[],Gn={props:{iconOnly:Boolean},components:{TsUploadTimelineForm:Oi,TsTimelineComponent:lt},computed:{sketch(){return this.$store.state.sketch},allTimelines(){let e=[...this.sketch.timelines];return e.sort((function(e,t){return e.name.localeCompare(t.name)})),e},activeTimelines(){let e=this.sketch.timelines||[],t=[...e];return t.sort((function(e,t){return e.name.localeCompare(t.name)}))},settings(){return this.$store.state.settings}},watch:{"settings.showProcessingTimelineEvents":function(e,t){this.updateEnabledTimelines(void 0===t)}},methods:{isEnabled(e){return this.$store.state.enabledTimelines.includes(e.id)},toggleTimeline(e){this.$store.dispatch("toggleEnabledTimeline",e.id)},disableAllOtherTimelines(e){this.$store.dispatch("updateEnabledTimelines",[e.id])},updateEnabledTimelines(e){let t=this.activeTimelines;e?this.settings.showProcessingTimelineEvents||(t=t.filter(e=>"processing"!==e.status[0].status)):(t=t.filter(e=>this.$store.state.enabledTimelines.includes(e.id)),this.settings.showProcessingTimelineEvents&&(this.activeTimelines.forEach(e=>{t.includes(e)||"processing"!==e.status[0].status||t.push(e)}),t.sort((e,t)=>e.id-t.id)));let i=t.map(e=>e.id);this.$store.dispatch("updateEnabledTimelines",i)},timelineStyle(e,t){let i=["ready"];this.settings.showProcessingTimelineEvents&&i.push("processing");const s=i.includes(e)&&!t;return{opacity:s?"50%":"100%"}},updateCountPerTimeline(e){this.countPerTimeline=e},getCount(e){let t=0;return this.countPerTimeline&&(t=this.countPerTimeline[e.id]),t},async save(e,t=!1){try{await He.updateUpload(e.id,{given_name:t||e.name,description:e.description,color:e.color}),await this.$store.dispatch("updateSketch",this.sketch.id)}catch(i){console.error("[TimelinesTable] Failed to update upload:",i)}}},data:function(){return{countPerTimeline:{},expanded:!1,selected:[],search:"",headers:[{value:"name"}],paginationThreshold:10}},created(){this.updateEnabledTimelines(!0)},mounted(){o.$on("updateCountPerTimeline",this.updateCountPerTimeline)},beforeDestroy(){o.$off("updateCountPerTimeline")}},Yn=Gn,Jn=(i("bc2a"),Object(d["a"])(Yn,Vn,Wn,!1,null,"726ad7ad",null)),Kn=Jn.exports,Xn=function(){var e=this,t=e._self._c;return e.iconOnly?t("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},on:{click:e.navigateToDevices}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-devices")]),t("div",{staticStyle:{height:"1px"}})],1):t("div",[t("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer"},on:{click:e.navigateToDevices}},[t("span",[t("v-icon",{attrs:{left:""}},[e._v("mdi-devices")]),e._v(" Devices ")],1)]),t("v-divider")],1)},Zn=[],er={props:{iconOnly:Boolean},methods:{navigateToDevices(){this.$router.push("/explore/devices")}}},tr=er,ir=(i("7d16"),Object(d["a"])(tr,Xn,Zn,!1,null,"9cea5804",null)),sr=ir.exports,ar=function(){var e=this,t=e._self._c;return t("div",[e.iconOnly?t("div",{staticClass:"pa-4",staticStyle:{cursor:"pointer"},attrs:{title:"Privacy & Visibility Settings"},on:{click:function(t){e.$emit("toggleDrawer"),e.$emit("openSettings")}}},[t("v-icon",[e._v("mdi-shield-account")])],1):t("div",[t("div",{staticClass:"pa-4",class:e.$vuetify.theme.dark?"dark-hover":"light-hover",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.$emit("openSettings")}}},[t("v-icon",{attrs:{left:""}},[e._v("mdi-shield-account")]),t("span",[e._v("Privacy & Visibility Settings")])],1),t("v-divider")],1)])},nr=[],rr={name:"PrivacySettingsItem",props:{iconOnly:{type:Boolean,default:!1}}},or=rr,lr=Object(d["a"])(or,ar,nr,!1,null,null,null),cr=lr.exports,dr=function(){var e=this,t=e._self._c;return t("v-card",{staticClass:"pa-4",attrs:{"min-height":"800px"}},[t("v-card-title",[e._v("Settings")]),e.settings?t("v-list",{staticClass:"px-3",attrs:{"two-line":"",subheader:"",flat:""}},[t("v-subheader",[e._v("Layout")]),t("v-list-item",[t("v-list-item-action",[t("v-switch",{attrs:{color:"primary"},on:{change:function(t){return e.saveSettings()}},model:{value:e.settings.showLeftPanel,callback:function(t){e.$set(e.settings,"showLeftPanel",t)},expression:"settings.showLeftPanel"}})],1),t("v-list-item-content",[t("v-list-item-title",[e._v("Show side panel")]),t("v-list-item-subtitle",[e._v("Select if the side panel should be expanded or collapsed by default")])],1)],1),t("v-list-item",[t("v-list-item-action",[t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("div",e._g(e._b({},"div",s,!1),e.isAnyFeatureAvailable?{}:i),[t("v-switch",{attrs:{color:"primary",disabled:!e.isAnyFeatureAvailable},on:{change:e.updateAiFeatures},model:{value:e.settings.aiPoweredFeaturesMain,callback:function(t){e.$set(e.settings,"aiPoweredFeaturesMain",t)},expression:"settings.aiPoweredFeaturesMain"}})],1)]}}],null,!1,170210909)},[t("span",[e._v("This feature requires an LLM provider to be configured. Please contact your administrator.")])])],1),t("v-list-item-content",[t("v-list-item-title",[e._v("AI powered features (experimental)")]),t("v-list-item-subtitle",[e._v("Main switch to enable or disable all experimental AI features")])],1)],1),t("v-list-item",[t("v-list-item-action",{staticClass:"ml-8"},[t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("div",e._g(e._b({},"div",s,!1),e.isFeatureAvailable("llm_summarize")?{}:i),[t("v-switch",{attrs:{color:"primary",disabled:!e.settings.aiPoweredFeaturesMain||!e.isFeatureAvailable("llm_summarize")},on:{change:function(t){return e.saveSettings()}},model:{value:e.settings.eventSummarization,callback:function(t){e.$set(e.settings,"eventSummarization",t)},expression:"settings.eventSummarization"}})],1)]}}],null,!1,670183324)},[t("span",[e._v("Event summarization requires an LLM provider to be configured. Please contact your administrator.")])])],1),t("v-list-item-content",{staticClass:"ml-8"},[t("v-list-item-title",[e._v("Event summarization")]),t("v-list-item-subtitle",[e._v("Enable AI powered summarization of events")])],1)],1),t("v-list-item",[t("v-list-item-action",{staticClass:"ml-8"},[t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("div",e._g(e._b({},"div",s,!1),e.isFeatureAvailable("nl2q")?{}:i),[t("v-switch",{attrs:{color:"primary",disabled:!e.settings.aiPoweredFeaturesMain||!e.isFeatureAvailable("nl2q")},on:{change:function(t){return e.saveSettings()}},model:{value:e.settings.generateQuery,callback:function(t){e.$set(e.settings,"generateQuery",t)},expression:"settings.generateQuery"}})],1)]}}],null,!1,3920075210)},[t("span",[e._v("AI query generation requires an LLM provider to be configured. Please contact your administrator.")])])],1),t("v-list-item-content",{staticClass:"ml-8"},[t("v-list-item-title",[e._v("AI generated queries")]),t("v-list-item-subtitle",[e._v("Enable experimental AI query suggestions for DFIQ questions")])],1)],1),e.systemSettings.SEARCH_PROCESSING_TIMELINES?t("v-list-item",[t("v-list-item-action",[t("v-switch",{attrs:{color:"primary"},on:{change:function(t){return e.saveSettings()}},model:{value:e.settings.showProcessingTimelineEvents,callback:function(t){e.$set(e.settings,"showProcessingTimelineEvents",t)},expression:"settings.showProcessingTimelineEvents"}})],1),t("v-list-item-content",[t("v-list-item-title",[e._v("Include Processing Events")]),t("v-list-item-subtitle",[e._v("Allows queries to include events from timelines still being "),t("strong",[e._v("processed")]),e._v(".")])],1)],1):e._e()],1):e._e()],1)},ur=[];function mr(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function hr(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?mr(Object(i),!0).forEach((function(t){Object(de["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):mr(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}const pr={showLeftPanel:!0,aiPoweredFeaturesMain:!1,eventSummarization:!1,generateQuery:!1,showProcessingTimelineEvents:!1};var vr={data(){return{settings:{showLeftPanel:!0,aiPoweredFeaturesMain:!1,eventSummarization:!1,generateQuery:!1,showProcessingTimelineEvents:!1}}},computed:{sketch(){return this.$store.state.sketch},systemSettings(){return this.$store.state.systemSettings},userSettings(){return this.$store.state.settings},llmFeatures(){return this.systemSettings.LLM_FEATURES_AVAILABLE||{}},isAnyFeatureAvailable(){return Object.values(this.llmFeatures).some(e=>!0===e)}},methods:{saveSettings(){localStorage.setItem("userSettings",JSON.stringify(this.settings)),this.$store.state.settings=hr({},this.settings),this.$store.dispatch("setSnackBar",{message:"Settings saved",color:"success",timeout:2e3})},updateAiFeatures(){this.settings.aiPoweredFeaturesMain||(this.settings.eventSummarization=!1,this.settings.generateQuery=!1),this.saveSettings()},isFeatureAvailable(e){return!0===this.llmFeatures[e]}},mounted(){this.settings=hr(hr({},pr),this.userSettings),this.saveSettings()}},fr=vr,gr=Object(d["a"])(fr,dr,ur,!1,null,null,null),_r=gr.exports,yr=function(){var e=this,t=e._self._c;return t("v-dialog",{attrs:{width:"500px"},on:{input:e.handleDialogChange},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[t("v-card",[t("v-card-title",{staticClass:"headline"},[e._v("Delete all data?")]),t("v-card-text",[t("p",[e._v("This will permanently delete all imported data from this project.")]),t("p",{staticStyle:{color:"#000","font-weight":"bold"}},[e._v("This action cannot be undone.")])]),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:e.handleCancel}},[e._v("Cancel")]),t("v-btn",{staticStyle:{color:"#d32f2f !important","font-weight":"bold"},attrs:{text:""},on:{click:e.handleDelete}},[e._v("Delete All Data")])],1)],1)],1)},br=[],wr={name:"DeleteAllDataDialog",props:{open:{type:Boolean,default:!1}},data(){return{isOpen:this.open,isDeleting:!1}},watch:{open(e){this.isOpen=e}},methods:{handleCancel(){this.isOpen=!1,this.$emit("close")},async handleDelete(){try{this.isDeleting=!0,await qe();const e=new Ut;await e.clearTempStorage(),localStorage.clear(),this.$store.commit("RESET_STATE"),this.isOpen=!1,this.$store.dispatch("setSnackBar",{message:"All data has been permanently deleted.",color:"success",timeout:5e3}),setTimeout(()=>{location.reload()},1e3),this.$emit("deleted")}catch(e){console.error("Error deleting all data:",e),this.$store.dispatch("setSnackBar",{message:"Error deleting data: "+e.message,color:"error",timeout:5e3}),this.isDeleting=!1}},handleDialogChange(e){this.isOpen=e,e||this.$emit("close")}}},Sr=wr,xr=Object(d["a"])(Sr,yr,br,!1,null,null,null),Cr=xr.exports,kr=function(){var e=this,t=e._self._c;return t("v-btn",{staticClass:"delete-btn",attrs:{small:"",text:"",color:"error"},on:{click:e.handleClick}},[t("v-icon",{attrs:{left:"",small:""}},[e._v("mdi-trash-can-outline")]),e._v("\n  Delete All Data\n")],1)},Tr=[],Er={name:"DeleteAllDataButton",methods:{handleClick(){this.$emit("click")}}},Dr=Er,Or=(i("dda9"),Object(d["a"])(Dr,kr,Tr,!1,null,"44536d38",null)),Pr=Or.exports,Fr={props:["sketchId"],components:{PageHeaderMobileMenu:x,TsSavedSearches:on,TsDataTypes:hn,TsTags:yn,TsSearchTemplates:Fn,TsUploadTimelineFormButton:Oi,TsRenameSketch:Hn,TsSearch:Mn,TsTimelinesTable:Kn,TsDevices:sr,PrivacySettingsItem:cr,TsEventList:Ma,TsSettingsDialog:_r,PrivacySettingsModal:wi,DeleteAllDataDialog:Cr,DeleteAllDataButton:Pr},data(){return{showSketchMetadata:!1,navigationDrawer:{width:56},isMiniDrawer:!0,selectedScenario:null,scenarioDialog:!1,showLeftPanel:!1,leftPanelTab:0,leftPanelTabItems:["EXPLORE","INVESTIGATE"],renameSketchDialog:!1,showHidden:!1,shareDialog:!1,loadingSketch:!1,showDeleteDialog:!1,showPrivacySettings:!1,timelineViewHeight:60,showTimelineView:!1,currentContextEvent:{},minimizeTimelineView:!1,queryRequest:{},contextStartTime:null,contextEndTime:null,contextTimeWindowSeconds:300,showFacetMenu:!1,showQuestionMenu:!1,showRightSidePanel:!1,showSettingsDialog:!1}},mounted(){this.loadingSketch=!0,console.log("[Sketch] mounted(), loadingSketch=true"),this.$store.dispatch("updateSketch",this.sketchId).then(()=>{this.loadingSketch=!1,console.log("[Sketch] Workspace loading complete")}).catch(e=>{console.error("[Sketch] Critical error:",e),this.loadingSketch=!1}),o.$on("showContextWindow",this.showContextWindow)},beforeDestroy(){o.$off("showContextWindow")},computed:{sketch(){return this.$store.state.sketch},meta(){return this.$store.state.meta},userSettings(){return this.$store.state.settings},isArchived(){return!(!this.sketch.status||!this.sketch.status.length)&&"archived"===this.sketch.status[0].status},currentUser(){return this.$store.state.currentUser},hasTimelines(){return this.sketch.timelines&&this.sketch.timelines.length},currentRouteName(){return this.$route.name},systemSettings(){return this.$store.state.systemSettings}},methods:{deleteSketch:async function(){if(confirm("Are you sure you want to delete all data? This cannot be undone."))try{await wipeAllData(),this.$router.push({name:"Home"})}catch(e){console.error("[Sketch] Failed to delete all data:",e),alert("Failed to delete data. See console for details.")}},generateContextQuery(e){let t=this.$options.filters.formatTimestamp(e._source.primary_timestamp);this.contextStartTime=yt["a"].utc(t).subtract(this.contextTimeWindowSeconds,"second"),this.contextEndTime=yt["a"].utc(t).add(this.contextTimeWindowSeconds,"second");let i={field:"",value:this.contextStartTime.toISOString()+","+this.contextEndTime.toISOString(),type:"datetime_range",operator:"must",active:!0},s={from:0,terminate_after:40,size:40,indices:["_all"],order:"asc",chips:[i]},a={queryString:"*",queryFilter:s};return a},updateContextQuery(e){this.contextTimeWindowSeconds=e,this.queryRequest=this.generateContextQuery(this.currentContextEvent)},contextToSearch(){let e=this.generateContextQuery(this.currentContextEvent);e.doSearch=!0,o.$emit("setQueryAndFilter",e),this.showTimelineView=!1},showContextWindow(e){this.currentContextEvent=e,this.queryRequest=this.generateContextQuery(e),this.showTimelineView=!0},increaseTimelineViewHeight:function(){this.minimizeTimelineView=!1,this.timelineViewHeight>70||(this.timelineViewHeight+=30)},decreaseTimelineViewHeight:function(){if(this.minimizeTimelineView=!1,this.timelineViewHeight<50)return this.minimizeTimelineView=!0,void(this.timelineViewHeight=0);this.timelineViewHeight-=30},closeTimelineView:function(){this.minimizeTimelineView=!0,this.timelineViewHeight=0},toggleTheme:function(){this.$vuetify.theme.dark=!this.$vuetify.theme.dark,localStorage.setItem("isDarkTheme",this.$vuetify.theme.dark.toString());let e=document.body;e.dataset.theme=this.$vuetify.theme.dark?"dark":"light"},switchUI:function(){window.location.href=window.location.href.replace("/sketch/","/legacy/sketch/")},toggleDrawer:function(){this.showLeftPanel=!this.showLeftPanel,this.navigationDrawer.width>56?(this.navigationDrawer.width=56,this.isMiniDrawer=!0):(this.navigationDrawer.width=350,setTimeout(()=>{this.isMiniDrawer=!1},100))},updateDocumentTitle:function(){this.sketch&&this.sketch.name&&this.sketch.id?document.title=`[${this.sketch.id}] ${this.sketch.name}`:document.title="Timesketch"}},watch:{sketch(e){e&&this.updateDocumentTitle()},hasTimelines(e,t){0===t&&e>0&&(this.showLeftPanel=!0),t>0&&0===e&&(this.showLeftPanel=!1)}}},Lr=Fr,Ar=Object(d["a"])(Lr,Za,en,!1,null,null,null),$r=Ar.exports,Ir=function(){var e=this,t=e._self._c;return t("div",[t("PageHeader"),t("v-divider"),t("v-container",{staticClass:"pa-8",attrs:{"max-width":"900px"}},[t("h1",{staticClass:"text-h3 mb-8 font-weight-light"},[e._v("How to Request Your Data Exports")]),t("div",{staticClass:"d-flex flex-wrap gap-3 mb-12"},e._l(e.platforms,(function(i){return t("v-btn",{key:i.id,staticClass:"platform-btn",attrs:{outlined:e.selectedPlatform.id!==i.id,color:e.selectedPlatform.id===i.id?"primary":"",large:""},on:{click:function(t){e.selectedPlatform=i}}},[e._v("\n        "+e._s(i.name)+"\n      ")])})),1),t("v-divider",{staticClass:"mb-10"}),t("div",{staticClass:"steps-container"},e._l(e.displayedSteps,(function(i,s){return t("div",{key:s,staticClass:"step-block mb-12"},[t("div",{staticClass:"d-flex align-start"},[t("div",{staticClass:"step-content"},[t("div",{staticClass:"d-flex align-start gap-4"},[t("div",{staticClass:"step-number"},[e._v(e._s(s+1))]),t("div",[t("h2",{staticClass:"text-h5 font-weight-medium mb-2"},[e._v(e._s(i.title))]),i.link?t("div",{staticClass:"mb-3"},[t("a",{staticClass:"primary--text",attrs:{href:i.link.url,target:"_blank",rel:"noopener noreferrer"}},[e._v("\n                    "+e._s(i.link.text)+"\n                    "),t("v-icon",{attrs:{"x-small":""}},[e._v("mdi-open-in-new")])],1)]):e._e(),i.description&&"string"===typeof i.description?t("div",{staticClass:"text-body1"},[e._v("\n                  "+e._s(i.description)+"\n                ")]):e._e(),i.description&&Array.isArray(i.description)?t("div",{staticClass:"text-body1"},e._l(i.description,(function(i,s){return t("div",{key:s,staticClass:"mb-2 step-item"},[e._v("\n                    "+e._s(i)+"\n                  ")])})),0):e._e(),i.alert?t("div",{staticClass:"mt-4",staticStyle:{"max-width":"100%"}},[t("v-alert",{staticClass:"font-weight-medium",attrs:{type:i.alert.type||"warning",dense:""}},[e._v("\n                    "+e._s(i.alert.text)+"\n                  ")])],1):e._e()])])]),i.image?t("div",{staticClass:"step-image-col"},[t("img",{staticClass:"step-image",attrs:{src:"/"+i.image,alt:i.title}})]):e._e()]),t("v-divider",{staticClass:"my-8"})],1)})),0),t("div",{staticClass:"mb-16"})],1)],1)},Rr=[];const Mr="This export contains your sensitive information about you. If someone gains access to this file, they could view your private messages, your location, and/or your search history. Treat it as securely as you would a password or financial records.";var Nr={name:"HowToRequest",components:{PageHeader:E},data(){return{FINAL_STEP_WARNING:Mr,selectedPlatform:null,platforms:[{id:"google",name:"Google",icon:"mdi-google",overview:"Google allows you to download a copy of your data through Google Takeout, which includes your Gmail, Google Photos, Google Drive, and other Google services.",notes:"The download can be large depending on your data volume.",steps:[{title:"Visit Google Takeout and sign in",link:{url:"https://takeout.google.com",text:"Google Takeout"}},{title:"Select data categories",description:['Click "Deselect all" first',"Search for and select: Access log activity, My Activity, Google Account","Optionally add Chrome, Mail, Messages, Pixel, and Profile if relevant. Note that Mail can significantly increase export size. If you do select Mail, limit to specific folders or recent dates"],image:"tutorial/google_json.jpg",alert:{type:"info",text:'If a category offers a "Multiple format" button and JSON is an option, you must select JSON for compatibility.'}},{title:"Choose file type, frequency and destination",description:['Destination: "Select download link via email"','Frequency: "Export once"',"File type & size: .zip and 2GB recommended"],image:"tutorial/google_freq.jpg",alert:{type:"warning",text:"Anyone with access to this email could download your data."}},{title:"Create export",description:'Review your selections and click "Create export".'},{title:"Wait and download",description:["Google will email when ready (usually 2 hours to several day).","Download and save to a secure location.","Your download link will be available for 7 days."],image:"tutorial/google_takeout_email.jpg",alert:{type:"warning",text:Mr}}]},{id:"discord",name:"Discord",icon:"mdi-discord",overview:"Discord provides a data export feature in your account settings that includes your messages, servers, direct messages, and activity history.",notes:"Discord exports are processed relatively quickly, usually within minutes to hours.",steps:[{title:"Open Discord Settings",description:"Click the settings gear icon next to your username in the bottom left corner.",image:"discord-step-1.png"},{title:"Navigate to Privacy & Safety",description:'Scroll down in the left sidebar to find "Privacy & safety" section.',image:"discord-step-2.png"},{title:"Request Data Export",description:["This includes your messages and server membership records","Discord may ask for password confirmation","The export usually completes within 1-24 hours"],link:{url:"https://discord.com/app",text:"Open Discord"},image:"discord-step-3.png"},{title:"Download Your Data",description:["File is typically in .zip format","Download to a secure device","Delete any temporary copies from cloud storage"],image:"discord-step-4.png"}],whatToExpect:["Export time: Usually 1-24 hours","File format: .zip archive with JSON files","Includes: Messages, servers, users interactions","Access duration: Limited time to download after preparation"]},{id:"apple",name:"Apple",icon:"mdi-apple",overview:"Apple provides a comprehensive data export through their Data and Privacy portal, including iCloud data, App activity, and device information.",notes:"Apple processes data exports within a specified timeframe (typically 7 days). You'll need to verify your identity.",steps:[{title:"Visit Privacy.apple.com",description:"Go to https://privacy.apple.com and sign in with your Apple ID.",image:"apple-step-1.png"},{title:'Select "Data and Privacy"',description:'Click on "Data and Privacy" to access your account information tools.',image:"apple-step-2.png"},{title:'Choose "Download Your Data"',description:["Apple will send a verification code to your trusted device","Complete two-factor authentication","Select the categories you want to export"],image:"apple-step-3.png"},{title:"Receive and Download",description:["Check both email and device for notification","Download link is valid for 7 days","Save to a secure password-protected device"],image:"apple-step-4.png"}],whatToExpect:["Processing time: Up to 7 days","File format: .zip archive","Includes: iCloud photos, mail, contacts, calendar data, device logs","Identity verification: Required (2FA)"]},{id:"facebook",name:"Facebook / Instagram",icon:"mdi-facebook",overview:"Facebook (Meta) offers a comprehensive data download through your settings, including messages, photos, posts, and activity logs.",notes:"The export may be very large.",steps:[{title:"Open Facebook Settings",description:"Click the menu icon (three horizontal lines) and go to Settings & privacy, then select Settings.",image:"facebook-step-1.png"},{title:'Find "Your Information"',description:'Look for "Your information" section, typically in the left sidebar under privacy controls.',image:"facebook-step-2.png"},{title:"Download Your Information",description:["Confirm your password for security","Choose data format (HTML or JSON)","Select date range for export (optional)","Choose specific categories to include"],image:"facebook-step-3.png"},{title:"Wait for Preparation and Download",description:["Large exports may take up to 24 hours","Download available for 7 days after preparation","Transfer to secure storage immediately"],image:"facebook-step-4.png"}],whatToExpect:["Export time: Usually a few hours, up to 24 hours for large exports","File format: .zip archive (HTML or JSON format)","File size: Can be very large depending on account activity","Includes: Messages, photos, posts, activity, connections"]},{id:"snapchat",name:"Snapchat",icon:"mdi-snapchat",overview:"Snapchat provides data exports through their account settings, including message history, friend lists, account information, and usage data.",notes:"Snapchat processes exports relatively quickly, but note that some message content may be limited by their retention policies.",steps:[{title:"Open Snapchat Settings",description:"Go to your profile page and tap the gear icon to access Settings.",image:"snapchat-step-1.png"},{title:"Navigate to Account Settings",description:'Scroll to "Account" section and find options related to data and privacy.',image:"snapchat-step-2.png"},{title:"Request Your Data",description:["Snapchat may ask for password confirmation","Export includes messages, conversation history, and account details","Processing typically takes 1-7 days"],image:"snapchat-step-3.png"},{title:"Receive and Download Link",description:["Check email for download notification","Link remains active for a limited time","Store on a secure, password-protected device"],image:"snapchat-step-4.png"}],whatToExpect:["Export time: 1-7 days","File format: .zip archive with JSON files","Includes: Messages, friends list, account description, usage stats","Note: Some deleted messages may not be recoverable"]}]}},computed:{displayedSteps(){return this.selectedPlatform?this.selectedPlatform.steps:[]}},mounted(){this.selectedPlatform=this.platforms[0]}},jr=Nr,Ur=(i("f4ee"),Object(d["a"])(jr,Ir,Rr,!1,null,"d13228e2",null)),Br=Ur.exports,Qr=function(){var e=this,t=e._self._c;return t("v-container",{attrs:{fluid:""}},[t("v-card",{staticClass:"pa-3 pt-0 mt-n3",attrs:{flat:"",color:"transparent"}},[t("ts-device-list")],1)],1)},zr=[],qr=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ts-device-list"},[t("div",{staticClass:"py-8"}),t("v-dialog",{attrs:{width:"600"},model:{value:e.renameDeviceDialog,callback:function(t){e.renameDeviceDialog=t},expression:"renameDeviceDialog"}},[t("v-card",{staticClass:"pa-4"},[t("RenameDevice",{attrs:{device:e.deviceToRename},on:{"device-labeled":e.handleDeviceLabeled,close:function(t){e.renameDeviceDialog=!1}}})],1)],1),t("DeviceMergeModal",{attrs:{device:e.mergeContext.device,"show-merge":e.showMergeDialog,"show-preview":e.showPreviewDialog,"selected-variants":e.mergeContext.selectedVariants,"new-label":e.mergeContext.newLabel},on:{"update-dialog":e.handleDialogUpdate,"update-selected-variants":e.handleSelectVariants,"update-label":function(t){e.mergeContext.newLabel=t},preview:e.previewMerge,"confirm-merge":e.confirmMerge,"close-merge":function(t){e.showMergeDialog=!1},"close-preview":function(t){e.showPreviewDialog=!1}}}),t("v-data-table",{attrs:{headers:e.headers,items:e.devices,"item-key":"id","disable-pagination":"","hide-default-footer":"",flat:""},scopedSlots:e._u([{key:"item",fn:function({item:i}){return[t("tr",{staticClass:"device-row",class:{"device-row-expanded":e.expandedDeviceIds[i.id]},on:{click:function(t){return e.toggleExpanded(i.id)}}},[t("td",{staticStyle:{"text-align":"center"}},[t("v-btn",{attrs:{small:"",icon:""},on:{click:function(e){e.stopPropagation(),i.starred=!i.starred}}},[i.starred?t("v-icon",{attrs:{title:"Toggle star status",color:"amber"}},[e._v("mdi-star")]):t("v-icon",{attrs:{title:"Toggle star status"}},[e._v("mdi-star-outline")])],1),t("v-btn",{staticClass:"ml-1",attrs:{small:"",icon:""},on:{click:function(e){e.stopPropagation(),i.tagged=!i.tagged}}},[i.tagged?t("v-icon",{attrs:{title:"Modify tags"}},[e._v("mdi-tag-plus")]):t("v-icon",{attrs:{title:"Modify tags"}},[e._v("mdi-tag-plus-outline")])],1)],1),t("td",{staticStyle:{"text-align":"center"}},[t("v-icon",{attrs:{size:"64"}},[e._v(e._s(e.getDeviceIcon(i.model)))])],1),t("td",{staticStyle:{"font-weight":"500"}},[t("span",{staticClass:"font-weight-600"},[e._v(e._s(i.model))])]),t("td",{staticClass:"device-label-cell"},[t("v-hover",{scopedSlots:e._u([{key:"default",fn:function({hover:s}){return[t("div",{staticClass:"label-container"},[i.label?t("span",{staticClass:"text-body-2"},[e._v("\n                "+e._s(i.label)+"\n              ")]):t("span",{staticClass:"text-body-2 grey--text text--darken-2",staticStyle:{"font-style":"italic"}},[e._v("\n                Label this device\n              ")]),s?t("v-icon",{staticClass:"ml-2 label-icon",attrs:{small:""},on:{click:function(t){return t.stopPropagation(),e.openRenameDialog(i)}}},[e._v("\n                mdi-pencil\n              ")]):e._e()],1)]}}],null,!0)})],1),t("td",[t("PlatformGrid")],1),i.variants&&i.variants.length>1?t("td",{staticStyle:{"text-align":"right"}},[t("v-chip",{staticClass:"d-flex align-center",staticStyle:{"white-space":"normal","max-width":"150px",height:"auto",padding:"12px","margin-left":"auto"},attrs:{outlined:"",color:"info"}},[t("v-icon",{attrs:{small:"",left:""}},[e._v("mdi-information-outline")]),t("span",{staticClass:"text-caption pl-2"},[e._v("Multiple records")])],1)],1):t("td")]),t("tr",{directives:[{name:"show",rawName:"v-show",value:e.expandedDeviceIds[i.id],expression:"expandedDeviceIds[item.id]"}],staticClass:"device-detail-row"},[t("td",{staticClass:"pa-0",attrs:{colspan:"7"}},[t("DebugDeviceDetail",{attrs:{device:i,"expanded-platforms":e.expandedPlatforms},on:{"update-label":function(e){i.label=e},"toggle-platform":e.togglePlatformExpanded,"open-merge":e.openMergeDialog,unmerge:e.unmerge,"add-comment":e.addComment,"delete-comment":e.deleteComment,"update-comment-text":e.updateCommentText}})],1)])]}}])})],1)},Hr=[],Vr=function(){var e=this,t=e._self._c;return t("div",[t("v-dialog",{attrs:{"max-width":"600px"},on:{input:function(t){return e.$emit("update-dialog","merge",t)}},model:{value:e.showMergeDialog,callback:function(t){e.showMergeDialog=t},expression:"showMergeDialog"}},[e.device&&e.device.id?t("v-card",{staticClass:"pa-6"},[t("h3",[e._v("Consolidate Device Variants")]),t("p",{staticClass:"mt-2 text-caption",staticStyle:{color:"#666"}},[e._v("\n        Merge similar device IDs into a single device record\n      ")]),t("v-divider",{staticClass:"my-4"}),t("div",{staticClass:"mb-4"},[t("p",{staticClass:"text-caption font-weight-500"},[e._v("Merging into:")]),t("p",{staticClass:"ml-2"},[t("strong",[e._v(e._s(e.device.label||e.device.model))]),e._v("\n          ("+e._s(e.device.model)+")\n        ")])]),t("div",{staticClass:"mb-4"},[t("p",{staticClass:"text-caption font-weight-500"},[e._v("Select variants to merge:")]),t("v-list",{attrs:{dense:""}},e._l(e.device.variants,(function(i){return t("v-list-item",{key:i.id},[t("v-list-item-action",[t("v-checkbox",{attrs:{value:i.id,"input-value":e.selectedVariants},on:{change:function(t){return e.$emit("update-selected-variants",t)}}})],1),t("v-list-item-content",[t("v-list-item-title",{staticClass:"text-body2"},[e._v("\n                "+e._s(i.id)+"\n                "),i.isPrimary?t("span",{staticClass:"text-caption",staticStyle:{color:"#2196f3"}},[e._v("(Primary)")]):e._e()]),t("v-list-item-subtitle",{staticClass:"text-caption"},[e._v("\n                Last seen: "+e._s(i.lastSeen)+"\n              ")])],1)],1)})),1)],1),t("div",{staticClass:"mb-6"},[t("p",{staticClass:"text-caption font-weight-500"},[e._v("Keep label as:")]),t("v-text-field",{staticClass:"mt-2",attrs:{value:e.newLabel,dense:"",outlined:"",placeholder:"Device label"},on:{input:function(t){return e.$emit("update-label",t)}}})],1),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("close-merge")}}},[e._v("Cancel")]),t("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$emit("preview")}}},[e._v("Preview")]),t("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.$emit("confirm-merge")}}},[e._v("Merge")])],1)],1):e._e()],1),t("v-dialog",{attrs:{"max-width":"500px"},on:{input:function(t){return e.$emit("update-dialog","preview",t)}},model:{value:e.showPreviewDialog,callback:function(t){e.showPreviewDialog=t},expression:"showPreviewDialog"}},[e.device&&e.device.id?t("v-card",{staticClass:"pa-6"},[t("h3",[e._v("Merge Preview")]),t("v-divider",{staticClass:"my-4"}),t("v-list",{attrs:{dense:""}},[t("v-list-item",[t("v-list-item-content",[t("v-list-item-subtitle",[e._v("Variants being merged")]),t("p",{staticClass:"mt-2"},[e._v(e._s(e.selectedVariants.length)+" device ID(s)")])],1)],1),t("v-divider"),t("v-list-item",[t("v-list-item-content",[t("v-list-item-subtitle",[e._v("Combined event count")]),t("p",{staticClass:"mt-2"},[e._v(e._s(e.device.eventCount)+" events")])],1)],1),t("v-divider"),t("v-list-item",[t("v-list-item-content",[t("v-list-item-subtitle",[e._v("New label")]),t("p",{staticClass:"mt-2"},[e._v(e._s(e.newLabel||e.device.label))])],1)],1)],1),t("v-card-actions",{staticClass:"mt-4"},[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("close-preview")}}},[e._v("Back")]),t("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.$emit("confirm-merge")}}},[e._v("Confirm Merge")])],1)],1):e._e()],1)],1)},Wr=[],Gr={name:"DeviceMergeModal",props:{device:{type:Object,default:()=>({})},showMerge:{type:Boolean,default:!1},showPreview:{type:Boolean,default:!1},selectedVariants:{type:Array,default:()=>[]},newLabel:{type:String,default:""}},computed:{showMergeDialog:{get(){return this.showMerge},set(e){this.$emit("update-dialog","merge",e)}},showPreviewDialog:{get(){return this.showPreview},set(e){this.$emit("update-dialog","preview",e)}}},emits:["update-dialog","update-selected-variants","update-label","preview","confirm-merge","close-merge","close-preview"]},Yr=Gr,Jr=Object(d["a"])(Yr,Vr,Wr,!1,null,null,null),Kr=Jr.exports,Xr=function(){var e=this,t=e._self._c;return t("div",[t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-card",{staticStyle:{"background-color":"transparent"},attrs:{flat:""}},[t("v-row",{staticStyle:{height:"100%",margin:"0"}},[t("v-col",{staticStyle:{padding:"0"},attrs:{cols:"8"}},[e.device.variants&&e.device.variants.length>1?t("v-card-text",{staticClass:"pa-0",staticStyle:{"background-color":"transparent"}},[t("div",{staticClass:"d-flex align-center mb-3 px-4 pt-4"},[t("v-icon",{staticClass:"mr-2",attrs:{small:"",color:"info"}},[e._v("mdi-information-outline")]),t("span",{staticClass:"text-subtitle-2 font-weight-500"},[e._v("Linked Records")])],1),t("p",{staticClass:"text-caption mb-4 px-4",staticStyle:{color:"#666"}},[e._v("\n        These records are grouped as one device. If they're actually different devices, you can separate them below.\n      ")]),t("div",{staticClass:"px-4"},[e.device.variants&&e.device.variants[0]?t("div",{staticClass:"record-item"},[t("ts-timeline-component",{attrs:{timeline:e.$store.state.sketch.timelines[0],"is-selected":!1},scopedSlots:e._u([{key:"processed",fn:function(i){return[t("div",{style:{backgroundColor:e.$vuetify.theme.dark?"#303030":"#f5f5f5",display:"flex",alignItems:"center",gap:"12px",width:"fit-content",padding:"4px 12px",borderRadius:"16px"}},[t("v-icon",{attrs:{color:i.timelineChipColor,size:"20"}},[e._v("mdi-circle")]),t("span",{staticClass:"text-body-2"},[e._v(e._s(e.$store.state.sketch.timelines[0].name))])],1)]}}],null,!1,1748864433)}),t("v-card",{attrs:{outlined:""}},[t("v-simple-table",{staticStyle:{"table-layout":"fixed",width:"100%"},attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[t("tbody",[t("tr",[t("td",{staticStyle:{width:"300px"}},[e._v("IP")]),t("td",[e._v(e._s(e.device.variants[0].ip||"—"))])]),t("tr",[t("td",[e._v("App")]),t("td",[e._v(e._s(e.device.variants[0].appInfo||"—"))])]),t("tr",[t("td",[e._v("Model")]),t("td",[e._v(e._s(e.device.variants[0].model||"—"))])])])]},proxy:!0}],null,!1,1444796755)})],1)],1):e._e(),e.device.variants&&e.device.variants[1]?t("div",{staticClass:"record-item"},[t("ts-timeline-component",{attrs:{timeline:e.$store.state.sketch.timelines[0],"is-selected":!1},scopedSlots:e._u([{key:"processed",fn:function(i){return[t("div",{style:{backgroundColor:e.$vuetify.theme.dark?"#303030":"#f5f5f5",display:"flex",alignItems:"center",gap:"12px",width:"fit-content",padding:"4px 12px",borderRadius:"16px"}},[t("v-icon",{attrs:{color:i.timelineChipColor,size:"20"}},[e._v("mdi-circle")]),t("span",{staticClass:"text-body-2"},[e._v(e._s(e.$store.state.sketch.timelines[0].name))])],1)]}}],null,!1,1748864433)}),t("v-card",{attrs:{outlined:""}},[t("v-simple-table",{staticStyle:{"table-layout":"fixed",width:"100%"},attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[t("tbody",[t("tr",[t("td",{staticStyle:{width:"300px"}},[e._v("IP")]),t("td",[e._v(e._s(e.device.variants[1].ip||"—"))])]),t("tr",[t("td",[e._v("App")]),t("td",[e._v(e._s(e.device.variants[1].appInfo||"—"))])]),t("tr",[t("td",[e._v("Model")]),t("td",[e._v(e._s(e.device.variants[1].model||"—"))])])])]},proxy:!0}],null,!1,47265106)})],1)],1):e._e()]),t("v-card-actions",{staticClass:"pa-4 pt-4"},[t("v-btn",{attrs:{small:"",text:""},on:{click:function(t){return e.$emit("unmerge",e.device)}}},[t("v-icon",{attrs:{small:"",left:""}},[e._v("mdi-undo")]),e._v("\n          Separate Records into Distinct Devices\n        ")],1)],1)],1):e._e()],1),t("v-col",{attrs:{cols:"4"}},[t("DeviceComments",{attrs:{device:e.device},on:{"add-comment":function(t){return e.$emit("add-comment",t)},"delete-comment":function(t){return e.$emit("delete-comment",t)}}})],1)],1)],1)],1)],1),t("div",{staticClass:"py-4"})],1)},Zr=[],eo=function(){var e=this,t=e._self._c;return t("v-card",{attrs:{outlined:""}},[t("v-toolbar",{attrs:{dense:"",flat:""}},[t("v-toolbar-title",{staticStyle:{"font-size":"1.2em"}},[e._v("Comments")])],1),t("v-list",{attrs:{"three-line":""}},e._l(e.device.comments,(function(i,s){return t("v-list-item",{key:i.id,on:{mouseover:function(t){return e.selectComment(i)},mouseleave:function(t){return e.unSelectComment()}}},[t("v-list-item-avatar",[t("v-avatar",{attrs:{color:"grey lighten-1"}},[t("span",{staticClass:"white--text"},[e._v("L")])])],1),t("v-list-item-content",[t("v-list-item-title",[e._v("\n          local-user\n        ")]),t("v-list-item-subtitle",[e._v("\n          "+e._s(e._f("shortDateTime")(i.created_at))+" ("+e._s(e._f("timeSince")(i.created_at))+")\n        ")]),i.editable?t("v-card",{staticClass:"mt-5",attrs:{flat:""}},[t("v-textarea",{attrs:{"hide-details":"","auto-grow":"",filled:""},model:{value:e.device.comments[s].content,callback:function(t){e.$set(e.device.comments[s],"content",t)},expression:"device.comments[index].content"}}),i.editable?t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.editComment(s,!1)}}},[e._v(" Cancel ")]),t("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.updateComment(i,s)}}},[e._v(" Save ")])],1):e._e()],1):t("p",{staticClass:"body-2",staticStyle:{"max-width":"90%"}},[e._v(e._s(i.content))])],1),i===e.selectedComment?t("v-list-item-action",{staticStyle:{position:"absolute",right:"0"}},[t("v-chip",{staticStyle:{"margin-right":"10px"},attrs:{outlined:""}},[t("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.editComment(s)}}},[t("v-icon",{attrs:{title:"Edit comment",small:""}},[e._v("mdi-square-edit-outline")])],1),t("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.deleteComment(i.id,s)}}},[t("v-icon",{attrs:{title:"Delete comment",small:""}},[e._v("mdi-trash-can-outline")])],1)],1)],1):e._e()],1)})),1),t("v-card-actions",[t("v-textarea",{staticClass:"mx-2 mb-2",attrs:{"hide-details":"","auto-grow":"",filled:"",label:"Add comment",rows:"1"},model:{value:e.newComment,callback:function(t){e.newComment=t},expression:"newComment"}}),t("v-btn",{attrs:{icon:""},on:{click:e.postComment}},[t("v-icon",{attrs:{title:"Submit comment"}},[e._v("mdi-send")])],1)],1)],1)},to=[],io={name:"DeviceComments",props:{device:{type:Object,required:!0}},data(){return{newComment:"",selectedComment:null}},filters:{shortDateTime(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},timeSince(e){if(!e)return"";const t=Date.now(),i=t-e,s=Math.floor(i/6e4),a=Math.floor(i/36e5),n=Math.floor(i/864e5);return s<1?"just now":s<60?`${s} minute${s>1?"s":""} ago`:a<24?`${a} hour${a>1?"s":""} ago`:`${n} day${n>1?"s":""} ago`}},methods:{selectComment(e){this.selectedComment=e},unSelectComment(){this.selectedComment=null},editComment(e,t=!0){this.$set(this.device.comments[e],"editable",t)},updateComment(e,t){this.$set(this.device.comments[t],"editable",!1),this.$emit("update-comment-text",{deviceId:this.device.id,index:t,text:e.content})},deleteComment(e,t){this.$emit("delete-comment",{deviceId:this.device.id,index:t})},postComment(){if(this.newComment.trim()){const e={id:Date.now(),content:this.newComment,created_at:Date.now(),editable:!1};this.device.comments||(this.device.comments=[]),this.device.comments.push(e),this.newComment=""}}}},so=io,ao=Object(d["a"])(so,eo,to,!1,null,"0e10b606",null),no=ao.exports,ro={name:"DebugDeviceDetail",components:{TsTimelineComponent:lt,DeviceComments:no},props:{device:{type:Object,required:!0},expandedPlatforms:{type:Object,default:()=>({})}},data(){return{}},methods:{}},oo=ro,lo=(i("5c49"),Object(d["a"])(oo,Xr,Zr,!1,null,"0cfcfcde",null)),co=lo.exports,uo=function(){var e=this,t=e._self._c;return t("div",{staticClass:"platforms-list"},e._l(e.sketch.timelines,(function(i){return t("div",{key:i.id,staticClass:"platform-row"},[t("ts-timeline-component",{attrs:{timeline:i,"is-selected":!1},scopedSlots:e._u([{key:"processed",fn:function(s){return[t("div",{staticClass:"platform-content",style:{backgroundColor:e.$vuetify.theme.dark?"#303030":"#f5f5f5"}},[s.timelineFailed?t("v-icon",{attrs:{title:"Import failed",color:"red",size:"20"}},[e._v("\n            mdi-alert-circle-outline\n          ")]):t("v-icon",{attrs:{color:s.timelineChipColor,size:"20"}},[e._v("\n            mdi-circle\n          ")]),t("span",{staticClass:"text-body-2"},[e._v(e._s(i.name))])],1)]}}],null,!0)}),t("span",{staticClass:"text-body-3 grey--text text--darken-2",staticStyle:{"font-style":"italic"}},[e._v("Last login: 01/01/2026 3:45PM")])],1)})),0)},mo=[],ho={name:"PlatformGrid",components:{TsTimelineComponent:lt},computed:{sketch(){return this.$store.state.sketch}}},po=ho,vo=(i("bf51"),Object(d["a"])(po,uo,mo,!1,null,"b8897a02",null)),fo=vo.exports,go=function(){var e=this,t=e._self._c;return t("div",[t("h3",[e._v("Label device")]),t("br"),t("v-form",{on:{submit:function(t){return t.preventDefault(),e.renameDevice()}}},[t("v-text-field",{attrs:{outlined:"",dense:"",autofocus:"",clearable:"",rules:e.deviceLabelRules,placeholder:"e.g., Work Laptop, iPhone"},on:{focus:function(e){return e.target.select()}},model:{value:e.newDeviceLabel,callback:function(t){e.newDeviceLabel=t},expression:"newDeviceLabel"}}),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:function(t){return e.closeDialog()}}},[e._v(" Cancel ")]),t("v-btn",{attrs:{disabled:!e.newDeviceLabel||e.newDeviceLabel.length>255,text:"",color:"primary"},on:{click:function(t){return e.renameDevice()}}},[e._v("\n        Save\n      ")])],1)],1)],1)},_o=[],yo={data(){return{newDeviceLabel:"",deviceLabelRules:[e=>!e||e.length<=255||"Label is too long."]}},props:{device:{type:Object,required:!0}},methods:{renameDevice(){this.$emit("device-labeled",{deviceId:this.device.id,label:this.newDeviceLabel}),this.$emit("close")},closeDialog(){this.newDeviceLabel=this.device.label||"",this.$emit("close")}},created(){this.newDeviceLabel=this.device.label||""}},bo=yo,wo=Object(d["a"])(bo,go,_o,!1,null,"7abc62d2",null),So=wo.exports,xo={name:"DeviceList",components:{DeviceMergeModal:Kr,DebugDeviceDetail:co,PlatformGrid:fo,RenameDevice:So},data(){return{expandedDeviceIds:{},expandedPlatforms:{},editingDeviceId:null,showMergeDialog:!1,showPreviewDialog:!1,renameDeviceDialog:!1,deviceToRename:{},headers:[{text:"",align:"center",sortable:!1,value:"actions",width:"100"},{text:"",align:"center",sortable:!1,value:"icon",width:"80"},{text:"Device",align:"left",sortable:!1,value:"model",width:"150"},{text:" ",align:"start",sortable:!1,value:"label",width:"200"},{text:"Platforms",align:"left",sortable:!1,value:"platforms",width:"auto"},{text:"",align:"end",sortable:!1,value:"warning",width:"180"}],mergeContext:{device:{},variants:[],selectedVariants:[],newLabel:""},devices:[{id:1,model:"iPhone 15 Pro",label:"",firstSeen:"Dec 2, 2025",lastSeen:"Jan 18, 2026",eventCount:1247,isMerged:!1,starred:!1,tagged:!1,variants:[{id:"ABC123",platform:"Facebook",ip:"192.168.1.100",appInfo:"Facebook for iOS",model:"iPhone 15 Pro",isPrimary:!0,lastSeen:"Jan 18, 2026"},{id:"ABC123_safari",platform:"Facebook",ip:"192.168.1.100",appInfo:"Safari",model:"iPhone 15 Pro",isPrimary:!1,lastSeen:"Jan 18, 2026"}],platforms:[{name:"Facebook",active:!0,firstSeen:"Dec 5, 2025",lastSeen:"Jan 18, 2026 2:14 PM",ip:"192.168.1.100",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 18_1 like Mac OS X)"},{name:"Instagram",active:!1,firstSeen:"Dec 10, 2025",lastSeen:"Jan 5, 2026 11:45 AM",ip:"192.168.1.100",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 18_0 like Mac OS X)"},{name:"Gmail",active:!0,firstSeen:"Nov 28, 2025",lastSeen:"Jan 20, 2026 9:32 PM",ip:"192.168.1.105",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 18_1 like Mac OS X)"}],comments:[{id:1,content:"this phone is always with me",created_at:1769063901e3}]},{id:2,model:"MacBook Pro 16-inch",label:"",firstSeen:"Sep 15, 2025",lastSeen:"Jan 21, 2026",eventCount:3891,isMerged:!0,starred:!1,tagged:!1,variants:[{id:"XYZ789",isPrimary:!0,lastSeen:"Jan 21, 2026"},{id:"XYZ789_v2",isPrimary:!1,lastSeen:"Jan 19, 2026"}],platforms:[{name:"Apple",active:!0,firstSeen:"Sep 15, 2025",lastSeen:"Jan 21, 2026 3:45 PM",ip:"10.0.0.50",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)"},{name:"Gmail",active:!0,firstSeen:"Sep 20, 2025",lastSeen:"Jan 21, 2026 4:12 PM",ip:"10.0.0.50",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)"},{name:"Discord",active:!1,firstSeen:"Oct 1, 2025",lastSeen:"Jan 10, 2026 8:22 PM",ip:"10.0.0.51",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)"}],comments:[{id:1,content:"Work laptop used for development",created_at:17055168e5}]}]}},methods:{getDeviceIcon(e){const t=e.toLowerCase();return t.includes("iphone")?"mdi-cellphone":t.includes("ipad")?"mdi-tablet":t.includes("macbook")||t.includes("mac mini")||t.includes("mac studio")?"mdi-laptop":t.includes("windows")||t.includes("pc")?"mdi-laptop-windows":t.includes("android")?"mdi-android":t.includes("watch")?"mdi-watch":"mdi-devices"},getLastSeenTime(e){if(!e.platforms||0===e.platforms.length)return"";let t=null;return e.platforms.forEach(e=>{if(e.active&&e.lastSeen)if(t){const i=new Date(e.lastSeen);i>t&&(t=i)}else t=new Date(e.lastSeen)}),t?t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""},toggleExpanded(e){this.$set(this.expandedDeviceIds,e,!this.expandedDeviceIds[e])},toggleDetailedDevice(e){this.$set(this.expandedDeviceIds,e.id,!this.expandedDeviceIds[e.id])},togglePlatformExpanded(e,t){const i=`${e}-${t}`;this.$set(this.expandedPlatforms,i,!this.expandedPlatforms[i])},handleDialogUpdate(e,t){"merge"===e?this.showMergeDialog=t:"preview"===e&&(this.showPreviewDialog=t)},handleSelectVariants(e){this.mergeContext.selectedVariants=e},openMergeDialog(e){this.mergeContext.device=e,this.mergeContext.variants=[...e.variants],this.mergeContext.selectedVariants=e.variants.slice(1).map(e=>e.id),this.mergeContext.newLabel=e.label,this.showMergeDialog=!0},previewMerge(){this.showMergeDialog=!1,this.showPreviewDialog=!0},confirmMerge(){this.mergeContext.newLabel&&(this.mergeContext.device.label=this.mergeContext.newLabel),this.mergeContext.device.isMerged=!0,this.showPreviewDialog=!1,this.showMergeDialog=!1},unmerge(e){e.isMerged=!1},addComment(e){e.newComment&&e.newComment.trim()&&(e.comments||(e.comments=[]),e.comments.push({id:Date.now(),content:e.newComment,created_at:Date.now()}),e.newComment="")},deleteComment({deviceId:e,index:t}){const i=this.devices.find(t=>t.id===e);i&&i.comments&&i.comments.splice(t,1)},updateCommentText({deviceId:e,text:t}){const i=this.devices.find(t=>t.id===e);i&&(i.newComment=t)},openRenameDialog(e){this.deviceToRename=e,this.renameDeviceDialog=!0},handleDeviceLabeled({deviceId:e,label:t}){const i=this.devices.find(t=>t.id===e);i&&(i.label=t)}},filters:{shortDateTime(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}}},Co=xo,ko=(i("518f"),Object(d["a"])(Co,qr,Hr,!1,null,"7562331e",null)),To=ko.exports,Eo={name:"Devices",components:{TsDeviceList:To}},Do=Eo,Oo=Object(d["a"])(Do,Qr,zr,!1,null,null,null),Po=Oo.exports,Fo=function(){var e=this,t=e._self._c;return t("v-container",{staticStyle:{"max-width":"1200px"}},[t("v-row",{staticStyle:{"margin-bottom":"8px"},attrs:{align:"center"}},[t("h2",{staticStyle:{margin:"0"}},[e._v("🛠 Debug")])]),t("div",{staticStyle:{display:"flex","flex-wrap":"wrap",gap:"8px","margin-bottom":"20px"}},e._l(e.SECTIONS,(function(i){return t("router-link",{key:i.path,staticStyle:{"text-decoration":"none"},attrs:{to:"/debug/"+i.path}},[t("v-btn",{attrs:{small:"",color:e.currentSection===i.path?"primary":"",outlined:e.currentSection!==i.path}},[e._v(e._s(i.label))])],1)})),1),"opfs"===e.currentSection?t("div",[t("v-row",{staticStyle:{"margin-bottom":"12px"},attrs:{align:"center"}},[t("v-btn",{attrs:{small:"",loading:e.opfsLoading,color:"primary"},on:{click:e.refreshOPFS}},[e._v("Refresh")]),t("v-btn",{staticStyle:{"margin-left":"8px"},attrs:{small:"",color:"error"},on:{click:e.nukeAll}},[e._v("Nuke All")]),t("v-btn",{staticStyle:{"margin-left":"8px"},attrs:{small:"",color:"warning"},on:{click:e.clearTempOnly}},[e._v("Clear tmpstore")]),t("span",{staticStyle:{"margin-left":"16px",color:"#888","font-size":"12px"}},[e._v(e._s(e.opfsStatus))])],1),e.opfsLoading?t("div",{staticStyle:{color:"#888","font-family":"monospace"}},[e._v("Loading...")]):0===e.opfsTree.length?t("div",{staticStyle:{color:"#888","font-family":"monospace"}},[e._v("OPFS is empty.")]):t("div",{staticStyle:{"font-family":"monospace"}},e._l(e.opfsTree,(function(i){return t("div",{key:i.path,style:{paddingLeft:20*i.depth+"px",lineHeight:"1.8",cursor:"file"===i.kind?"pointer":"default"},on:{click:function(t){"file"===i.kind&&e.readFile(i)}}},["directory"===i.kind?t("span",[e._v("📁 "+e._s(i.name)+"/")]):t("span",{staticStyle:{color:"#1a73e8","text-decoration":"underline"}},[e._v("\n          📄 "+e._s(i.name)+" "),t("span",{staticStyle:{color:"#888","font-size":"11px"}},[e._v("("+e._s(i.size)+")")])])])})),0)],1):e.currentTable?t("div",[t("v-row",{staticStyle:{"margin-bottom":"12px"},attrs:{align:"center"}},[t("v-btn",{attrs:{small:"",loading:e.tableLoading,color:"primary"},on:{click:e.loadTable}},[e._v("Refresh")]),t("span",{staticStyle:{"margin-left":"12px",color:"#888","font-size":"12px"}},[e._v(e._s(e.tableStatus))])],1),e.tableLoading?t("div",{staticStyle:{color:"#888"}},[e._v("Loading...")]):t("div",{staticStyle:{"overflow-x":"auto"}},[t("table",{staticStyle:{"border-collapse":"collapse",width:"100%","font-size":"12px","font-family":"monospace"}},[t("thead",[t("tr",e._l(e.tableCols,(function(i){return t("th",{key:i,staticStyle:{"text-align":"left",padding:"4px 10px","border-bottom":"2px solid #ccc","white-space":"nowrap",background:"#f5f5f5"}},[e._v(e._s(i))])})),0)]),t("tbody",[0===e.tableRows.length?t("tr",[t("td",{staticStyle:{padding:"10px",color:"#888","text-align":"center","font-style":"italic"},attrs:{colspan:e.tableCols.length||1}},[e._v("Table is empty.")])]):e._e(),e._l(e.tableRows,(function(i,s){return t("tr",{key:s,style:{background:s%2===0?"#fff":"#fafafa"}},e._l(e.tableCols,(function(s){return t("td",{key:s,staticStyle:{padding:"3px 10px","border-bottom":"1px solid #eee","max-width":"280px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",cursor:"pointer"},attrs:{title:String(i[s])},on:{click:function(t){return e.showCell(s,i[s])}}},[e._v(e._s(i[s]))])})),0)}))],2)])])],1):e._e(),t("v-dialog",{attrs:{"max-width":"800"},model:{value:e.fileDialog,callback:function(t){e.fileDialog=t},expression:"fileDialog"}},[t("v-card",[t("v-card-title",{staticStyle:{"word-break":"break-all"}},[e._v(e._s(e.selectedFile))]),t("v-card-text",[t("pre",{staticStyle:{"max-height":"500px",overflow:"auto","font-size":"12px",background:"#f5f5f5",padding:"12px","border-radius":"4px"}},[e._v(e._s(e.fileContent))])]),t("v-card-actions",[t("v-btn",{attrs:{text:""},on:{click:function(t){e.fileDialog=!1}}},[e._v("Close")])],1)],1)],1),t("v-dialog",{attrs:{"max-width":"700"},model:{value:e.cellDialog,callback:function(t){e.cellDialog=t},expression:"cellDialog"}},[t("v-card",[t("v-card-title",{staticStyle:{"font-size":"14px"}},[e._v(e._s(e.cellTitle))]),t("v-card-text",[t("pre",{staticStyle:{"max-height":"500px",overflow:"auto","font-size":"12px",background:"#f5f5f5",padding:"12px","border-radius":"4px","white-space":"pre-wrap"}},[e._v(e._s(e.cellContent))])]),t("v-card-actions",[t("v-btn",{attrs:{text:""},on:{click:function(t){e.cellDialog=!1}}},[e._v("Close")])],1)],1)],1)],1)},Lo=[];function Ao(e){var t,i,s,a=2;for("undefined"!=typeof Symbol&&(i=Symbol.asyncIterator,s=Symbol.iterator);a--;){if(i&&null!=(t=e[i]))return t.call(e);if(s&&null!=(t=e[s]))return new $o(t.call(e));i="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function $o(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return $o=function(e){this.s=e,this.n=e.next},$o.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var i=this.s.return;return void 0===i?Promise.resolve({value:e,done:!0}):t(i.apply(this.s,arguments))},throw:function(e){var i=this.s.return;return void 0===i?Promise.reject(e):t(i.apply(this.s,arguments))}},new $o(e)}var Io=["uploads","uploaded_files","raw_data","events","auth_devices_initial","event_comments"],Ro=[{path:"opfs",label:"📁 OPFS"}].concat(Io.map((function(e){return{path:e,label:e}}))),Mo={name:"DebugView",data:function(){return{SECTIONS:Ro,DB_TABLES:Io,opfsTree:[],opfsLoading:!1,opfsStatus:"",fileDialog:!1,selectedFile:"",fileContent:"",tableRows:[],tableCols:[],tableLoading:!1,tableStatus:"",cellDialog:!1,cellTitle:"",cellContent:""}},computed:{currentSection:function(){return this.$route.params.section||"opfs"},currentTable:function(){return-1!==Io.indexOf(this.currentSection)?this.currentSection:null}},watch:{currentSection:function(e){"opfs"===e?this.refreshOPFS():-1!==Io.indexOf(e)&&this.loadTable()}},mounted:function(){"opfs"===this.currentSection?this.refreshOPFS():this.currentTable&&this.loadTable()},methods:{refreshOPFS:async function(){this.opfsLoading=!0,this.opfsStatus="",this.opfsTree=[];try{var e=await navigator.storage.getDirectory();await this._walk(e,"",0);var t=this.opfsTree.filter((function(e){return"file"===e.kind})).length;this.opfsStatus=t+" file(s)"}catch(i){this.opfsStatus="Error: "+i.message}finally{this.opfsLoading=!1}},_walk:async function(e,t,i){this.opfsTree.push({kind:"directory",name:e.name||"(root)",path:t||"/",depth:i,size:""});var s,a=!1,n=!1;try{for(var r,o=Ao(e.entries());a=!(r=await o.next()).done;a=!1){var l=r.value,c=l[0],d=l[1];if("directory"===d.kind)await this._walk(d,t+c+"/",i+1);else{var u=await d.getFile(),m=u.size>1024?(u.size/1024).toFixed(1)+" KB":u.size+" B";this.opfsTree.push({kind:"file",name:c,path:t+c,depth:i+1,size:m,handle:d})}}}catch(h){n=!0,s=h}finally{try{a&&null!=o.return&&await o.return()}finally{if(n)throw s}}},readFile:async function(e){try{var t=await e.handle.getFile(),i=await t.text();this.selectedFile=e.path;try{this.fileContent=JSON.stringify(JSON.parse(i),null,2)}catch(s){this.fileContent=i}this.fileDialog=!0}catch(s){this.opfsStatus="Could not read file: "+s.message}},nukeAll:async function(){if(confirm("Delete everything in OPFS (including database)?")){this.opfsStatus="closing db",await closeDB();var e,t=await navigator.storage.getDirectory(),i=!1,s=!1;try{for(var a,n=Ao(t.entries());i=!(a=await n.next()).done;i=!1){var r=a.value;await t.removeEntry(r[0],{recursive:!0})}}catch(o){s=!0,e=o}finally{try{i&&null!=n.return&&await n.return()}finally{if(s)throw e}}this.opfsStatus="Nuked.",await this.refreshOPFS()}},clearTempOnly:async function(){var e=await navigator.storage.getDirectory();try{var t,i=await e.getDirectoryHandle("tmpstore"),s=!1,a=!1;try{for(var n,r=Ao(i.entries());s=!(n=await r.next()).done;s=!1){var o=n.value;await i.removeEntry(o[0],{recursive:!0})}}catch(l){a=!0,t=l}finally{try{s&&null!=r.return&&await r.return()}finally{if(a)throw t}}this.opfsStatus="tmpstore cleared."}catch(c){this.opfsStatus="tmpstore not found or already empty."}await this.refreshOPFS()},loadTable:async function(){var e=this.currentTable;if(e){this.tableLoading=!0,this.tableStatus="",this.tableRows=[],this.tableCols=[];try{var t=await Qe(),i=await t.exec("SELECT * FROM "+e+" LIMIT 500",{returnValue:"resultRows",rowMode:"object"});if(this.tableRows=i||[],i&&i.length>0)this.tableCols=Object.keys(i[0]),this.tableStatus=i.length+" row(s)"+(500===i.length?" (limit 500)":"");else{var s=await t.exec("PRAGMA table_info("+e+")",{returnValue:"resultRows",rowMode:"object"});this.tableCols=(s||[]).map((function(e){return e.name})),this.tableStatus="0 rows"}}catch(a){this.tableStatus="❌ "+a.message}finally{this.tableLoading=!1}}},showCell:function(e,t){this.cellTitle=e;try{this.cellContent=JSON.stringify(JSON.parse(t),null,2)}catch(i){this.cellContent=String(null!==t&&void 0!==t?t:"(null)")}this.cellDialog=!0}}},No=Mo,jo=Object(d["a"])(No,Fo,Lo,!1,null,null,null),Uo=jo.exports;s["default"].use(h["a"]);const Bo=[{name:"Home",path:"/",component:F},{name:"HowToRequest",path:"/how-to-request",component:Br},{name:"Debug",path:"/debug/:section",component:Uo},{path:"/debug",redirect:"/debug/opfs"},{path:"/",component:$r,props:{sketchId:1},children:[{path:"explore",name:"Explore",component:Xa,props:{sketchId:1}},{path:"explore/devices",name:"Devices",component:Po,props:{sketchId:1}},{path:"intelligence",name:"Intelligence",component:Xa,props:{sketchId:1}},{path:"sigma",component:Xa,props:{sketchId:1},children:[{path:"new",name:"SigmaNewRule",component:Xa,props:{sketchId:1}},{path:"edit/:ruleId",name:"SigmaEditRule",component:Xa,props:{sketchId:1,ruleId:!0}}]},{path:"visualization",component:Xa,props:{sketchId:1},children:[{path:"new",name:"VisualizationNew",component:Xa,props:{sketchId:1}},{path:"view/:aggregationId",name:"VisualizationView",component:Xa,props:{sketchId:1,aggregationId:!0}}]}]}];let Qo=null;const zo=new h["a"]({mode:"hash",routes:Bo});zo.afterEach((e,t)=>{e.path.includes("explore")&&(Qo||(Qo=Rt("warmup",{}).catch(e=>{console.warn("[Router] Pyodide warmup error:",e),Qo=null})))});var qo=zo,Ho=i("2f62");function Vo(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Wo(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Vo(Object(i),!0).forEach((function(t){Object(de["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Vo(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}s["default"].use(Ho["a"]);const Go=()=>{const e=()=>{const e=new Intl.DateTimeFormat("en-US",{timeZoneName:"short"}).formatToParts(new Date),t=e.find(e=>"timeZoneName"===e.type);return t?t.value:"UTC"};let t={showProcessingTimelineEvents:!1,showLeftPanel:!0,aiPoweredFeaturesMain:!1,eventSummarization:!1,generateQuery:!1};try{const e=localStorage.getItem("userSettings");e&&(t=Wo(Wo({},t),JSON.parse(e)))}catch(i){console.error("[Store] Failed to load settings from localStorage:",i)}return{sketch:{},meta:{attributes:{},filter_labels:[],mappings:[]},eventActions:[],tags:[],localTimezoneAbbr:e(),settings:t,eventActions:[],currentSearchNode:null,enabledTimelines:[],snackbar:{active:!1,color:"",message:"",timeout:-1},uploadState:{isProcessing:!1,currentFile:null,progress:0,status:null,error:null,errorType:null,errors:[],warnings:[],success:!1}}},Yo=Go();var Jo=new Ho["a"].Store({state:Yo,mutations:{SET_SKETCH(e,t){s["default"].set(e,"sketch",t.objects[0]),s["default"].set(e,"meta",t.meta)},SET_SEARCH_HISTORY(e,t){s["default"].set(e,"searchHistory",t.objects)},SET_TIMELINE_TAGS(e,t){s["default"].set(e,"tags",t)},SET_EVENT_LABELS(e,t){s["default"].set(e.meta,"filter_labels",t)},SET_EVENT_ACTIONS(e,t){s["default"].set(e,"eventActions",t)},SET_COUNT(e,t){s["default"].set(e,"count",t)},SET_ACTIVE_CONTEXT(e,t){localStorage.setItem("sketchContext"+e.sketch.id.toString(),JSON.stringify({scenarioId:t.scenarioId,facetId:t.facetId,questionId:t.questionId})),s["default"].set(e,"activeContext",t)},CLEAR_ACTIVE_CONTEXT(e){let t={scenario:e.activeContext.scenario,facet:e.activeContext.facet,question:{}};s["default"].set(e,"activeContext",t)},SET_SNACKBAR(e,t){s["default"].set(e,"snackbar",t)},RESET_STATE(e,t){Object.assign(e,Go("local-user"))},SET_ENABLED_TIMELINES(e,t){s["default"].set(e,"enabledTimelines",t)},ADD_ENABLED_TIMELINES(e,t){const i=[...e.enabledTimelines,...t];s["default"].set(e,"enabledTimelines",i)},REMOVE_ENABLED_TIMELINES(e,t){s["default"].set(e,"enabledTimelines",e.enabledTimelines.filter(e=>!t.includes(e)))},TOGGLE_ENABLED_TIMELINE(e,t){if(e.enabledTimelines.includes(t))s["default"].set(e,"enabledTimelines",e.enabledTimelines.filter(e=>t!==e));else{const i=[...e.enabledTimelines,t];s["default"].set(e,"enabledTimelines",i)}},SET_UPLOAD_STATE(e,t){s["default"].set(e,"uploadState",Wo(Wo({},e.uploadState),t))},START_UPLOAD(e,t){s["default"].set(e,"uploadState",{isProcessing:!0,currentFile:t,progress:0,status:"validating",error:null})},UPDATE_UPLOAD_PROGRESS(e,{status:t,progress:i,error:a}){s["default"].set(e,"uploadState",Wo(Wo({},e.uploadState),{},{status:t,progress:i,error:a||null}))},COMPLETE_UPLOAD(e,t={}){s["default"].set(e,"uploadState",{isProcessing:!1,currentFile:null,progress:100,status:"complete",error:null,errorType:null,errors:[],warnings:t.warnings||[],success:!0})},FAIL_UPLOAD(e,t){const i="string"===typeof t?{errors:[t]}:t;console.error("[Store] Upload failed:",i),s["default"].set(e,"uploadState",Wo(Wo({},e.uploadState),{},{isProcessing:!1,status:"error",error:i.errors&&i.errors[0]||i.error||"Upload failed",errorType:i.errorType||null,errors:i.errors||[],warnings:i.warnings||[],success:!1}))}},actions:{async updateSketch(e,t){const i=localStorage.getItem("sketchName")||"Local Takeout Workspace",s={id:1,name:i,description:"Browser-only processing",status:[{status:"ready"}],timelines:[]};try{console.log("[Store.updateSketch] Fetching uploads from database...");const t=await He.getUploads();console.log("[Store.updateSketch] Received uploads:",t.objects);const i=Wo(Wo({},s),{},{timelines:t.objects||[]}),a=await He.getEventMeta();console.log("[Store.updateSketch] Committing SET_SKETCH with timelines:",i.timelines.map(e=>({id:e.id,name:e.name,color:e.color}))),e.commit("SET_SKETCH",{objects:[i],meta:a})}catch(a){console.error("[Store] updateSketch error:",a)}},resetState(e){e.commit("RESET_STATE")},updateSearchNode(e,t){e.commit("SET_SEARCH_NODE",t)},updateEventLabels(e,{label:t,num:i}){if(!t||!i)return;let s=e.state.meta.filter_labels,a=s.find(e=>e.tag===t);void 0!==a?a.count+=i:s.push({tag:t,count:i}),s=s.filter(e=>e.count>0),e.commit("SET_EVENT_LABELS",s)},setSnackBar(e,t){e.commit("SET_SNACKBAR",{active:!0,color:t.color,message:t.message,timeout:t.timeout})},enableTimeline(e,t){e.commit("ADD_ENABLED_TIMELINES",[t])},disableTimeline(e,t){e.commit("REMOVE_ENABLED_TIMELINES",[t])},updateEnabledTimelines(e,t){e.commit("SET_ENABLED_TIMELINES",t)},toggleEnabledTimeline(e,t){e.commit("TOGGLE_ENABLED_TIMELINE",t)}}});const Ko=5e3;s["default"].mixin({methods:{successSnackBar(e,t=Ko){const i={message:e,color:"success",timeout:t};this.$store.dispatch("setSnackBar",i)},errorSnackBar(e,t=Ko){const i={message:e,color:"error",timeout:t};this.$store.dispatch("setSnackBar",i)},warningSnackBar(e,t=Ko){const i={message:e,color:"warning",timeout:t};this.$store.dispatch("setSnackBar",i)},infoSnackBar(e,t=2e3){const i={message:e,color:"info",timeout:t};this.$store.dispatch("setSnackBar",i)}}});i("5363");var Xo=i("ce5b"),Zo=i.n(Xo);i("bf40");s["default"].use(Zo.a,{options:{customProperties:!0}});const el={theme:{dark:!1},icons:{iconfont:"mdi"}};var tl=new Zo.a(el),il=function(){var e=this,t=e._self._c;return t("div",{staticClass:"safe-exit-button"},[t("v-tooltip",{attrs:{left:""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:s}){return[t("v-btn",e._g(e._b({staticClass:"mr-4 mb-4",attrs:{fixed:"",bottom:"",right:"",rounded:"",color:"#d32f2f",dark:""},on:{click:e.safeExit}},"v-btn",s,!1),i),[e._v("\n        Safe Exit\n      ")])]}}])},[t("span",[e._v("Close and wipe all data")])])],1)},sl=[],al={name:"SafeExitButton",methods:{async safeExit(){try{console.log("[SafeExit] Initiating safe exit..."),Mt();const e=new Ut;await e.nukeAll(),console.log("[SafeExit] Storage cleared"),this.$store.commit("RESET_STATE"),console.log("[SafeExit] Store reset"),document.body.innerHTML="",window.close(),window.location.replace("https://www.google.com")}catch(e){console.error("[SafeExit] Error during safe exit:",e),window.close()}}}},nl=al,rl=(i("d720"),Object(d["a"])(nl,il,sl,!1,null,"3cbe477f",null)),ol=rl.exports;i("b383"),i("165b"),i("2d27"),i("56eb"),s["default"].component("SafeExitButton",ol),s["default"].use(i("2ead")),s["default"].config.productionTip=!1,new s["default"]({router:qo,store:Jo,vuetify:tl,render:e=>e(m)}).$mount("#app")},"56eb":function(e,t,i){"use strict";i.r(t);i("ac6a");var s=i("2b0e");const a=i("6dde");a.keys().forEach(e=>{const t=a(e);s["default"].filter(t.default.name,t.default.filter)})},"5c49":function(e,t,i){"use strict";i("b016")},"607d":function(e,t,i){},"609a":function(e,t,i){},6107:function(e,t,i){"use strict";i.r(t);var s=i("707c");t["default"]={name:"timeSince",filter:function(e){return e?s["a"].utc(e).fromNow():""}}},"669b":function(e,t,i){"use strict";i("7a0e")},6774:function(e,t,i){"use strict";i("210d")},"682d":function(e,t,i){"use strict";i("fc8b")},"6d12":function(e,t,i){"use strict";i("00eb")},"6dde":function(e,t,i){var s={"./Capitalize.js":"76f9","./CompactBytes.js":"3d1d","./CompactNumber.js":"d3b7","./FilterChip.js":"05a2","./FormatLabelText.js":"16f1","./FormatSeconds.js":"555a","./FormatTimestamp.js":"09ff","./Initital.js":"43f8","./ToISO8601.js":"84cc","./shortDateTime.js":"481e","./shortDateTimeLocal.js":"9bbd","./timeSince.js":"6107"};function a(e){var t=n(e);return i(t)}function n(e){if(!i.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=n,e.exports=a,a.id="6dde"},"707c":function(e,t,i){"use strict";var s=i("5a0c"),a=i.n(s),n=i("0ecf"),r=i.n(n),o=i("4208"),l=i.n(o);a.a.extend(r.a),a.a.extend(l.a),t["a"]=a.a},"75a6":function(e,t){function i(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id="75a6"},"76f9":function(e,t,i){"use strict";i.r(t);i("6b54");t["default"]={name:"capitalize",filter:function(e){return e?(e=e.toString(),e.charAt(0).toUpperCase()+e.slice(1)):""}}},"7a0e":function(e,t,i){},"7d16":function(e,t,i){"use strict";i("5634")},"7ed7":function(e,t,i){},"7ffd":function(e,t,i){},"84cc":function(e,t,i){"use strict";i.r(t);var s=i("707c");t["default"]={name:"toISO8601",filter:function(e){return e<0?"No timestamp":Object(s["a"])(e).toISOString()}}},"84f8":function(e,t,i){},8764:function(e,t,i){"use strict";i("88e6")},"88e6":function(e,t,i){},"8df2":function(e,t,i){},9340:function(e,t,i){},9453:function(e,t,i){"use strict";i("8df2")},"95ee":function(e,t,i){"use strict";i("163d")},9783:function(e,t,i){"use strict";i("7ed7")},"9bbd":function(e,t,i){"use strict";i.r(t);var s=i("707c");t["default"]={name:"shortDateTimeLocal",filter:function(e){return s["a"].utc(e).local().format("MM/DD/YY hh:mm A")}}},ac72:function(e,t,i){"use strict";i("5103")},ae5e:function(e,t,i){},b016:function(e,t,i){},b383:function(e,t,i){},bc2a:function(e,t,i){"use strict";i("49d4")},bf51:function(e,t,i){"use strict";i("607d")},d3b7:function(e,t,i){"use strict";i.r(t),t["default"]={name:"compactNumber",filter:function(e){e||(e=0);let t="";if(e>999999999)e=Math.round(e/1e9*10)/10,t="B";else if(e>999999)e=Math.round(e/1e6*10)/10,t="M";else{if(!(e>999))return e;e=Math.round(e/1e3*10)/10,t="K"}return e+t}}},d720:function(e,t,i){"use strict";i("113d")},dda9:function(e,t,i){"use strict";i("9340")},e044:function(e,t,i){"use strict";i("ae5e")},f072:function(e,t,i){"use strict";i("36e0")},f410:function(e,t,i){"use strict";i("47fc")},f4ee:function(e,t,i){"use strict";i("03a0")},f874:function(e,t,i){"use strict";i("29ce")},fc8b:function(e,t,i){}});
//# sourceMappingURL=index.0a23ee35.js.map